import{d as w,f as H}from"./chunk-QYZA2DXR.js";import{Ac as z,Bb as S,Bc as N,Cb as a,Db as C,Eb as o,Kd as $,Nb as s,Ob as d,Pa as t,Pb as B,Ta as b,Za as F,_ as v,a as x,b as _,bb as f,d as A,de as y,ib as c,ic as M,jc as O,kc as P,lc as T,mb as n,mc as k,nb as i,ub as I,wc as R,ye as g}from"./chunk-7TGFAU7G.js";function L(u,p){u&1&&(n(0,"div",10),a(1,"\u793E\u4F1A\u4FDD\u967A\u5BFE\u8C61\u5916"),i())}function Q(u,p){if(u&1&&(n(0,"div",11)(1,"div"),a(2),s(3,"number"),i(),n(4,"div"),a(5),s(6,"number"),i(),n(7,"div"),a(8),s(9,"number"),i(),n(10,"div"),a(11),s(12,"number"),i(),n(13,"div"),a(14),s(15,"number"),i(),n(16,"div"),a(17),s(18,"number"),i(),n(19,"div"),a(20),s(21,"number"),i(),n(22,"div"),a(23),s(24,"number"),i(),n(25,"div"),a(26),s(27,"number"),i(),n(28,"div"),a(29),s(30,"number"),i(),n(31,"div"),a(32),s(33,"number"),i(),n(34,"div"),a(35),s(36,"number"),i()()),u&2){let e=I().$implicit;t(2),o("\u5065\u5EB7\u4FDD\u967A\u5168\u984D: ",e.insurance.healthInsuranceTotal!=null?d(3,12,e.insurance.healthInsuranceTotal,"1.0-0"):" ","\u5186"),t(3),o("\u5065\u5EB7\u4FDD\u967A\u4F1A\u793E\u8CA0\u62C5\u984D: ",e.insurance.healthInsuranceCompany!=null?d(6,15,e.insurance.healthInsuranceCompany,"1.0-0"):" ","\u5186"),t(3),o("\u5065\u5EB7\u4FDD\u967A\u5F93\u696D\u54E1\u8CA0\u62C5\u984D: ",e.insurance.healthInsuranceEmployee!=null?d(9,18,e.insurance.healthInsuranceEmployee,"1.0-0"):" ","\u5186"),t(3),o("\u4ECB\u8B77\u4FDD\u967A\u5168\u984D: ",e.insurance.careInsuranceTotal!=null?d(12,21,e.insurance.careInsuranceTotal,"1.0-0"):" ","\u5186"),t(3),o("\u4ECB\u8B77\u4FDD\u967A\u4F1A\u793E\u8CA0\u62C5\u984D: ",e.insurance.careInsuranceCompany!=null?d(15,24,e.insurance.careInsuranceCompany,"1.0-0"):" ","\u5186"),t(3),o("\u4ECB\u8B77\u4FDD\u967A\u5F93\u696D\u54E1\u8CA0\u62C5\u984D: ",e.insurance.careInsuranceEmployee!=null?d(18,27,e.insurance.careInsuranceEmployee,"1.0-0"):" ","\u5186"),t(3),o("\u539A\u751F\u5E74\u91D1\u5168\u984D: ",e.insurance.pensionInsuranceTotal!=null?d(21,30,e.insurance.pensionInsuranceTotal,"1.0-0"):" ","\u5186"),t(3),o("\u539A\u751F\u5E74\u91D1\u4F1A\u793E\u8CA0\u62C5\u984D: ",e.insurance.pensionInsuranceCompany!=null?d(24,33,e.insurance.pensionInsuranceCompany,"1.0-0"):" ","\u5186"),t(3),o("\u539A\u751F\u5E74\u91D1\u5F93\u696D\u54E1\u8CA0\u62C5\u984D: ",e.insurance.pensionInsuranceEmployee!=null?d(27,36,e.insurance.pensionInsuranceEmployee,"1.0-0"):" ","\u5186"),t(3),o("\u5408\u8A08: ",e.insurance.total!=null?d(30,39,e.insurance.total,"1.0-0"):" ","\u5186"),t(3),o("\u5408\u8A08\u4F1A\u793E\u8CA0\u62C5\u984D: ",e.insurance.totalCompany!=null?d(33,42,e.insurance.totalCompany,"1.0-0"):" ","\u5186"),t(3),o("\u5408\u8A08\u5F93\u696D\u54E1\u8CA0\u62C5\u984D: ",e.insurance.totalEmployee!=null?d(36,45,e.insurance.totalEmployee,"1.0-0"):" ","\u5186")}}function V(u,p){if(u&1&&(n(0,"div",14)(1,"div"),a(2),s(3,"date"),i(),n(4,"div"),a(5),i(),n(6,"div"),a(7),s(8,"number"),i(),n(9,"div"),a(10),s(11,"number"),i()()),u&2){let e=I(2).$implicit;t(2),o("\u6539\u5B9A\u6708: ",e.standard.lastRevisionMonth?d(3,4,e.standard.lastRevisionMonth,"yyyy-MM"):"---",""),t(3),o("\u6539\u5B9A\u7A2E\u5225: ",e.standard.revisionType||"---",""),t(2),o("\u6A19\u6E96\u5831\u916C\u6708\u984D\uFF08\u5065\u5EB7\u4FDD\u967A\u30FB\u4ECB\u8B77\u4FDD\u967A\uFF09: ",e.standard.kenpoStandardMonthly!=null?d(8,7,e.standard.kenpoStandardMonthly,"1.0-0"):"---","\u5186"),t(3),o("\u6A19\u6E96\u5831\u916C\u6708\u984D\uFF08\u539A\u751F\u5E74\u91D1\uFF09: ",e.standard.nenkinStandardMonthly!=null?d(11,10,e.standard.nenkinStandardMonthly,"1.0-0"):"---","\u5186")}}function W(u,p){if(u&1&&(n(0,"div"),f(1,V,12,13,"div",12),n(2,"div",13),a(3),i()()),u&2){let e=I().$implicit;t(),c("ngIf",e.insurance.isInsuranceTarget!=!1),t(2),C(e.standard.memo||"")}}function X(u,p){u&1&&(n(0,"div",13),a(1,"\u5BFE\u5FDC\u3059\u308B\u6A19\u6E96\u5831\u916C\u60C5\u5831\u304C\u3042\u308A\u307E\u305B\u3093"),i())}function Y(u,p){if(u&1&&(n(0,"div",4),f(1,L,2,0,"div",5),n(2,"div",6)(3,"div",7),a(4),i(),n(5,"div"),a(6),s(7,"date"),i()(),f(8,Q,37,48,"div",8)(9,W,4,2,"div",9)(10,X,2,0,"ng-template",null,0,B),i()),u&2){let e=p.$implicit,m=S(11);t(),c("ngIf",e.insurance.isInsuranceTarget===!1||e.insurance.isInsuranceTarget==="false"||e.insurance.isInsuranceTarget===0),t(3),C(e.insurance.memo||""),t(2),C(d(7,6,e.insurance.createdAt,"yyyy-MM-dd")),t(2),c("ngIf",e.insurance.isInsuranceTarget!=!1),t(),c("ngIf",e.standard)("ngIfElse",m)}}var j=class u{constructor(p){this.route=p;this.employeeId=this.route.snapshot.paramMap.get("id")}employeeId=null;currentUser=null;employee=null;insurances=[];standards=[];insuranceStandardPairs=[];auth=v(R);firestore=v($);router=v(H);ngOnInit(){return A(this,null,function*(){let p=z();if(N(p,l=>{l||this.router.navigate(["/login"])}),!this.employeeId)return;let e=y(this.firestore,"companies"),m=yield g(e);for(let l of m.docs){let U=y(this.firestore,"companies",l.id,"employees"),D=(yield g(U)).docs.find(h=>h.id===this.employeeId);if(D){this.employee=D.data(),this.employee.companyId=l.id;let h=y(this.firestore,"companies",l.id,"employees",this.employeeId,"insurances"),q=yield g(h);this.insurances=q.docs.map(r=>x({id:r.id},r.data())).map(r=>_(x({},r),{createdAt:r.createdAt?.toDate?r.createdAt.toDate():r.createdAt?new Date(r.createdAt):null,_millis:r.createdAt?.toDate?r.createdAt.toDate().getTime():r.createdAt?new Date(r.createdAt).getTime():0})).sort((r,E)=>E._millis-r._millis);let G=y(this.firestore,"companies",l.id,"employees",this.employeeId,"standards"),J=yield g(G);this.standards=J.docs.map(r=>x({id:r.id},r.data())),this.insuranceStandardPairs=this.insurances.map(r=>{let E=this.standards.find(K=>K.id===r.standardId)||null;return{insurance:r,standard:E}});break}}})}static \u0275fac=function(e){return new(e||u)(b(w))};static \u0275cmp=F({type:u,selectors:[["app-insurance-history"]],decls:5,vars:1,consts:[["noStandard",""],[1,"history-header"],[1,"history-header-title"],["class","pair-block","style","border:1px solid #aaa; margin-bottom: 24px; padding: 12px;",4,"ngFor","ngForOf"],[1,"pair-block",2,"border","1px solid #aaa","margin-bottom","24px","padding","12px"],["class","sotai",4,"ngIf"],[2,"display","flex","align-items","center","gap","16px"],[2,"font-weight","bold"],["class","insurance-grid",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"sotai"],[1,"insurance-grid"],["style","display: flex; align-items: center; gap: 20px;",4,"ngIf"],[2,"color","#d32f2f"],[2,"display","flex","align-items","center","gap","20px"]],template:function(e,m){e&1&&(n(0,"div",1)(1,"span",2),a(2,"\u793E\u4F1A\u4FDD\u967A\u6599\u5C65\u6B74"),i()(),n(3,"div"),f(4,Y,12,9,"div",3),i()),e&2&&(t(4),c("ngForOf",m.insuranceStandardPairs))},dependencies:[k,M,O,T,P],styles:["body[_ngcontent-%COMP%], .history-header[_ngcontent-%COMP%], .history-header-title[_ngcontent-%COMP%], .pair-block[_ngcontent-%COMP%], .insurance-grid[_ngcontent-%COMP%], .insurance-grid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .sotai[_ngcontent-%COMP%]{font-size:.92em}.history-header[_ngcontent-%COMP%]{width:100%;padding-top:3.5rem;margin-bottom:18px;display:flex;align-items:flex-end;justify-content:flex-start;text-align:left}.history-header-title[_ngcontent-%COMP%]{font-size:1.25em;font-weight:700;color:#333;letter-spacing:.04em;margin-left:.2em}.pair-block[_ngcontent-%COMP%]{border:1px solid #aaa;margin-bottom:24px;padding:16px 20px;border-radius:8px;background:#fafbfc;box-shadow:0 2px 8px #00000008;font-size:.92em}.insurance-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:8px 16px;margin:12px 0}.insurance-grid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background:#fff;border-radius:4px;padding:6px 8px;border:1px solid #e0e0e0;font-size:.92em;min-width:0;word-break:break-all}.sotai[_ngcontent-%COMP%]{color:#d32f2f;font-weight:700;font-size:1em;margin-bottom:8px}.pair-block[_ngcontent-%COMP%]   .no-standard[_ngcontent-%COMP%]{color:#d32f2f;margin-top:8px}"]})};export{j as InsuranceHistoryComponent};
