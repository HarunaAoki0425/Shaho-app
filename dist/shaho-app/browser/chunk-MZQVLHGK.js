import{a as n}from"./chunk-FUHT4GF3.js";import{d as _}from"./chunk-YD33KHPN.js";import{E as W,F as P,H as N,I as l,K as f,L as F,M as p,l as x,n as w}from"./chunk-GWX46VZL.js";import{Db as v,Eb as R,Mb as u,Ob as h,Qb as s,Xa as i,ab as d,d as y,gb as A,lb as S,sb as E,vb as r,wb as o}from"./chunk-T5GPIMBU.js";function L(c,e){if(c&1&&(r(0,"div")(1,"div"),u(2),o(),r(3,"div"),u(4),o(),r(5,"div"),u(6),o(),r(7,"div"),u(8),o(),r(9,"div"),u(10),o(),r(11,"div"),u(12),o(),r(13,"div"),u(14),o(),r(15,"div"),u(16),o(),r(17,"div"),u(18),o(),r(19,"div"),u(20),o(),r(21,"div"),u(22),o(),r(23,"div"),u(24),o()()),c&2){let t=R();i(2),s("\u5065\u5EB7\u4FDD\u967A\uFF08\u5168\u984D\uFF09: ",t.stdSalaryHealthWithComma,"\u5186\xD7",t.healthInsuranceRate100,"\uFF05\uFF1D",t.healthInsuranceAmount,"\u5186"),i(2),s("\u5065\u5EB7\u4FDD\u967A\uFF08\u4F1A\u793E\u8CA0\u62C5\uFF09: ",t.stdSalaryHealthWithComma,"\u5186\xD7",t.healthInsuranceRate100,"\uFF05\xF72\uFF1D",t.healthInsuranceAmountCompany,"\u5186"),i(2),s("\u5065\u5EB7\u4FDD\u967A\uFF08\u5F93\u696D\u54E1\u8CA0\u62C5\uFF09: ",t.stdSalaryHealthWithComma,"\u5186\xD7",t.healthInsuranceRate100,"\uFF05\xF72\uFF1D",t.healthInsuranceAmountEmployee,"\u5186"),i(2),s("\u4ECB\u8B77\u4FDD\u967A\uFF08\u5168\u984D\uFF09: ",t.stdSalaryHealthWithComma,"\u5186\xD7",t.careInsuranceRate100,"\uFF05\uFF1D",t.careInsuranceAmount,"\u5186"),i(2),s("\u4ECB\u8B77\u4FDD\u967A\uFF08\u4F1A\u793E\u8CA0\u62C5\uFF09: ",t.stdSalaryHealthWithComma,"\u5186\xD7",t.careInsuranceRate100,"\uFF05\xF72\uFF1D",t.careInsuranceAmountCompany,"\u5186"),i(2),s("\u4ECB\u8B77\u4FDD\u967A\uFF08\u5F93\u696D\u54E1\u8CA0\u62C5\uFF09: ",t.stdSalaryHealthWithComma,"\u5186\xD7",t.careInsuranceRate100,"\uFF05\xF72\uFF1D",t.careInsuranceAmountEmployee,"\u5186"),i(2),s("\u539A\u751F\u5E74\u91D1\uFF08\u5168\u984D\uFF09: ",t.stdSalaryPensionWithComma,"\u5186\xD7",t.pensionInsuranceRate100,"\uFF05\uFF1D",t.pensionInsuranceAmount,"\u5186"),i(2),s("\u539A\u751F\u5E74\u91D1\uFF08\u4F1A\u793E\u8CA0\u62C5\uFF09: ",t.stdSalaryPensionWithComma,"\u5186\xD7",t.pensionInsuranceRate100,"\uFF05\xF72\uFF1D",t.pensionInsuranceAmountCompany,"\u5186"),i(2),s("\u539A\u751F\u5E74\u91D1\uFF08\u5F93\u696D\u54E1\u8CA0\u62C5\uFF09: ",t.stdSalaryPensionWithComma,"\u5186\xD7",t.pensionInsuranceRate100,"\uFF05\xF72\uFF1D",t.pensionInsuranceAmountEmployee,"\u5186"),i(2),h("\u5168\u984D\u5408\u8A08: ",t.totalInsuranceAmount,"\u5186"),i(2),h("\u4F1A\u793E\u8CA0\u62C5\u5408\u8A08: ",t.totalInsuranceAmountCompany,"\u5186"),i(2),h("\u5F93\u696D\u54E1\u8CA0\u62C5\u5408\u8A08: ",t.totalInsuranceAmountEmployee,"\u5186")}}var H=class c{constructor(e,t){this.route=e;this.firestore=t}employeesId="";companyId="";employeeData=null;companyData=null;officeData=null;insuranceRateData=null;currentNendo=(()=>{let e=new Date,t=e.getFullYear();return e.getMonth()+1>=4?t:t-1})();ngOnInit(){return y(this,null,function*(){this.employeesId=this.route.snapshot.paramMap.get("id")||"";let e=l(this.firestore,"companies"),t=yield p(e);for(let a of t.docs){let I=l(this.firestore,"companies",a.id,"employees"),b=yield p(I);for(let D of b.docs)if(D.id===this.employeesId){this.companyId=a.id,this.employeeData=D.data();let B=f(this.firestore,"companies",this.companyId),g=yield F(B);if(this.companyData=g.exists()?g.data():null,this.employeeData.officesId){let U=f(this.firestore,"companies",this.companyId,"offices",this.employeeData.officesId),C=yield F(U);if(this.officeData=C.exists()?C.data():null,this.officeData&&this.officeData.officePrefecture){let O=l(this.firestore,"insurance_rates"),T=yield p(O);this.insuranceRateData=T.docs.map(m=>m.data()).find(m=>m.prefecture===this.officeData.officePrefecture&&String(m.year)===String(this.currentNendo))||null}}return}}console.log("currentNendo:",this.currentNendo)})}get healthInsuranceRate100(){if(!this.insuranceRateData||this.insuranceRateData.health_insurance==null)return"";try{return new n(this.insuranceRateData.health_insurance).times(100).toString()}catch{return""}}get careInsuranceRate100(){if(!this.insuranceRateData||this.insuranceRateData.care_insurance==null)return"";try{return new n(this.insuranceRateData.care_insurance).times(100).toString()}catch{return""}}get pensionInsuranceRate100(){if(!this.insuranceRateData||this.insuranceRateData.pension_insurance==null)return"";try{return new n(this.insuranceRateData.pension_insurance).times(100).toString()}catch{return""}}formatWithComma(e){if(e==null||e==="")return"";let t=typeof e=="number"?e:Number(e);return isNaN(t)?"":t.toLocaleString()}get healthInsuranceAmount(){if(!this.employeeData||!this.insuranceRateData)return"";let e=this.employeeData.stdSalaryHealth,t=this.insuranceRateData.health_insurance;if(e==null||t==null)return"";try{return this.formatWithComma(new n(e).times(new n(t)).toDecimalPlaces(0,n.ROUND_HALF_UP).toString())}catch{return""}}get pensionInsuranceAmount(){if(!this.employeeData||!this.insuranceRateData)return"";let e=this.employeeData.stdSalaryPension,t=this.insuranceRateData.pension_insurance;if(e==null||t==null)return"";try{return this.formatWithComma(new n(e).times(new n(t)).toFixed(0))}catch{return""}}get healthInsuranceAmountCompany(){let e=this.healthInsuranceAmount.replace(/,/g,"");if(!e)return"";try{return this.formatWithComma(new n(e).div(2).toDecimalPlaces(0,n.ROUND_HALF_UP).toString())}catch{return""}}get healthInsuranceAmountEmployee(){let e=this.healthInsuranceAmount.replace(/,/g,"");if(!e)return"";try{let t=new n(e).div(2);return t.minus(t.floor()).times(10).toNumber()<=5?this.formatWithComma(t.floor().toString()):this.formatWithComma(t.ceil().toString())}catch{return""}}get pensionInsuranceAmountCompany(){let e=this.pensionInsuranceAmount.replace(/,/g,"");if(!e)return"";try{return this.formatWithComma(new n(e).div(2).toDecimalPlaces(0,n.ROUND_HALF_UP).toString())}catch{return""}}get pensionInsuranceAmountEmployee(){let e=this.pensionInsuranceAmount.replace(/,/g,"");if(!e)return"";try{let t=new n(e).div(2);return t.minus(t.floor()).times(10).toNumber()<=5?this.formatWithComma(t.floor().toString()):this.formatWithComma(t.ceil().toString())}catch{return""}}get careInsuranceAmount(){if(!this.employeeData||!this.insuranceRateData)return"";let e=this.employeeData.stdSalaryHealth,t=this.insuranceRateData.care_insurance;if(e==null||t==null)return"";try{return this.formatWithComma(new n(e).times(new n(t)).toDecimalPlaces(0,n.ROUND_HALF_UP).toString())}catch{return""}}get careInsuranceAmountCompany(){let e=this.careInsuranceAmount.replace(/,/g,"");if(!e)return"";try{return this.formatWithComma(new n(e).div(2).toDecimalPlaces(0,n.ROUND_HALF_UP).toString())}catch{return""}}get careInsuranceAmountEmployee(){let e=this.careInsuranceAmount.replace(/,/g,"");if(!e)return"";try{let t=new n(e).div(2);return t.minus(t.floor()).times(10).toNumber()<=5?this.formatWithComma(t.floor().toString()):this.formatWithComma(t.ceil().toString())}catch{return""}}get totalInsuranceAmount(){let e=this.healthInsuranceAmount.replace(/,/g,""),t=this.pensionInsuranceAmount.replace(/,/g,""),a=this.careInsuranceAmount.replace(/,/g,"");if(!e&&!t&&!a)return"";try{return this.formatWithComma(new n(e||0).plus(new n(t||0)).plus(new n(a||0)).toString())}catch{return""}}get totalInsuranceAmountCompany(){let e=this.healthInsuranceAmountCompany.replace(/,/g,""),t=this.pensionInsuranceAmountCompany.replace(/,/g,""),a=this.careInsuranceAmountCompany.replace(/,/g,"");if(!e&&!t&&!a)return"";try{return this.formatWithComma(new n(e||0).plus(new n(t||0)).plus(new n(a||0)).toString())}catch{return""}}get totalInsuranceAmountEmployee(){let e=this.healthInsuranceAmountEmployee.replace(/,/g,""),t=this.pensionInsuranceAmountEmployee.replace(/,/g,""),a=this.careInsuranceAmountEmployee.replace(/,/g,"");if(!e&&!t&&!a)return"";try{return this.formatWithComma(new n(e||0).plus(new n(t||0)).plus(new n(a||0)).toString())}catch{return""}}get stdSalaryHealthWithComma(){return!this.employeeData||this.employeeData.stdSalaryHealth==null?"":this.formatWithComma(this.employeeData.stdSalaryHealth)}get stdSalaryPensionWithComma(){return!this.employeeData||this.employeeData.stdSalaryPension==null?"":this.formatWithComma(this.employeeData.stdSalaryPension)}onSaveCalc=()=>y(this,null,function*(){if(!this.employeesId)return;let e=l(this.firestore,"companies",this.companyId,"employees",this.employeesId,"insurances"),t={healthInsuranceTotal:this.healthInsuranceAmount.replace(/,/g,""),healthInsuranceCompany:this.healthInsuranceAmountCompany.replace(/,/g,""),healthInsuranceEmployee:this.healthInsuranceAmountEmployee.replace(/,/g,""),careInsuranceTotal:this.careInsuranceAmount.replace(/,/g,""),careInsuranceCompany:this.careInsuranceAmountCompany.replace(/,/g,""),careInsuranceEmployee:this.careInsuranceAmountEmployee.replace(/,/g,""),pensionInsuranceTotal:this.pensionInsuranceAmount.replace(/,/g,""),pensionInsuranceCompany:this.pensionInsuranceAmountCompany.replace(/,/g,""),pensionInsuranceEmployee:this.pensionInsuranceAmountEmployee.replace(/,/g,""),total:this.totalInsuranceAmount.replace(/,/g,""),totalCompany:this.totalInsuranceAmountCompany.replace(/,/g,""),totalEmployee:this.totalInsuranceAmountEmployee.replace(/,/g,""),employeeId:this.employeesId,createdAt:W()};yield N(e,t)});static \u0275fac=function(t){return new(t||c)(d(_),d(P))};static \u0275cmp=A({type:c,selectors:[["app-calculate"]],decls:4,vars:1,consts:[[1,"calculate-container"],[4,"ngIf"],["type","button",1,"save-calc-btn",3,"click"]],template:function(t,a){t&1&&(r(0,"div",0),S(1,L,25,30,"div",1),r(2,"button",2),v("click",function(){return a.onSaveCalc()}),u(3,"\u8A08\u7B97\u7D50\u679C\u3092\u4FDD\u5B58"),o()()),t&2&&(i(),E("ngIf",a.employeeData))},dependencies:[w,x],styles:[".calculate-container[_ngcontent-%COMP%]{padding-top:4rem}"]})};export{H as CalculateComponent};
