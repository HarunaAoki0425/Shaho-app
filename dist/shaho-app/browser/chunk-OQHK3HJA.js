import{a as u}from"./chunk-FUHT4GF3.js";import{l as X,n as Z,o as A,q as U,r as Y,s as w}from"./chunk-VUVKO2NV.js";import{d as K,f as Q}from"./chunk-72SR37OV.js";import{$a as N,Ab as f,Ib as o,Jb as S,Kb as L,Mb as D,Tb as _,Ub as v,Xa as s,a as b,b as k,d as T,fb as j,jb as P,ma as z,na as $,qb as p,rc as G,tb as i,tc as J,ub as r,uc as V,yb as q,zb as W}from"./chunk-UWLINABT.js";var I=class n{static judgeSocialInsuranceRequired({employee:t,office:e,company:a}){let h=new u(t?.workDays||0),d=new u(t?.workHours||0),l=new u(e?.monthlyDays||0),c=new u(e?.weeklyHours||0),g=l.times(.75),R=c.times(.75);if(l.gt(0)&&c.gt(0)&&h.gte(g)&&d.gte(R))return console.log("[DEBUG] \u5224\u5B9A\u7D50\u679C: true (4\u5206\u306E3\u6761\u4EF6)"),!0;let x=Number(e?.employeeCount||0),y=Number(t?.workHours||0),F=Number(t?.baseSalary||0),M=t?.isStudent==="\u5B66\u751F\u3067\u306F\u306A\u3044",C=!1;if(t?.employmentPeriodType==="\u7121\u671F")C=!0;else if(t?.employmentPeriodType==="\u6709\u671F"&&t?.employmentPeriodStart&&t?.employmentPeriodEnd){let E=new Date(t.employmentPeriodStart);C=(new Date(t.employmentPeriodEnd).getTime()-E.getTime())/(1e3*60*60*24)>=59}let m=x>=51&&y>=20&&F>=88e3&&M&&C;return console.log("[DEBUG] \u8FFD\u52A0\u6761\u4EF6:",{officeEmployeeCount:x,workHours:y,baseSalary:F,isNotStudent:M,periodOk:C,allExtra:m}),m?(console.log("[DEBUG] \u5224\u5B9A\u7D50\u679C: true (\u8FFD\u52A0\u6761\u4EF6)"),!0):(console.log("[DEBUG] \u5224\u5B9A\u7D50\u679C: false"),!1)}static judgeEligibility(t){return{health:!0,pension:!0,care:!0}}static judgeHealthInsurance(t){if(!t?.birthdate)return!1;let e=new Date,a=e.getFullYear(),h=e.getMonth()+1,d=new Date(t.birthdate);if(isNaN(d.getTime()))return!1;let l=new Date(d.getFullYear()+75,d.getMonth(),d.getDate()),c=l.getFullYear(),g=l.getMonth()+1;return a<c||a===c&&h<=g}static judgeCareInsurance(t){if(!t?.birthdate)return!1;let e=new Date,a=e.getFullYear(),h=e.getMonth()+1,d=new Date(t.birthdate);if(isNaN(d.getTime()))return!1;let l=new Date(d.getFullYear()+40,d.getMonth(),d.getDate()),c=new Date(l);c.setDate(c.getDate()-1);let g=c.getFullYear(),R=c.getMonth()+1,x=new Date(d.getFullYear()+65,d.getMonth(),d.getDate()),y=new Date(x);y.setDate(y.getDate()-1);let F=y.getFullYear(),M=y.getMonth()+1,C=F,m=M-1;m===0&&(m=12,C-=1);let E=a>g||a===g&&h>=R,O=a<C||a===C&&h<=m;return E&&O}static judgePensionInsurance(t){if(!t?.birthdate)return!1;let e=new Date,a=e.getFullYear(),h=e.getMonth()+1,d=new Date(t.birthdate);if(isNaN(d.getTime()))return!1;let l=new Date(d.getFullYear()+70,d.getMonth(),d.getDate()),c=new Date(l);c.setDate(c.getDate()-1);let g=c.getFullYear(),R=c.getMonth()+1,x=g,y=R-1;y===0&&(y=12,x-=1);let F=a<x||a===x&&h<=y;return t.seniorVoluntaryEnrollment==="\u3059\u308B"?!0:F}static judgeInternationalSocialInsurance(t){return t.dispatchedAbroad==="\u8A72\u5F53\u3057\u306A\u3044"?!1:t.socialSecurityAgreement==="\u8A72\u5F53\u3057\u306A\u3044"||t.socialSecurityAgreement==="\u8A72\u5F53\u3059\u308B"&&(t.dispatchedAbroad==="\u65E5\u672C\u304B\u3089\u5916\u56FD\u3078\u306E\u6D3E\u9063\u52B4\u50CD\u8005"&&t.temporaryDispatch==="\u8A72\u5F53\u3059\u308B"||t.dispatchedAbroad==="\u5916\u56FD\u304B\u3089\u65E5\u672C\u3078\u306E\u6D3E\u9063\u52B4\u50CD\u8005"&&t.temporaryDispatch==="\u8A72\u5F53\u3057\u306A\u3044")}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=j({type:n,selectors:[["app-judge"]],decls:2,vars:0,template:function(e,a){e&1&&(i(0,"p"),o(1,"judge works!"),r())},encapsulation:2})};function ae(n,t){n&1&&(i(0,"span"),o(1,"\u2716"),r())}function ie(n,t){if(n&1&&(i(0,"span"),o(1),r()),n&2){let e=f();s(),S(e.healthInsuranceResult?"\u3007":"\u2716")}}function re(n,t){n&1&&(i(0,"span"),o(1,"\u2716"),r())}function oe(n,t){if(n&1&&(i(0,"span"),o(1),r()),n&2){let e=f();s(),S(e.careInsuranceResult?"\u3007":"\u2716")}}function se(n,t){n&1&&(i(0,"span"),o(1,"\u2716"),r())}function le(n,t){if(n&1&&(i(0,"span"),o(1),r()),n&2){let e=f();s(),S(e.pensionInsuranceResult?"\u3007":"\u2716")}}function ue(n,t){if(n&1){let e=q();i(0,"button",16),W("click",function(){z(e);let h=f();return $(h.onSaveCalc())}),o(1,"\u8A08\u7B97\u7D50\u679C\u3092\u4FDD\u5B58"),r()}}function ce(n,t){n&1&&(i(0,"div",17),o(1,"\u8A08\u7B97\u4E2D\u30FB\u30FB\u30FB"),r())}function de(n,t){n&1&&(i(0,"div",18),o(1," \u793E\u4F1A\u4FDD\u967A\u52A0\u5165\u5BFE\u8C61\u5916\u3067\u3059 "),r())}function me(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u5065\u5EB7\u4FDD\u967A\uFF08\u5168\u984D\uFF09"),r(),i(3,"span",22),o(4),_(5,"number"),r()()),n&2){let e=f(2);s(4),D("",e.latestStandard!=null&&e.latestStandard.kenpoStandardMonthly?v(5,3,e.latestStandard.kenpoStandardMonthly,"1.0-0"):"---","\u5186\xD7",e.healthInsuranceRate100,"\uFF05\uFF1D",e.healthInsuranceAmount,"\u5186")}}function pe(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u5065\u5EB7\u4FDD\u967A\uFF08\u4F1A\u793E\u8CA0\u62C5\uFF09"),r(),i(3,"span",22),o(4),_(5,"number"),r()()),n&2){let e=f(2);s(4),D("",e.latestStandard!=null&&e.latestStandard.kenpoStandardMonthly?v(5,3,e.latestStandard.kenpoStandardMonthly,"1.0-0"):"---","\u5186\xD7",e.healthInsuranceRate100,"\uFF05\xF72\uFF1D",e.healthInsuranceAmountCompany,"\u5186")}}function he(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u5065\u5EB7\u4FDD\u967A\uFF08\u5F93\u696D\u54E1\u8CA0\u62C5\uFF09"),r(),i(3,"span",22),o(4),_(5,"number"),r()()),n&2){let e=f(2);s(4),D("",e.latestStandard!=null&&e.latestStandard.kenpoStandardMonthly?v(5,3,e.latestStandard.kenpoStandardMonthly,"1.0-0"):"---","\u5186\xD7",e.healthInsuranceRate100,"\uFF05\xF72\uFF1D",e.healthInsuranceAmountEmployee,"\u5186")}}function fe(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u4ECB\u8B77\u4FDD\u967A\uFF08\u5168\u984D\uFF09"),r(),i(3,"span",22),o(4),_(5,"number"),r()()),n&2){let e=f(2);s(4),D("",e.latestStandard!=null&&e.latestStandard.kenpoStandardMonthly?v(5,3,e.latestStandard.kenpoStandardMonthly,"1.0-0"):"---","\u5186\xD7",e.careInsuranceRate100,"\uFF05\uFF1D",e.careInsuranceAmount,"\u5186")}}function ge(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u4ECB\u8B77\u4FDD\u967A\uFF08\u4F1A\u793E\u8CA0\u62C5\uFF09"),r(),i(3,"span",22),o(4),_(5,"number"),r()()),n&2){let e=f(2);s(4),D("",e.latestStandard!=null&&e.latestStandard.kenpoStandardMonthly?v(5,3,e.latestStandard.kenpoStandardMonthly,"1.0-0"):"---","\u5186\xD7",e.careInsuranceRate100,"\uFF05\xF72\uFF1D",e.careInsuranceAmountCompany,"\u5186")}}function ye(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u4ECB\u8B77\u4FDD\u967A\uFF08\u5F93\u696D\u54E1\u8CA0\u62C5\uFF09"),r(),i(3,"span",22),o(4),_(5,"number"),r()()),n&2){let e=f(2);s(4),D("",e.latestStandard!=null&&e.latestStandard.kenpoStandardMonthly?v(5,3,e.latestStandard.kenpoStandardMonthly,"1.0-0"):"---","\u5186\xD7",e.careInsuranceRate100,"\uFF05\xF72\uFF1D",e.careInsuranceAmountEmployee,"\u5186")}}function Ie(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u539A\u751F\u5E74\u91D1\uFF08\u5168\u984D\uFF09"),r(),i(3,"span",22),o(4),_(5,"number"),r()()),n&2){let e=f(2);s(4),D("",e.latestStandard!=null&&e.latestStandard.nenkinStandardMonthly?v(5,3,e.latestStandard.nenkinStandardMonthly,"1.0-0"):"---","\u5186\xD7",e.pensionInsuranceRate100,"\uFF05\uFF1D",e.pensionInsuranceAmount,"\u5186")}}function xe(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u539A\u751F\u5E74\u91D1\uFF08\u4F1A\u793E\u8CA0\u62C5\uFF09"),r(),i(3,"span",22),o(4),_(5,"number"),r()()),n&2){let e=f(2);s(4),D("",e.latestStandard!=null&&e.latestStandard.nenkinStandardMonthly?v(5,3,e.latestStandard.nenkinStandardMonthly,"1.0-0"):"---","\u5186\xD7",e.pensionInsuranceRate100,"\uFF05\xF72\uFF1D",e.pensionInsuranceAmountCompany,"\u5186")}}function Ce(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u539A\u751F\u5E74\u91D1\uFF08\u5F93\u696D\u54E1\u8CA0\u62C5\uFF09"),r(),i(3,"span",22),o(4),_(5,"number"),r()()),n&2){let e=f(2);s(4),D("",e.latestStandard!=null&&e.latestStandard.nenkinStandardMonthly?v(5,3,e.latestStandard.nenkinStandardMonthly,"1.0-0"):"---","\u5186\xD7",e.pensionInsuranceRate100,"\uFF05\xF72\uFF1D",e.pensionInsuranceAmountEmployee,"\u5186")}}function De(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u5168\u984D\u5408\u8A08"),r(),i(3,"span",22),o(4),r()()),n&2){let e=f(2);s(4),L("",e.totalInsuranceAmount,"\u5186")}}function _e(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u4F1A\u793E\u8CA0\u62C5\u5408\u8A08"),r(),i(3,"span",22),o(4),r()()),n&2){let e=f(2);s(4),L("",e.totalInsuranceAmountCompany,"\u5186")}}function ve(n,t){if(n&1&&(i(0,"div",20)(1,"span",21),o(2,"\u5F93\u696D\u54E1\u8CA0\u62C5\u5408\u8A08"),r(),i(3,"span",22),o(4),r()()),n&2){let e=f(2);s(4),L("",e.totalInsuranceAmountEmployee,"\u5186")}}function Se(n,t){if(n&1&&(i(0,"div"),P(1,me,6,6,"div",19)(2,pe,6,6,"div",19)(3,he,6,6,"div",19)(4,fe,6,6,"div",19)(5,ge,6,6,"div",19)(6,ye,6,6,"div",19)(7,Ie,6,6,"div",19)(8,xe,6,6,"div",19)(9,Ce,6,6,"div",19)(10,De,5,1,"div",19)(11,_e,5,1,"div",19)(12,ve,5,1,"div",19),r()),n&2){let e=f();s(),p("ngIf",e.healthInsuranceResult),s(),p("ngIf",e.healthInsuranceResult),s(),p("ngIf",e.healthInsuranceResult),s(),p("ngIf",e.careInsuranceResult),s(),p("ngIf",e.careInsuranceResult),s(),p("ngIf",e.careInsuranceResult),s(),p("ngIf",e.pensionInsuranceResult),s(),p("ngIf",e.pensionInsuranceResult),s(),p("ngIf",e.pensionInsuranceResult),s(),p("ngIf",e.healthInsuranceResult||e.careInsuranceResult||e.pensionInsuranceResult),s(),p("ngIf",e.healthInsuranceResult||e.careInsuranceResult||e.pensionInsuranceResult),s(),p("ngIf",e.healthInsuranceResult||e.careInsuranceResult||e.pensionInsuranceResult)}}var ee=class n{constructor(t,e,a){this.route=t;this.firestore=e;this.router=a}employeesId="";companyId="";employeeData=null;companyData=null;officeData=null;insuranceRateData=null;currentNendo=(()=>{let t=new Date,e=t.getFullYear();return t.getMonth()+1>=4?e:e-1})();standardsList=[];isLoading=!0;eligibilityResult=null;isSocialInsuranceExcluded=!1;healthInsuranceResult=!1;careInsuranceResult=!1;pensionInsuranceResult=!1;hasUnsavedCalc=!1;ngOnInit(){return T(this,null,function*(){this.isLoading=!0,this.employeesId=this.route.snapshot.paramMap.get("id")||"";let t=A(this.firestore,"companies"),e=yield w(t);for(let a of e.docs){let h=A(this.firestore,"companies",a.id,"employees"),d=yield w(h);for(let l of d.docs)if(l.id===this.employeesId){this.companyId=a.id,this.employeeData=l.data();let c=U(this.firestore,"companies",this.companyId),g=yield Y(c);if(this.companyData=g.exists()?g.data():null,this.employeeData.officesId){let m=U(this.firestore,"companies",this.companyId,"offices",this.employeeData.officesId),E=yield Y(m);if(this.officeData=E.exists()?E.data():null,this.officeData&&this.officeData.officePrefecture){let O=A(this.firestore,"insurance_rates"),H=yield w(O);this.insuranceRateData=H.docs.map(B=>B.data()).find(B=>B.prefecture===this.officeData.officePrefecture&&String(B.year)===String(this.currentNendo))||null}}if(!I.judgeSocialInsuranceRequired({employee:this.employeeData,office:this.officeData,company:this.companyData})){this.isSocialInsuranceExcluded=!0,this.isLoading=!1;return}let x=I.judgeHealthInsurance(this.employeeData);console.log("[\u5065\u5EB7\u4FDD\u967A\u5224\u5B9A]",x);let y=I.judgeCareInsurance(this.employeeData);console.log("[\u4ECB\u8B77\u4FDD\u967A\u5224\u5B9A]",y);let F=I.judgePensionInsurance(this.employeeData);if(console.log("[\u539A\u751F\u5E74\u91D1\u5224\u5B9A]",F),this.employeeData.dispatchedAbroad!=="\u8A72\u5F53\u3057\u306A\u3044"){let m=I.judgeInternationalSocialInsurance(this.employeeData);if(console.log("[\u6D77\u5916\u6D3E\u9063\u5224\u5B9A]",m),!m){this.isSocialInsuranceExcluded=!0,this.isLoading=!1;return}}else console.log("[\u6D77\u5916\u6D3E\u9063\u5224\u5B9A] \u5224\u5B9A\u3057\u306A\u3044");this.healthInsuranceResult=I.judgeHealthInsurance(this.employeeData),this.careInsuranceResult=I.judgeCareInsurance(this.employeeData),this.pensionInsuranceResult=I.judgePensionInsurance(this.employeeData),this.eligibilityResult=I.judgeEligibility(this.employeeData);let M=A(this.firestore,`companies/${this.companyId}/employees/${this.employeesId}/standards`),C=yield w(M);this.standardsList=C.docs.map(m=>b({id:m.id},m.data())).filter(m=>!!m.createdAt).map(m=>k(b({},m),{_millis:m.createdAt?.toDate?m.createdAt.toDate().getTime():m.createdAt?new Date(m.createdAt).getTime():0})).sort((m,E)=>E._millis-m._millis),this.isLoading=!1,yield this.checkUnsavedCalc();return}}console.log("currentNendo:",this.currentNendo),this.isLoading=!1,yield this.checkUnsavedCalc()})}get healthInsuranceRate100(){if(!this.insuranceRateData||this.insuranceRateData.health_insurance==null)return"";try{return new u(this.insuranceRateData.health_insurance).times(100).toString()}catch{return""}}get careInsuranceRate100(){if(!this.insuranceRateData||this.insuranceRateData.care_insurance==null)return"";try{return new u(this.insuranceRateData.care_insurance).times(100).toString()}catch{return""}}get pensionInsuranceRate100(){if(!this.insuranceRateData||this.insuranceRateData.pension_insurance==null)return"";try{return new u(this.insuranceRateData.pension_insurance).times(100).toString()}catch{return""}}formatWithComma(t){if(t==null||t==="")return"";let e=typeof t=="number"?t:Number(t);return isNaN(e)?"":e.toLocaleString()}get latestStandard(){if(!this.standardsList||this.standardsList.length===0)return null;let t=this.standardsList.filter(e=>!!e.createdAt);return t.length===0?null:t.map(e=>k(b({},e),{_millis:e.createdAt?.toDate?e.createdAt.toDate().getTime():e.createdAt?new Date(e.createdAt).getTime():0})).sort((e,a)=>a._millis-e._millis)[0]}get healthInsuranceAmount(){if(!this.healthInsuranceResult||!this.insuranceRateData)return"";let t=this.latestStandard?.kenpoStandardMonthly??(this.employeeData?this.employeeData.stdSalaryHealth:null),e=this.insuranceRateData.health_insurance;if(t==null||e==null)return"";try{return this.formatWithComma(new u(t).times(new u(e)).toDecimalPlaces(0,u.ROUND_HALF_UP).toString())}catch{return""}}get healthInsuranceAmountCompany(){if(!this.healthInsuranceResult)return"";let t=this.healthInsuranceAmount.replace(/,/g,"");if(!t)return"";try{return this.formatWithComma(new u(t).div(2).toDecimalPlaces(0,u.ROUND_HALF_UP).toString())}catch{return""}}get healthInsuranceAmountEmployee(){if(!this.healthInsuranceResult)return"";let t=this.healthInsuranceAmount.replace(/,/g,"");if(!t)return"";try{let e=new u(t).div(2);return e.minus(e.floor()).times(10).toNumber()<=5?this.formatWithComma(e.floor().toString()):this.formatWithComma(e.ceil().toString())}catch{return""}}get pensionInsuranceAmount(){if(!this.pensionInsuranceResult||!this.insuranceRateData)return"";let t=this.latestStandard?.nenkinStandardMonthly??(this.employeeData?this.employeeData.stdSalaryPension:null),e=this.insuranceRateData.pension_insurance;if(t==null||e==null)return"";try{return this.formatWithComma(new u(t).times(new u(e)).toFixed(0))}catch{return""}}get pensionInsuranceAmountCompany(){if(!this.pensionInsuranceResult)return"";let t=this.pensionInsuranceAmount.replace(/,/g,"");if(!t)return"";try{return this.formatWithComma(new u(t).div(2).toDecimalPlaces(0,u.ROUND_HALF_UP).toString())}catch{return""}}get pensionInsuranceAmountEmployee(){if(!this.pensionInsuranceResult)return"";let t=this.pensionInsuranceAmount.replace(/,/g,"");if(!t)return"";try{let e=new u(t).div(2);return e.minus(e.floor()).times(10).toNumber()<=5?this.formatWithComma(e.floor().toString()):this.formatWithComma(e.ceil().toString())}catch{return""}}get careInsuranceAmount(){if(!this.careInsuranceResult||!this.insuranceRateData)return"";let t=this.latestStandard?.kenpoStandardMonthly??(this.employeeData?this.employeeData.stdSalaryHealth:null),e=this.insuranceRateData.care_insurance;if(t==null||e==null)return"";try{return this.formatWithComma(new u(t).times(new u(e)).toDecimalPlaces(0,u.ROUND_HALF_UP).toString())}catch{return""}}get careInsuranceAmountCompany(){if(!this.careInsuranceResult)return"";let t=this.careInsuranceAmount.replace(/,/g,"");if(!t)return"";try{return this.formatWithComma(new u(t).div(2).toDecimalPlaces(0,u.ROUND_HALF_UP).toString())}catch{return""}}get careInsuranceAmountEmployee(){if(!this.careInsuranceResult)return"";let t=this.careInsuranceAmount.replace(/,/g,"");if(!t)return"";try{let e=new u(t).div(2);return e.minus(e.floor()).times(10).toNumber()<=5?this.formatWithComma(e.floor().toString()):this.formatWithComma(e.ceil().toString())}catch{return""}}get totalInsuranceAmount(){let t=this.healthInsuranceResult?this.healthInsuranceAmount.replace(/,/g,""):"",e=this.pensionInsuranceResult?this.pensionInsuranceAmount.replace(/,/g,""):"",a=this.careInsuranceResult?this.careInsuranceAmount.replace(/,/g,""):"";if(!t&&!e&&!a)return"";try{return this.formatWithComma(new u(t||0).plus(new u(e||0)).plus(new u(a||0)).toString())}catch{return""}}get totalInsuranceAmountCompany(){let t=this.healthInsuranceResult?this.healthInsuranceAmountCompany.replace(/,/g,""):"",e=this.pensionInsuranceResult?this.pensionInsuranceAmountCompany.replace(/,/g,""):"",a=this.careInsuranceResult?this.careInsuranceAmountCompany.replace(/,/g,""):"";if(!t&&!e&&!a)return"";try{return this.formatWithComma(new u(t||0).plus(new u(e||0)).plus(new u(a||0)).toString())}catch{return""}}get totalInsuranceAmountEmployee(){let t=this.healthInsuranceResult?this.healthInsuranceAmountEmployee.replace(/,/g,""):"",e=this.pensionInsuranceResult?this.pensionInsuranceAmountEmployee.replace(/,/g,""):"",a=this.careInsuranceResult?this.careInsuranceAmountEmployee.replace(/,/g,""):"";if(!t&&!e&&!a)return"";try{return this.formatWithComma(new u(t||0).plus(new u(e||0)).plus(new u(a||0)).toString())}catch{return""}}get stdSalaryHealthWithComma(){return!this.employeeData||this.employeeData.stdSalaryHealth==null?"":this.formatWithComma(this.employeeData.stdSalaryHealth)}get stdSalaryPensionWithComma(){return!this.employeeData||this.employeeData.stdSalaryPension==null?"":this.formatWithComma(this.employeeData.stdSalaryPension)}checkUnsavedCalc(){return T(this,null,function*(){if(!this.companyId||!this.employeesId||!this.latestStandard){this.hasUnsavedCalc=!1;return}let t=A(this.firestore,`companies/${this.companyId}/employees/${this.employeesId}/insurances`),h=(yield w(t)).docs.map(l=>b({id:l.id},l.data())).filter(l=>!!l.createdAt).map(l=>k(b({},l),{_millis:l.createdAt?.toDate?l.createdAt.toDate().getTime():l.createdAt?new Date(l.createdAt).getTime():0})).sort((l,c)=>c._millis-l._millis)[0],d=this.latestStandard?.id;this.hasUnsavedCalc=!(h&&h.standardId===d)})}onSaveCalc=()=>T(this,null,function*(){if(!this.companyId||!this.employeesId||!this.latestStandard)return;let t=A(this.firestore,`companies/${this.companyId}/employees/${this.employeesId}/insurances`),h=(yield w(t)).docs.map(c=>b({id:c.id},c.data())).filter(c=>!!c.createdAt).map(c=>k(b({},c),{_millis:c.createdAt?.toDate?c.createdAt.toDate().getTime():c.createdAt?new Date(c.createdAt).getTime():0})).sort((c,g)=>g._millis-c._millis)[0],d=this.latestStandard?.id;if(h&&h.standardId===d){alert("\u3059\u3067\u306B\u3053\u306E\u6A19\u6E96\u5831\u916C\u6708\u984D\u30FB\u7B49\u7D1A\u3067\u8A08\u7B97\u7D50\u679C\u304C\u4FDD\u5B58\u3055\u308C\u3066\u3044\u307E\u3059\u3002");return}let l={standardId:d,employeeId:this.employeesId,createdAt:new Date};this.healthInsuranceResult&&(l.healthInsuranceTotal=this.healthInsuranceAmount.replace(/,/g,""),l.healthInsuranceCompany=this.healthInsuranceAmountCompany.replace(/,/g,""),l.healthInsuranceEmployee=this.healthInsuranceAmountEmployee.replace(/,/g,"")),this.careInsuranceResult&&(l.careInsuranceTotal=this.careInsuranceAmount.replace(/,/g,""),l.careInsuranceCompany=this.careInsuranceAmountCompany.replace(/,/g,""),l.careInsuranceEmployee=this.careInsuranceAmountEmployee.replace(/,/g,"")),this.pensionInsuranceResult&&(l.pensionInsuranceTotal=this.pensionInsuranceAmount.replace(/,/g,""),l.pensionInsuranceCompany=this.pensionInsuranceAmountCompany.replace(/,/g,""),l.pensionInsuranceEmployee=this.pensionInsuranceAmountEmployee.replace(/,/g,"")),l.total=this.totalInsuranceAmount.replace(/,/g,""),l.totalCompany=this.totalInsuranceAmountCompany.replace(/,/g,""),l.totalEmployee=this.totalInsuranceAmountEmployee.replace(/,/g,""),yield Z(t,l),alert("\u8A08\u7B97\u7D50\u679C\u3092\u4FDD\u5B58\u3057\u307E\u3057\u305F\u3002"),this.router.navigate(["/employee-detail",this.employeesId])});onNavigateToDetail=()=>T(this,null,function*(){if(yield this.checkUnsavedCalc(),this.hasUnsavedCalc){alert("\u8A08\u7B97\u7D50\u679C\u3092\u4FDD\u5B58\u3057\u3066\u304F\u3060\u3055\u3044");return}this.router.navigate(["/employee-detail",this.employeesId])});static \u0275fac=function(e){return new(e||n)(N(K),N(X),N(Q))};static \u0275cmp=j({type:n,selectors:[["app-calculate"]],decls:57,vars:15,consts:[[1,"calculate-header"],[1,"calculate-header-title"],[1,"to-detail-btn",3,"click"],[1,"info-calc-flex",2,"margin-top","0"],[1,"office-info"],[1,"office-label"],[1,"office-value"],[1,"extra-info-box"],[1,"extra-info-row"],[1,"extra-info-label"],[1,"extra-info-value"],[4,"ngIf"],[1,"calculate-container"],["type","button","class","save-calc-btn",3,"click",4,"ngIf"],["class","loading-message",4,"ngIf"],["class","excluded-message",4,"ngIf"],["type","button",1,"save-calc-btn",3,"click"],[1,"loading-message"],[1,"excluded-message"],["class","calc-row",4,"ngIf"],[1,"calc-row"],[1,"calc-label"],[1,"calc-value"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"span",1),o(2,"\u8A08\u7B97\u7D50\u679C\u8868\u793A\u753B\u9762"),r(),i(3,"button",2),W("click",function(){return a.onNavigateToDetail()}),o(4,"\u5F93\u696D\u54E1\u8A73\u7D30\u753B\u9762\u3078"),r()(),i(5,"div",3)(6,"div")(7,"div",4)(8,"div")(9,"span",5),o(10,"\u6240\u5C5E\u4E8B\u696D\u6240\uFF1A"),r(),i(11,"span",6),o(12),r()(),i(13,"div")(14,"span",5),o(15,"\u6240\u5728\u90FD\u9053\u5E9C\u770C\uFF1A"),r(),i(16,"span",6),o(17),r()(),i(18,"div")(19,"span",5),o(20,"\u5065\u5EB7\u4FDD\u967A\u6599\u7387\uFF1A"),r(),i(21,"span",6),o(22),r()(),i(23,"div")(24,"span",5),o(25,"\u4ECB\u8B77\u4FDD\u967A\u6599\u7387\uFF1A"),r(),i(26,"span",6),o(27),r()(),i(28,"div")(29,"span",5),o(30,"\u539A\u751F\u5E74\u91D1\u4FDD\u967A\u6599\u7387\uFF1A"),r(),i(31,"span",6),o(32),r()()(),i(33,"div",7)(34,"div",8)(35,"span",9),o(36,"\u5065\u5EB7\u4FDD\u967A\u5BFE\u8C61\uFF1A"),r(),i(37,"span",10),P(38,ae,2,0,"span",11)(39,ie,2,1,"span",11),r()(),i(40,"div",8)(41,"span",9),o(42,"\u4ECB\u8B77\u4FDD\u967A\uFF1A"),r(),i(43,"span",10),P(44,re,2,0,"span",11)(45,oe,2,1,"span",11),r()(),i(46,"div",8)(47,"span",9),o(48,"\u539A\u751F\u5E74\u91D1\u5BFE\u8C61\uFF1A"),r(),i(49,"span",10),P(50,se,2,0,"span",11)(51,le,2,1,"span",11),r()()()(),i(52,"div",12),P(53,ue,2,0,"button",13)(54,ce,2,0,"div",14)(55,de,2,0,"div",15)(56,Se,13,12,"div",11),r()()),e&2&&(s(12),S((a.officeData==null?null:a.officeData.officeName)||"---"),s(5),S((a.officeData==null?null:a.officeData.officePrefecture)||"---"),s(5),S(a.insuranceRateData!=null&&a.insuranceRateData.health_insurance?a.insuranceRateData.health_insurance*100+"\uFF05":"---"),s(5),S(a.insuranceRateData!=null&&a.insuranceRateData.care_insurance?a.insuranceRateData.care_insurance*100+"\uFF05":"---"),s(5),S(a.insuranceRateData!=null&&a.insuranceRateData.pension_insurance?a.insuranceRateData.pension_insurance*100+"\uFF05":"---"),s(6),p("ngIf",a.isSocialInsuranceExcluded),s(),p("ngIf",!a.isSocialInsuranceExcluded),s(5),p("ngIf",a.isSocialInsuranceExcluded),s(),p("ngIf",!a.isSocialInsuranceExcluded),s(5),p("ngIf",a.isSocialInsuranceExcluded),s(),p("ngIf",!a.isSocialInsuranceExcluded),s(2),p("ngIf",!a.isSocialInsuranceExcluded),s(),p("ngIf",a.isLoading),s(),p("ngIf",a.isSocialInsuranceExcluded),s(),p("ngIf",!a.isSocialInsuranceExcluded&&a.employeeData))},dependencies:[V,G,J],styles:[".calculate-container[_ngcontent-%COMP%]{padding-top:4rem;max-width:600px;margin:0 auto;background:#f8fafc;border-radius:12px;box-shadow:0 2px 12px #1976d212;padding-bottom:2.5rem}.calculate-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:1.2rem}.calculate-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:1.04rem;color:#222;padding:.32rem .2rem;border-bottom:1px solid #e3e8ee}.calculate-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{border-bottom:none}.calculate-container[_ngcontent-%COMP%]   .loading-message[_ngcontent-%COMP%]{text-align:center;font-size:1.08rem;color:#1976d2;padding:2.5rem 0;font-weight:600}.save-calc-btn[_ngcontent-%COMP%]{display:block;margin:.1rem auto;background:#1976d2;color:#fff;font-size:.95rem;font-weight:600;padding:.4rem 1.2rem;border:none;border-radius:7px;cursor:pointer;box-shadow:0 1px 4px #1976d214;transition:background .2s}.save-calc-btn[_ngcontent-%COMP%]:hover{background:#1565c0}@media (max-width: 600px){.calculate-container[_ngcontent-%COMP%]{padding:1.2rem .5rem 2rem;max-width:99vw}.calculate-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:.98rem}.save-calc-btn[_ngcontent-%COMP%]{font-size:.98rem;padding:.6rem 1.2rem}}.info-calc-flex[_ngcontent-%COMP%]{display:flex;gap:2.2rem;align-items:flex-start;justify-content:center;margin-top:1.5rem;max-width:1200px;margin-left:auto;margin-right:auto;padding-top:3.5rem}.office-info[_ngcontent-%COMP%]{min-width:260px;max-width:340px;flex:0 0 320px;background:#e3f2fd;border-radius:14px;padding:1.3rem 1.5rem;font-size:1.04rem;color:#1976d2;box-shadow:0 2px 8px #1976d20f;display:flex;flex-direction:column;gap:.5rem}.office-info[_ngcontent-%COMP%]   .office-label[_ngcontent-%COMP%]{font-weight:600;color:#1565c0}.office-info[_ngcontent-%COMP%]   .office-value[_ngcontent-%COMP%]{font-weight:500;color:#1976d2}.calculate-container[_ngcontent-%COMP%]{flex:1 1 600px;max-width:600px;background:#f8fafc;border-radius:14px;box-shadow:0 2px 12px #1976d212;padding-top:0!important;padding-right:1.5rem;padding-bottom:2.5rem;padding-left:1.5rem}@media (max-width: 900px){.info-calc-flex[_ngcontent-%COMP%]{flex-direction:column;gap:1.2rem;margin-top:1.2rem;max-width:99vw;padding-top:3.2rem}.office-info[_ngcontent-%COMP%], .calculate-container[_ngcontent-%COMP%]{max-width:99vw;min-width:0;flex:1 1 100%;margin:0 auto}}.calc-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.5rem;font-size:1.04rem;color:#222;padding:.32rem .2rem;border-bottom:1px solid #e3e8ee}.calc-label[_ngcontent-%COMP%]{min-width:12em;text-align:left;font-weight:600;color:#1976d2;flex-shrink:0;margin-right:.7em}.calc-value[_ngcontent-%COMP%]{flex:1;word-break:break-all}.extra-info-row[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:1.01rem;margin-bottom:.5rem;padding:.2rem .3rem}.extra-info-label[_ngcontent-%COMP%]{min-width:6.5em;font-weight:600;color:#1976d2}.extra-info-value[_ngcontent-%COMP%]{flex:1;color:#222}.extra-info-box[_ngcontent-%COMP%]{min-width:260px;max-width:340px;background:#e3f2fd;border-radius:14px;margin-top:1.2rem;box-shadow:0 2px 8px #1976d20f;padding:1.1rem 1.2rem}.excluded-message[_ngcontent-%COMP%]{color:#d32f2f;background:#fff0f0;border:none;border-radius:8px;font-size:1.25em;font-weight:700;padding:18px 0;text-align:center;margin:18px 0 12px;letter-spacing:.05em;box-shadow:0 2px 8px #d32f2f14;width:100%;box-sizing:border-box;margin-left:-1.5rem;margin-right:-1.5rem}.calculate-header[_ngcontent-%COMP%]{width:100%;padding-top:3.5rem;margin-bottom:0;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;gap:.7rem}.calculate-header-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#1976d2;letter-spacing:.04em;margin-left:.2em}.to-detail-btn[_ngcontent-%COMP%]{background:#42a5f5;color:#fff;border:none;border-radius:7px;font-size:1.02em;font-weight:600;padding:.5em 1.6em;cursor:pointer;box-shadow:0 1px 4px #1976d214;transition:background .2s}.to-detail-btn[_ngcontent-%COMP%]:hover{background:#1976d2}.info-calc-flex[_ngcontent-%COMP%]{margin-top:2.5rem}"]})};export{ee as CalculateComponent};
