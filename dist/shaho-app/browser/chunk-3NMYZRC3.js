import{a as b}from"./chunk-FUHT4GF3.js";import{f as I,g as A,i as z}from"./chunk-QYZA2DXR.js";import{Ac as B,Bc as _,Cb as a,Db as C,Eb as m,Kd as q,Ne as M,Pa as f,Za as R,_ as p,a as h,af as P,b as k,bb as v,d as w,da as y,de as g,ib as S,ic as D,ja as N,mb as i,mc as F,nb as r,ub as E,wc as j,ye as x}from"./chunk-7TGFAU7G.js";function G(d,o){if(d&1&&(i(0,"tr")(1,"td"),a(2),r(),i(3,"td"),a(4),r(),i(5,"td"),a(6),r(),i(7,"td"),a(8),r(),i(9,"td"),a(10),r()()),d&2){let e,n,u,s=o.$implicit,l=E();f(2),C(s.officeName),f(2),C(s.officePrefecture),f(2),m(" ",(e=l.getHealthInsuranceRate(s.officePrefecture))!==null&&e!==void 0?e:"","\uFF05 "),f(2),m(" ",(n=l.getCareInsuranceRate(s.officePrefecture))!==null&&n!==void 0?n:"","\uFF05 "),f(2),m(" ",(u=l.getPensionInsuranceRate(s.officePrefecture))!==null&&u!==void 0?u:"","\uFF05 ")}}var H=class d{auth=p(j);firestore=p(q);injector=p(N);router=p(I);prefectures=[];columns=[[],[],[],[]];companies=[];offices=[];insuranceRates=[];currentNendo=(()=>{let o=new Date,e=o.getFullYear();return o.getMonth()+1>=4?e:e-1})();splitColumns(){this.columns=[this.prefectures.slice(0,12),this.prefectures.slice(12,24),this.prefectures.slice(24,36),this.prefectures.slice(36,47)]}ngOnInit(){let o=B();_(o,e=>{e||this.router.navigate(["/login"])}),y(this.injector,()=>{_(this.auth,e=>w(this,null,function*(){if(e){let n=g(this.firestore,"companies"),u=M(n,P("createdBy","==",e.uid)),s=yield x(u);this.companies=s.docs.map(t=>h({id:t.id},t.data())),this.offices=[];for(let t of s.docs){let c=g(this.firestore,"companies",t.id,"offices"),Y=(yield x(c)).docs.map(O=>k(h({id:O.id},O.data()),{companyId:t.id}));this.offices.push(...Y)}this.offices.sort((t,c)=>t.officeNumber==null&&c.officeNumber==null?0:t.officeNumber==null?1:c.officeNumber==null?-1:!isNaN(Number(t.officeNumber))&&!isNaN(Number(c.officeNumber))?Number(t.officeNumber)-Number(c.officeNumber):String(t.officeNumber).localeCompare(String(c.officeNumber),"ja",{numeric:!0}));let l=g(this.firestore,`rates/${e.uid}/kenpoRates`),L=yield x(l);this.prefectures=L.docs.map(t=>t.data()).sort((t,c)=>Number(t.code)-Number(c.code)),this.splitColumns();let T=g(this.firestore,"insurance_rates"),$=M(T,P("year","==",this.currentNendo)),Q=(yield x($)).docs.map(t=>h({id:t.id},t.data()));this.insuranceRates=Q}}))})}getHealthInsuranceRate(o){let e=this.insuranceRates.find(n=>n.prefecture===o)?.health_insurance;if(e==null||e==="")return"";try{return new b(e).times(100).toString()}catch{return""}}getCareInsuranceRate(o){let e=this.insuranceRates.find(n=>n.prefecture===o)?.care_insurance;if(e==null||e==="")return"";try{return new b(e).times(100).toString()}catch{return""}}getPensionInsuranceRate(o){let e=this.insuranceRates.find(n=>n.prefecture===o)?.pension_insurance;if(e==null||e==="")return"";try{return new b(e).times(100).toString()}catch{return""}}static \u0275fac=function(e){return new(e||d)};static \u0275cmp=R({type:d,selectors:[["app-rates-management"]],decls:21,vars:2,consts:[[1,"admin-container",2,"margin-top","80px"],[1,"nendo-display"],[1,"office-table"],[4,"ngFor","ngForOf"],[1,"kenpo-link-center"],["routerLink","/kenpo-rates",1,"kenpo-link-btn"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1),a(2),r(),i(3,"table",2)(4,"thead")(5,"tr")(6,"th"),a(7,"\u4E8B\u696D\u6240\u540D"),r(),i(8,"th"),a(9,"\u90FD\u9053\u5E9C\u770C"),r(),i(10,"th"),a(11,"\u5065\u5EB7\u4FDD\u967A\u6599\u7387"),r(),i(12,"th"),a(13,"\u4ECB\u8B77\u4FDD\u967A\u6599\u7387"),r(),i(14,"th"),a(15,"\u539A\u751F\u5E74\u91D1\u4FDD\u967A\u6599\u7387"),r()()(),i(16,"tbody"),v(17,G,11,5,"tr",3),r()(),i(18,"div",4)(19,"a",5),a(20,"\u5168\u56FD\u5065\u5EB7\u4FDD\u967A\u6599\u7387\u4E00\u89A7"),r()()()),e&2&&(f(2),m(" ",n.currentNendo,"\u5E74\u5EA6 "),f(15),S("ngForOf",n.offices))},dependencies:[F,D,z,A],styles:[".admin-container[_ngcontent-%COMP%]{margin-top:72px;max-width:1300px;margin-left:auto;margin-right:auto;padding:0 16px;box-sizing:border-box}.admin-title[_ngcontent-%COMP%]{text-align:center;font-size:1.4rem;font-weight:700;color:#1976d2;margin:32px 0 18px;letter-spacing:.04em}.kenpo-table[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:0 auto 32px;border-collapse:collapse;background:#fff;box-shadow:0 2px 8px #1976d20f;border-radius:10px;overflow:hidden;font-size:1rem}.kenpo-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .kenpo-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;text-align:left;white-space:nowrap}.kenpo-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;font-weight:700;border-bottom:2px solid #90caf9}.kenpo-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background:#f5f7fa}.kenpo-table[_ngcontent-%COMP%]   th.rate-col[_ngcontent-%COMP%], .kenpo-table[_ngcontent-%COMP%]   td.rate-col[_ngcontent-%COMP%]{border-right:2px solid #90caf9}.kenpo-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin:0 auto;max-width:600px}.kenpo-card[_ngcontent-%COMP%]{background:#fff;border:1.5px solid #90caf9;border-radius:10px;box-shadow:0 2px 8px #1976d20f;padding:16px 0;text-align:center;font-size:1rem;display:flex;flex-direction:column;align-items:center;min-height:80px}.kenpo-code[_ngcontent-%COMP%]{color:#1976d2;font-weight:700;margin-bottom:2px}.kenpo-name[_ngcontent-%COMP%]{font-weight:600;margin-bottom:2px}.kenpo-rate[_ngcontent-%COMP%]{color:#888}@media (max-width: 700px){.kenpo-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;max-width:340px}}.kenpo-link-btn[_ngcontent-%COMP%]{display:inline-block;margin:0 0 24px;padding:10px 28px;background:#1976d2;color:#fff;border-radius:6px;font-weight:600;font-size:1rem;text-decoration:none;box-shadow:0 2px 8px #1976d214;transition:background .2s,box-shadow .2s;border:none}.kenpo-link-btn[_ngcontent-%COMP%]:hover{background:#1565c0;box-shadow:0 4px 16px #1976d221;color:#fff}.office-table[_ngcontent-%COMP%]{width:100%;max-width:900px;margin:32px auto 24px;border-collapse:collapse;background:#fff;box-shadow:0 2px 8px #1976d20f;border-radius:10px;overflow:hidden;font-size:1rem}.office-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .office-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:14px 18px;text-align:left;white-space:nowrap}.office-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;font-weight:700;border-bottom:2px solid #90caf9}.office-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background:#f5f7fa}.office-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#e3f2fd;transition:background .2s}.office-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #e0e0e0}@media (max-width: 700px){.office-table[_ngcontent-%COMP%]{font-size:.95rem;max-width:100%}.office-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .office-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 8px}}.kenpo-link-center[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.nendo-display[_ngcontent-%COMP%]{text-align:center;font-size:1.2rem;font-weight:600;color:#1976d2;margin-bottom:18px;letter-spacing:.04em}"]})};export{H as RatesManagementComponent};
