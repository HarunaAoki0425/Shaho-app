import{$a as ya,$b as Ia,Cb as Me,Db as ue,Ea as ma,X as xr,Z as $e,Za as _a,_ as Sd,a as Ki,aa as Pe,ab as je,ac as kd,b as Qi,c as Bt,ca as Et,cb as Ea,d as _,da as Ae,dc as wa,ea as ze,ec as Ta,fa as Nn,g as Lr,gc as Nd,hb as Pd,ia as Cd,ib as Xi,j as Ad,ja as Yi,jb as va,ka as Rd,l as Dd,m as bd,o as da,p as fa,q as pa,qa as vt,ua as Ji,wa as rt,za as ga}from"./chunk-5ATSOUQY.js";var Mr=new Pe("");var xd=null;function Zi(){return xd}function sy(n){xd??=n}var Aa=class{},Vr=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=$e({token:n,factory:()=>Ae(Md),providedIn:"platform"})}return n})(),oy=new Pe(""),Md=(()=>{class n extends Vr{_location;_history;_doc=Ae(Mr);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Zi().getBaseHref(this._doc)}onPopState(t){let r=Zi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Zi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=$e({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function es(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function Od(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function Ke(n){return n&&n[0]!=="?"?`?${n}`:n}var On=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=$e({token:n,factory:()=>Ae(Vd),providedIn:"root"})}return n})(),ts=new Pe(""),Vd=(()=>{class n extends On{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Ae(Mr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return es(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Ke(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let a=this.prepareExternalUrl(i+Ke(s));this._platformLocation.pushState(t,r,a)}replaceState(t,r,i,s){let a=this.prepareExternalUrl(i+Ke(s));this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(Et(Vr),Et(ts,8))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ud=(()=>{class n{_subject=new Ad;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=uy(Od(Fd(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Ke(r))}normalize(t){return n.stripTrailingSlash(cy(this._basePath,Fd(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ke(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ke(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Ke;static joinWithSlash=es;static stripTrailingSlash=Od;static \u0275fac=function(r){return new(r||n)(Et(On))};static \u0275prov=$e({token:n,factory:()=>ay(),providedIn:"root"})}return n})();function ay(){return new Ud(Et(On))}function cy(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Fd(n){return n.replace(/\/index.html$/,"")}function uy(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var dy=(()=>{class n extends On{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=es(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let a=this.prepareExternalUrl(i+Ke(s))||this._platformLocation.pathname;this._platformLocation.pushState(t,r,a)}replaceState(t,r,i,s){let a=this.prepareExternalUrl(i+Ke(s))||this._platformLocation.pathname;this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(Et(Vr),Et(ts,8))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})();var ka=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(ka||{});var De=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(De||{}),X=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(X||{}),Oe=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(Oe||{}),Fe={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function Gd(n){return Me(n)[ue.LocaleId]}function Wd(n,e,t){let r=Me(n),i=[r[ue.DayPeriodsFormat],r[ue.DayPeriodsStandalone]],s=qe(i,e);return qe(s,t)}function Hd(n,e,t){let r=Me(n),i=[r[ue.DaysFormat],r[ue.DaysStandalone]],s=qe(i,e);return qe(s,t)}function Kd(n,e,t){let r=Me(n),i=[r[ue.MonthsFormat],r[ue.MonthsStandalone]],s=qe(i,e);return qe(s,t)}function Qd(n,e){let r=Me(n)[ue.Eras];return qe(r,e)}function Ur(n,e){let t=Me(n);return qe(t[ue.DateFormat],e)}function Br(n,e){let t=Me(n);return qe(t[ue.TimeFormat],e)}function $r(n,e){let r=Me(n)[ue.DateTimeFormat];return qe(r,e)}function it(n,e){let t=Me(n),r=t[ue.NumberSymbols][e];if(typeof r>"u"){if(e===Fe.CurrencyDecimal)return t[ue.NumberSymbols][Fe.Decimal];if(e===Fe.CurrencyGroup)return t[ue.NumberSymbols][Fe.Group]}return r}function Yd(n,e){return Me(n)[ue.NumberFormats][e]}function Jd(n){if(!n[ue.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[ue.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Xd(n){let e=Me(n);return Jd(e),(e[ue.ExtraData][2]||[]).map(r=>typeof r=="string"?Da(r):[Da(r[0]),Da(r[1])])}function Zd(n,e,t){let r=Me(n);Jd(r);let i=[r[ue.ExtraData][0],r[ue.ExtraData][1]],s=qe(i,e)||[];return qe(s,t)||[]}function qe(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function Da(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var fy=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ns={},py=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function ef(n,e,t,r){let i=Ty(n);e=It(t,e)||e;let a=[],c;for(;e;)if(c=py.exec(e),c){a=a.concat(c.slice(1));let p=a.pop();if(!p)break;e=p}else{a.push(e);break}let l=i.getTimezoneOffset();r&&(l=nf(r,l),i=wy(i,r));let d="";return a.forEach(p=>{let g=vy(p);d+=g?g(i,t,l):p==="''"?"'":p.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),d}function as(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function It(n,e){let t=Gd(n);if(ns[t]??={},ns[t][e])return ns[t][e];let r="";switch(e){case"shortDate":r=Ur(n,Oe.Short);break;case"mediumDate":r=Ur(n,Oe.Medium);break;case"longDate":r=Ur(n,Oe.Long);break;case"fullDate":r=Ur(n,Oe.Full);break;case"shortTime":r=Br(n,Oe.Short);break;case"mediumTime":r=Br(n,Oe.Medium);break;case"longTime":r=Br(n,Oe.Long);break;case"fullTime":r=Br(n,Oe.Full);break;case"short":let i=It(n,"shortTime"),s=It(n,"shortDate");r=rs($r(n,Oe.Short),[i,s]);break;case"medium":let a=It(n,"mediumTime"),c=It(n,"mediumDate");r=rs($r(n,Oe.Medium),[a,c]);break;case"long":let l=It(n,"longTime"),d=It(n,"longDate");r=rs($r(n,Oe.Long),[l,d]);break;case"full":let p=It(n,"fullTime"),g=It(n,"fullDate");r=rs($r(n,Oe.Full),[p,g]);break}return r&&(ns[t][e]=r),r}function rs(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function Qe(n,e,t="-",r,i){let s="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,s=t));let a=String(n);for(;a.length<e;)a="0"+a;return r&&(a=a.slice(a.length-e)),s+a}function gy(n,e){return Qe(n,3).substring(0,e)}function le(n,e,t=0,r=!1,i=!1){return function(s,a){let c=my(n,s);if((t>0||c>-t)&&(c+=t),n===3)c===0&&t===-12&&(c=12);else if(n===6)return gy(c,e);let l=it(a,Fe.MinusSign);return Qe(c,e,l,r,i)}}function my(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function ee(n,e,t=De.Format,r=!1){return function(i,s){return _y(i,s,n,e,t,r)}}function _y(n,e,t,r,i,s){switch(t){case 2:return Kd(e,i,r)[n.getMonth()];case 1:return Hd(e,i,r)[n.getDay()];case 0:let a=n.getHours(),c=n.getMinutes();if(s){let d=Xd(e),p=Zd(e,i,r),g=d.findIndex(y=>{if(Array.isArray(y)){let[b,R]=y,O=a>=b.hours&&c>=b.minutes,k=a<R.hours||a===R.hours&&c<R.minutes;if(b.hours<R.hours){if(O&&k)return!0}else if(O||k)return!0}else if(y.hours===a&&y.minutes===c)return!0;return!1});if(g!==-1)return p[g]}return Wd(e,i,r)[a<12?0:1];case 3:return Qd(e,r)[n.getFullYear()<=0?0:1];default:let l=t;throw new Error(`unexpected translation type ${l}`)}}function is(n){return function(e,t,r){let i=-1*r,s=it(t,Fe.MinusSign),a=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case 0:return(i>=0?"+":"")+Qe(a,2,s)+Qe(Math.abs(i%60),2,s);case 1:return"GMT"+(i>=0?"+":"")+Qe(a,1,s);case 2:return"GMT"+(i>=0?"+":"")+Qe(a,2,s)+":"+Qe(Math.abs(i%60),2,s);case 3:return r===0?"Z":(i>=0?"+":"")+Qe(a,2,s)+":"+Qe(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}var yy=0,os=4;function Ey(n){let e=as(n,yy,1).getDay();return as(n,0,1+(e<=os?os:os+7)-e)}function tf(n){let e=n.getDay(),t=e===0?-3:os-e;return as(n.getFullYear(),n.getMonth(),n.getDate()+t)}function ba(n,e=!1){return function(t,r){let i;if(e){let s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,a=t.getDate();i=1+Math.floor((a+s)/7)}else{let s=tf(t),a=Ey(s.getFullYear()),c=s.getTime()-a.getTime();i=1+Math.round(c/6048e5)}return Qe(i,n,it(r,Fe.MinusSign))}}function ss(n,e=!1){return function(t,r){let s=tf(t).getFullYear();return Qe(s,n,it(r,Fe.MinusSign),e)}}var Sa={};function vy(n){if(Sa[n])return Sa[n];let e;switch(n){case"G":case"GG":case"GGG":e=ee(3,X.Abbreviated);break;case"GGGG":e=ee(3,X.Wide);break;case"GGGGG":e=ee(3,X.Narrow);break;case"y":e=le(0,1,0,!1,!0);break;case"yy":e=le(0,2,0,!0,!0);break;case"yyy":e=le(0,3,0,!1,!0);break;case"yyyy":e=le(0,4,0,!1,!0);break;case"Y":e=ss(1);break;case"YY":e=ss(2,!0);break;case"YYY":e=ss(3);break;case"YYYY":e=ss(4);break;case"M":case"L":e=le(1,1,1);break;case"MM":case"LL":e=le(1,2,1);break;case"MMM":e=ee(2,X.Abbreviated);break;case"MMMM":e=ee(2,X.Wide);break;case"MMMMM":e=ee(2,X.Narrow);break;case"LLL":e=ee(2,X.Abbreviated,De.Standalone);break;case"LLLL":e=ee(2,X.Wide,De.Standalone);break;case"LLLLL":e=ee(2,X.Narrow,De.Standalone);break;case"w":e=ba(1);break;case"ww":e=ba(2);break;case"W":e=ba(1,!0);break;case"d":e=le(2,1);break;case"dd":e=le(2,2);break;case"c":case"cc":e=le(7,1);break;case"ccc":e=ee(1,X.Abbreviated,De.Standalone);break;case"cccc":e=ee(1,X.Wide,De.Standalone);break;case"ccccc":e=ee(1,X.Narrow,De.Standalone);break;case"cccccc":e=ee(1,X.Short,De.Standalone);break;case"E":case"EE":case"EEE":e=ee(1,X.Abbreviated);break;case"EEEE":e=ee(1,X.Wide);break;case"EEEEE":e=ee(1,X.Narrow);break;case"EEEEEE":e=ee(1,X.Short);break;case"a":case"aa":case"aaa":e=ee(0,X.Abbreviated);break;case"aaaa":e=ee(0,X.Wide);break;case"aaaaa":e=ee(0,X.Narrow);break;case"b":case"bb":case"bbb":e=ee(0,X.Abbreviated,De.Standalone,!0);break;case"bbbb":e=ee(0,X.Wide,De.Standalone,!0);break;case"bbbbb":e=ee(0,X.Narrow,De.Standalone,!0);break;case"B":case"BB":case"BBB":e=ee(0,X.Abbreviated,De.Format,!0);break;case"BBBB":e=ee(0,X.Wide,De.Format,!0);break;case"BBBBB":e=ee(0,X.Narrow,De.Format,!0);break;case"h":e=le(3,1,-12);break;case"hh":e=le(3,2,-12);break;case"H":e=le(3,1);break;case"HH":e=le(3,2);break;case"m":e=le(4,1);break;case"mm":e=le(4,2);break;case"s":e=le(5,1);break;case"ss":e=le(5,2);break;case"S":e=le(6,1);break;case"SS":e=le(6,2);break;case"SSS":e=le(6,3);break;case"Z":case"ZZ":case"ZZZ":e=is(0);break;case"ZZZZZ":e=is(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=is(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=is(2);break;default:return null}return Sa[n]=e,e}function nf(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function Iy(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function wy(n,e,t){let i=n.getTimezoneOffset(),s=nf(e,i);return Iy(n,-1*(s-i))}function Ty(n){if(Bd(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,s=1,a=1]=n.split("-").map(c=>+c);return as(i,s-1,a)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(fy))return Ay(r)}let e=new Date(n);if(!Bd(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function Ay(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let a=Number(n[4]||0)-t,c=Number(n[5]||0)-r,l=Number(n[6]||0),d=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return s.call(e,a,c,l,d),e}function Bd(n){return n instanceof Date&&!isNaN(n.valueOf())}var Dy=/^(\d+)?\.((\d+)(-(\d+))?)?$/,$d=22,cs=".",zr="0",by=";",Sy=",",Ca="#";function Cy(n,e,t,r,i,s,a=!1){let c="",l=!1;if(!isFinite(n))c=it(t,Fe.Infinity);else{let d=ky(n);a&&(d=Py(d));let p=e.minInt,g=e.minFrac,y=e.maxFrac;if(s){let M=s.match(Dy);if(M===null)throw new Error(`${s} is not a valid digit info`);let $=M[1],Q=M[3],pe=M[5];$!=null&&(p=Ra($)),Q!=null&&(g=Ra(Q)),pe!=null?y=Ra(pe):Q!=null&&g>y&&(y=g)}Ny(d,g,y);let b=d.digits,R=d.integerLen,O=d.exponent,k=[];for(l=b.every(M=>!M);R<p;R++)b.unshift(0);for(;R<0;R++)b.unshift(0);R>0?k=b.splice(R,b.length):(k=b,b=[0]);let j=[];for(b.length>=e.lgSize&&j.unshift(b.splice(-e.lgSize,b.length).join(""));b.length>e.gSize;)j.unshift(b.splice(-e.gSize,b.length).join(""));b.length&&j.unshift(b.join("")),c=j.join(it(t,r)),k.length&&(c+=it(t,i)+k.join("")),O&&(c+=it(t,Fe.Exponential)+"+"+O)}return n<0&&!l?c=e.negPre+c+e.negSuf:c=e.posPre+c+e.posSuf,c}function rf(n,e,t){let r=Yd(e,ka.Decimal),i=Ry(r,it(e,Fe.MinusSign));return Cy(n,i,e,Fe.Group,Fe.Decimal,t)}function Ry(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(by),i=r[0],s=r[1],a=i.indexOf(cs)!==-1?i.split(cs):[i.substring(0,i.lastIndexOf(zr)+1),i.substring(i.lastIndexOf(zr)+1)],c=a[0],l=a[1]||"";t.posPre=c.substring(0,c.indexOf(Ca));for(let p=0;p<l.length;p++){let g=l.charAt(p);g===zr?t.minFrac=t.maxFrac=p+1:g===Ca?t.maxFrac=p+1:t.posSuf+=g}let d=c.split(Sy);if(t.gSize=d[1]?d[1].length:0,t.lgSize=d[2]||d[1]?(d[2]||d[1]).length:0,s){let p=i.length-t.posPre.length-t.posSuf.length,g=s.indexOf(Ca);t.negPre=s.substring(0,g).replace(/'/g,""),t.negSuf=s.slice(g+p).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function Py(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function ky(n){let e=Math.abs(n)+"",t=0,r,i,s,a,c;for((i=e.indexOf(cs))>-1&&(e=e.replace(cs,"")),(s=e.search(/e/i))>0?(i<0&&(i=s),i+=+e.slice(s+1),e=e.substring(0,s)):i<0&&(i=e.length),s=0;e.charAt(s)===zr;s++);if(s===(c=e.length))r=[0],i=1;else{for(c--;e.charAt(c)===zr;)c--;for(i-=s,r=[],a=0;s<=c;s++,a++)r[a]=Number(e.charAt(s))}return i>$d&&(r=r.splice(0,$d-1),t=i-1,i=1),{digits:r,exponent:t,integerLen:i}}function Ny(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let r=n.digits,i=r.length-n.integerLen,s=Math.min(Math.max(e,i),t),a=s+n.integerLen,c=r[a];if(a>0){r.splice(Math.max(n.integerLen,a));for(let g=a;g<r.length;g++)r[g]=0}else{i=Math.max(0,i),n.integerLen=1,r.length=Math.max(1,a=s+1),r[0]=0;for(let g=1;g<a;g++)r[g]=0}if(c>=5)if(a-1<0){for(let g=0;g>a;g--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[a-1]++;for(;i<Math.max(0,s);i++)r.push(0);let l=s!==0,d=e+n.integerLen,p=r.reduceRight(function(g,y,b,R){return y=y+g,R[b]=y<10?y:y-10,l&&(R[b]===0&&b>=d?R.pop():l=!1),y>=10?1:0},0);p&&(r.unshift(p),n.integerLen++)}function Ra(n){let e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}var Pa=/\s+/,zd=[],Oy=(()=>{class n{_ngEl;_renderer;initialClasses=zd;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(Pa):zd}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Pa):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(Pa).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(je(ga),je(ya))};static \u0275dir=Xi({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var us=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},sf=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,s,a)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new us(i.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)r.remove(s===null?void 0:s);else if(s!==null){let c=r.get(s);r.move(c,a),jd(c,i)}});for(let i=0,s=r.length;i<s;i++){let c=r.get(i).context;c.index=i,c.count=s,c.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);jd(s,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(je(Ea),je(_a),je(Nd))};static \u0275dir=Xi({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function jd(n,e){n.context.$implicit=e.item}var Fy=(()=>{class n{_viewContainer;_context=new ls;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){qd(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){qd(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(je(Ea),je(_a))};static \u0275dir=Xi({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),ls=class{$implicit=null;ngIf=null};function qd(n,e){if(n&&!n.createEmbeddedView)throw new xr(2020,!1)}function of(n,e){return new xr(2100,!1)}var Ly="mediumDate",af=new Pe(""),cf=new Pe(""),xy=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,s){if(t==null||t===""||t!==t)return null;try{let a=r??this.defaultOptions?.dateFormat??Ly,c=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return ef(t,a,s||this.locale,c)}catch(a){throw of(n,a.message)}}static \u0275fac=function(r){return new(r||n)(je(wa,16),je(af,24),je(cf,24))};static \u0275pipe=va({name:"date",type:n,pure:!0})}return n})();var My=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,r,i){if(!Vy(t))return null;i||=this._locale;try{let s=Uy(t);return rf(s,i,r)}catch(s){throw of(n,s.message)}}static \u0275fac=function(r){return new(r||n)(je(wa,16))};static \u0275pipe=va({name:"number",type:n,pure:!0})}return n})();function Vy(n){return!(n==null||n===""||n!==n)}function Uy(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new Error(`${n} is not a number`);return n}var By=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Pd({type:n});static \u0275inj=Sd({})}return n})();function $y(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var uf="browser",lf="server";function zy(n){return n===uf}function jy(n){return n===lf}var Na=class{};var nb=(()=>{class n{static \u0275prov=$e({token:n,providedIn:"root",factory:()=>new Oa(Ae(Mr),window)})}return n})(),Oa=class{document;window;offset=()=>[0,0];constructor(e,t){this.document=e,this.window=t}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=qy(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function qy(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let a=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(a)return a}i=r.nextNode()}}return null}var hf=()=>{};var pf=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Gy=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],c=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},hs={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,c=a?n[i+1]:0,l=i+2<n.length,d=l?n[i+2]:0,p=s>>2,g=(s&3)<<4|c>>4,y=(c&15)<<2|d>>6,b=d&63;l||(b=64,a||(y=64)),r.push(t[p],t[g],t[y],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(pf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Gy(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let g=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||d==null||g==null)throw new La;let y=s<<2|c>>4;if(r.push(y),d!==64){let b=c<<4&240|d>>2;if(r.push(b),g!==64){let R=d<<6&192|g;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},La=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Wy=function(n){let e=pf(n);return hs.encodeByteArray(e,!0)},qr=function(n){return Wy(n).replace(/\./g,"")},ds=function(n){try{return hs.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ma(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Hy=()=>Ma().__FIREBASE_DEFAULTS__,Ky=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Qy=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&ds(n[1]);return e&&JSON.parse(e)},fs=()=>{try{return hf()||Hy()||Ky()||Qy()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Va=n=>{var e,t;return(t=(e=fs())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},gf=n=>{let e=Va(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ua=()=>{var n;return(n=fs())===null||n===void 0?void 0:n.config},Ba=n=>{var e;return(e=fs())===null||e===void 0?void 0:e[`_${n}`]};var on=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function an(n){return n.endsWith(".cloudworkstations.dev")}function ps(n){return _(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function mf(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[qr(JSON.stringify(t)),qr(JSON.stringify(a)),""].join(".")}var jr={};function Yy(){let n={prod:[],emulator:[]};for(let e of Object.keys(jr))jr[e]?n.emulator.push(e):n.prod.push(e);return n}function Jy(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var df=!1;function Fn(n,e){if(typeof window>"u"||typeof document>"u"||!an(window.location.host)||jr[n]===e||jr[n]||df)return;jr[n]=e;function t(y){return`__firebase__banner__${y}`}let r="__firebase__banner",s=Yy().prod.length>0;function a(){let y=document.getElementById(r);y&&y.remove()}function c(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function l(y,b){y.setAttribute("width","24"),y.setAttribute("id",b),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){let y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{df=!0,a()},y}function p(y,b){y.setAttribute("id",b),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function g(){let y=Jy(r),b=t("text"),R=document.getElementById(b)||document.createElement("span"),O=t("learnmore"),k=document.getElementById(O)||document.createElement("a"),j=t("preprendIcon"),M=document.getElementById(j)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){let $=y.element;c($),p(k,O);let Q=d();l(M,j),$.append(M,R,k,Q),document.body.appendChild($)}s?(R.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function ge(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function _f(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ge())}function Xy(){var n;let e=(n=fs())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yf(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Ef(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function vf(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function If(){let n=ge();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function wf(){return!Xy()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Gr(){try{return typeof indexedDB=="object"}catch{return!1}}function Tf(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var Zy="FirebaseError",Ve=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Zy,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ye.prototype.create)}},Ye=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?eE(s,r):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new Ve(i,c,r)}};function eE(n,e){return n.replace(tE,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var tE=/\{\$([^}]+)}/g;function Af(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function st(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(ff(s)&&ff(a)){if(!st(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function ff(n){return n!==null&&typeof n=="object"}function Wr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ln(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function xn(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Df(n,e){let t=new xa(n,e);return t.subscribe.bind(t)}var xa=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");nE(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Fa),i.error===void 0&&(i.error=Fa),i.complete===void 0&&(i.complete=Fa);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function nE(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Fa(){}var lb=4*60*60*1e3;function se(n){return n&&n._delegate?n._delegate:n}var ke=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var cn="[DEFAULT]";var $a=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new on;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iE(e))try{this.getOrInitializeService({instanceIdentifier:cn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=cn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return _(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=cn){return this.instances.has(e)}getOptions(e=cn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:rE(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=cn){return this.component?this.component.multipleInstances?e:cn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function rE(n){return n===cn?void 0:n}function iE(n){return n.instantiationMode==="EAGER"}var gs=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new $a(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var sE=[],G=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(G||{}),oE={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},aE=G.INFO,cE={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},uE=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=cE[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ot=class{constructor(e){this.name=e,this._logLevel=aE,this._logHandler=uE,this._userLogHandler=null,sE.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...e),this._logHandler(this,G.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...e),this._logHandler(this,G.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,G.INFO,...e),this._logHandler(this,G.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,G.WARN,...e),this._logHandler(this,G.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...e),this._logHandler(this,G.ERROR,...e)}};var lE=(n,e)=>e.some(t=>n instanceof t),bf,Sf;function hE(){return bf||(bf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dE(){return Sf||(Sf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Cf=new WeakMap,ja=new WeakMap,Rf=new WeakMap,za=new WeakMap,Ga=new WeakMap;function fE(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(at(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Cf.set(t,n)}).catch(()=>{}),Ga.set(e,n),e}function pE(n){if(ja.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});ja.set(n,e)}var qa={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ja.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Rf.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return at(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Pf(n){qa=n(qa)}function gE(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ms(this),e,...t);return Rf.set(r,e.sort?e.sort():[e]),at(r)}:dE().includes(n)?function(...e){return n.apply(ms(this),e),at(Cf.get(this))}:function(...e){return at(n.apply(ms(this),e))}}function mE(n){return typeof n=="function"?gE(n):(n instanceof IDBTransaction&&pE(n),lE(n,hE())?new Proxy(n,qa):n)}function at(n){if(n instanceof IDBRequest)return fE(n);if(za.has(n))return za.get(n);let e=mE(n);return e!==n&&(za.set(n,e),Ga.set(e,n)),e}var ms=n=>Ga.get(n);function Nf(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),c=at(a);return r&&a.addEventListener("upgradeneeded",l=>{r(at(a.result),l.oldVersion,l.newVersion,at(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}var _E=["get","getKey","getAll","getAllKeys","count"],yE=["put","add","delete","clear"],Wa=new Map;function kf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Wa.get(e))return Wa.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=yE.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||_E.includes(t)))return;let s=function(a,...c){return _(this,null,function*(){let l=this.transaction(a,i?"readwrite":"readonly"),d=l.store;return r&&(d=d.index(c.shift())),(yield Promise.all([d[t](...c),i&&l.done]))[0]})};return Wa.set(e,s),s}Pf(n=>Qi(Ki({},n),{get:(e,t,r)=>kf(e,t)||n.get(e,t,r),has:(e,t)=>!!kf(e,t)||n.has(e,t)}));var Ka=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(EE(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function EE(n){let e=n.getComponent();return e?.type==="VERSION"}var Qa="@firebase/app",Of="0.12.3";var wt=new ot("@firebase/app"),vE="@firebase/app-compat",IE="@firebase/analytics-compat",wE="@firebase/analytics",TE="@firebase/app-check-compat",AE="@firebase/app-check",DE="@firebase/auth",bE="@firebase/auth-compat",SE="@firebase/database",CE="@firebase/data-connect",RE="@firebase/database-compat",PE="@firebase/functions",kE="@firebase/functions-compat",NE="@firebase/installations",OE="@firebase/installations-compat",FE="@firebase/messaging",LE="@firebase/messaging-compat",xE="@firebase/performance",ME="@firebase/performance-compat",VE="@firebase/remote-config",UE="@firebase/remote-config-compat",BE="@firebase/storage",$E="@firebase/storage-compat",zE="@firebase/firestore",jE="@firebase/vertexai",qE="@firebase/firestore-compat",GE="firebase",WE="11.7.3";var Ya="[DEFAULT]",HE={[Qa]:"fire-core",[vE]:"fire-core-compat",[wE]:"fire-analytics",[IE]:"fire-analytics-compat",[AE]:"fire-app-check",[TE]:"fire-app-check-compat",[DE]:"fire-auth",[bE]:"fire-auth-compat",[SE]:"fire-rtdb",[CE]:"fire-data-connect",[RE]:"fire-rtdb-compat",[PE]:"fire-fn",[kE]:"fire-fn-compat",[NE]:"fire-iid",[OE]:"fire-iid-compat",[FE]:"fire-fcm",[LE]:"fire-fcm-compat",[xE]:"fire-perf",[ME]:"fire-perf-compat",[VE]:"fire-rc",[UE]:"fire-rc-compat",[BE]:"fire-gcs",[$E]:"fire-gcs-compat",[zE]:"fire-fst",[qE]:"fire-fst-compat",[jE]:"fire-vertex","fire-js":"fire-js",[GE]:"fire-js-all"};var Hr=new Map,KE=new Map,Ja=new Map;function Ff(n,e){try{n.container.addComponent(e)}catch(t){wt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Je(n){let e=n.name;if(Ja.has(e))return wt.debug(`There were multiple attempts to register component ${e}.`),!1;Ja.set(e,n);for(let t of Hr.values())Ff(t,n);for(let t of KE.values())Ff(t,n);return!0}function Mn(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Le(n){return n==null?!1:n.settings!==void 0}var QE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},$t=new Ye("app","Firebase",QE);var Xa=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ke("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw $t.create("app-deleted",{appName:this._name})}};var zt=WE;function tc(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Ya,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw $t.create("bad-app-name",{appName:String(i)});if(t||(t=Ua()),!t)throw $t.create("no-options");let s=Hr.get(i);if(s){if(st(t,s.options)&&st(r,s.config))return s;throw $t.create("duplicate-app",{appName:i})}let a=new gs(i);for(let l of Ja.values())a.addComponent(l);let c=new Xa(t,r,a);return Hr.set(i,c),c}function un(n=Ya){let e=Hr.get(n);if(!e&&n===Ya&&Ua())return tc();if(!e)throw $t.create("no-app",{appName:n});return e}function _s(){return Array.from(Hr.values())}function oe(n,e,t){var r;let i=(r=HE[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wt.warn(c.join(" "));return}Je(new ke(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var YE="firebase-heartbeat-database",JE=1,Kr="firebase-heartbeat-store",Ha=null;function Vf(){return Ha||(Ha=Nf(YE,JE,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Kr)}catch(t){console.warn(t)}}}}).catch(n=>{throw $t.create("idb-open",{originalErrorMessage:n.message})})),Ha}function XE(n){return _(this,null,function*(){try{let t=(yield Vf()).transaction(Kr),r=yield t.objectStore(Kr).get(Uf(n));return yield t.done,r}catch(e){if(e instanceof Ve)wt.warn(e.message);else{let t=$t.create("idb-get",{originalErrorMessage:e?.message});wt.warn(t.message)}}})}function Lf(n,e){return _(this,null,function*(){try{let r=(yield Vf()).transaction(Kr,"readwrite");yield r.objectStore(Kr).put(e,Uf(n)),yield r.done}catch(t){if(t instanceof Ve)wt.warn(t.message);else{let r=$t.create("idb-set",{originalErrorMessage:t?.message});wt.warn(r.message)}}})}function Uf(n){return`${n.name}!${n.options.appId}`}var ZE=1024,ev=30,Za=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new ec(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return _(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=xf();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>ev){let a=nv(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){wt.warn(r)}})}getHeartbeatsHeader(){return _(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=xf(),{heartbeatsToSend:r,unsentEntries:i}=tv(this._heartbeatsCache.heartbeats),s=qr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return wt.warn(t),""}})}};function xf(){return new Date().toISOString().substring(0,10)}function tv(n,e=ZE){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Mf(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Mf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var ec=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return _(this,null,function*(){return Gr()?Tf().then(()=>!0).catch(()=>!1):!1})}read(){return _(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield XE(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return _(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Lf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return _(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Lf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Mf(n){return qr(JSON.stringify({version:2,heartbeats:n})).length}function nv(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function rv(n){Je(new ke("platform-logger",e=>new Ka(e),"PRIVATE")),Je(new ke("heartbeat",e=>new Za(e),"PRIVATE")),oe(Qa,Of,n),oe(Qa,Of,"esm2017"),oe("fire-js","")}rv("");var iv="firebase",sv="11.7.3";oe(iv,sv,"app");function nc(n){n===void 0&&(Rd(nc),n=Ae(vt));let e=n.get(Ji);return t=>new Lr(r=>{let i=e.add(),s=!1;function a(){s||(i(),s=!0)}let c=t.subscribe({next:l=>{r.next(l),a()},complete:()=>{r.complete(),a()},error:l=>{r.error(l),a()}});return c.add(()=>{r.unsubscribe(),a()}),c})}var jt=new Ia("ANGULARFIRE2_VERSION");function Qr(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Un=(n,e)=>{let t=e?[e]:_s(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Vn=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(Vn||{}),Bf=Ta()&&typeof Zone<"u"?Vn.WARN:Vn.SILENT;var ys=class{zone;delegate;constructor(e,t=bd){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i?i.runGuarded(()=>{e.apply(this,[a])}):e.apply(this,[a])};return this.delegate.schedule(s,t,r)}},qt=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=Ae(rt);this.outsideAngular=t.runOutsideAngular(()=>new ys(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new ys(typeof Zone>"u"?void 0:Zone.current,Dd))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$f=!1;function ov(n,e){!$f&&(Bf>Vn.SILENT||Ta())&&($f=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),Bf>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function av(n){let e=Ae(rt,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function ln(n){let e=Ae(rt,{optional:!0});return e?e.run(()=>n()):n()}var cv=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Yi(t,()=>ln(()=>n.apply(void 0,r)))),ae=(n,e,t)=>(t||=e?Vn.WARN:Vn.VERBOSE,function(){let r,i=arguments,s,a,c;try{s=Ae(qt),a=Ae(Ji),c=Ae(Cd)}catch{return ov(n,t),n.apply(this,i)}for(let d=0;d<arguments.length;d++)typeof i[d]=="function"&&(e&&(r||=ln(()=>a.add())),i[d]=cv(i[d],r,c));let l=av(()=>n.apply(this,i));return e?l instanceof Lr?l.pipe(pa(s.outsideAngular),fa(s.insideAngular),nc(c)):l instanceof Promise?ln(()=>new Promise((d,p)=>{a.run(()=>l).then(g=>Yi(c,()=>ln(()=>d(g))),g=>Yi(c,()=>ln(()=>p(g))))})):typeof l=="function"&&r?function(){return setTimeout(r,0),l.apply(this,arguments)}:ln(()=>l):l instanceof Lr?l.pipe(pa(s.outsideAngular),fa(s.insideAngular)):ln(()=>l)});var Tt=class{constructor(e){return e}},hn=class{constructor(){return _s()}};function uv(n){return n&&n.length===1?n[0]:new Tt(un())}var rc=new Pe("angularfire2._apps"),lv={provide:Tt,useFactory:uv,deps:[[new ze,rc]]},hv={provide:hn,deps:[[new ze,rc]]};function dv(n){return(e,t)=>{let r=t.get(ma);oe("angularfire",jt.full,"core"),oe("angularfire",jt.full,"app"),oe("angular",kd.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Tt(i)}}function hS(n,...e){return Nn([lv,hv,{provide:rc,useFactory:dv(n),multi:!0,deps:[rt,vt,qt,...e]}])}var dS=ae(tc,!0);var fv=new Map,pv={activated:!1,tokenObservers:[]},gv={initialized:!1,enabled:!1};function Xe(n){return fv.get(n)||Object.assign({},pv)}function Gf(){return gv}var mv="https://content-firebaseappcheck.googleapis.com/v1";var _v="exchangeDebugToken",zf={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},IS=24*60*60*1e3;var oc=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return _(this,null,function*(){this.stop();try{this.pending=new on,this.pending.promise.catch(t=>{}),yield yv(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new on,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function yv(n){return new Promise(e=>{setTimeout(e,n)})}var Ev={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},Gt=new Ye("appCheck","AppCheck",Ev);function Wf(n){if(!Xe(n).activated)throw Gt.create("use-before-activation",{appName:n.name})}function Hf(r,i){return _(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},a=t.getImmediate({optional:!0});if(a){let b=yield a.getHeartbeatsHeader();b&&(s["X-Firebase-Client"]=b)}let c={method:"POST",body:JSON.stringify(e),headers:s},l;try{l=yield fetch(n,c)}catch(b){throw Gt.create("fetch-network-error",{originalErrorMessage:b?.message})}if(l.status!==200)throw Gt.create("fetch-status-error",{httpStatus:l.status});let d;try{d=yield l.json()}catch(b){throw Gt.create("fetch-parse-error",{originalErrorMessage:b?.message})}let p=d.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw Gt.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let g=Number(p[1])*1e3,y=Date.now();return{token:d.token,expireTimeMillis:y+g,issuedAtTimeMillis:y}})}function Kf(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${mv}/projects/${t}/apps/${r}:${_v}?key=${i}`,body:{debug_token:e}}}var vv="firebase-app-check-database",Iv=1,ac="firebase-app-check-store";var Es=null;function wv(){return Es||(Es=new Promise((n,e)=>{try{let t=indexedDB.open(vv,Iv);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Gt.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(ac,{keyPath:"compositeKey"})}}}catch(t){e(Gt.create("storage-open",{originalErrorMessage:t?.message}))}}),Es)}function Tv(n,e){return Av(Dv(n),e)}function Av(n,e){return _(this,null,function*(){let r=(yield wv()).transaction(ac,"readwrite"),s=r.objectStore(ac).put({compositeKey:n,value:e});return new Promise((a,c)=>{s.onsuccess=l=>{a()},r.onerror=l=>{var d;c(Gt.create("storage-set",{originalErrorMessage:(d=l.target.error)===null||d===void 0?void 0:d.message}))}})})}function Dv(n){return`${n.options.appId}-${n.name}`}var Yr=new ot("@firebase/app-check");function ic(n,e){return Gr()?Tv(n,e).catch(t=>{Yr.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Qf(){return Gf().enabled}function Yf(){return _(this,null,function*(){let n=Gf();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var bv={error:"UNKNOWN_ERROR"};function Sv(n){return hs.encodeString(JSON.stringify(n),!1)}function cc(n,e=!1,t=!1){return _(this,null,function*(){let r=n.app;Wf(r);let i=Xe(r),s=i.token,a;if(s&&!Jr(s)&&(i.token=void 0,s=void 0),!s){let d=yield i.cachedTokenPromise;d&&(Jr(d)?s=d:yield ic(r,void 0))}if(!e&&s&&Jr(s))return{token:s.token};let c=!1;if(Qf())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=Hf(Kf(r,yield Yf()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),c=!0);let d=yield i.exchangeTokenPromise;return yield ic(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Yr.warn(d.message):t&&Yr.error(d),sc(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),c=!0),s=yield Xe(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Yr.warn(d.message):t&&Yr.error(d),a=d}let l;return s?a?Jr(s)?l={token:s.token,internalError:a}:l=sc(a):(l={token:s.token},i.token=s,yield ic(r,s)):l=sc(a),c&&kv(r,l),l})}function Cv(n){return _(this,null,function*(){let e=n.app;Wf(e);let{provider:t}=Xe(e);if(Qf()){let r=yield Yf(),{token:i}=yield Hf(Kf(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function Rv(n,e,t,r){let{app:i}=n,s=Xe(i),a={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,a],s.token&&Jr(s.token)){let c=s.token;Promise.resolve().then(()=>{t({token:c.token}),jf(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>jf(n))}function Jf(n,e){let t=Xe(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function jf(n){let{app:e}=n,t=Xe(e),r=t.tokenRefresher;r||(r=Pv(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Pv(n){let{app:e}=n;return new oc(()=>_(null,null,function*(){let t=Xe(e),r;if(t.token?r=yield cc(n,!0):r=yield cc(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Xe(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},zf.RETRIAL_MIN_WAIT,zf.RETRIAL_MAX_WAIT)}function kv(n,e){let t=Xe(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Jr(n){return n.expireTimeMillis-Date.now()>0}function sc(n){return{token:Sv(bv),error:n}}var uc=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Xe(this.app);for(let t of e)Jf(this.app,t.next);return Promise.resolve()}};function Nv(n,e){return new uc(n,e)}function Ov(n){return{getToken:e=>cc(n,e),getLimitedUseToken:()=>Cv(n),addTokenListener:e=>Rv(n,"INTERNAL",e),removeTokenListener:e=>Jf(n.app,e)}}var Fv="@firebase/app-check",Lv="0.9.3";var xv="app-check",qf="app-check-internal";function Mv(){Je(new ke(xv,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return Nv(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(qf).initialize()})),Je(new ke(qf,n=>{let e=n.getProvider("app-check").getImmediate();return Ov(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),oe(Fv,Lv)}Mv();var Vv="app-check";var Bn=class{constructor(){return Un(Vv)}};var Uv=["localhost","0.0.0.0","127.0.0.1"],FS=typeof window<"u"&&Uv.includes(window.location.hostname);function fp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var pp=fp,gp=new Ye("auth","Firebase",fp());var Ds=new ot("@firebase/auth");function Bv(n,...e){Ds.logLevel<=G.WARN&&Ds.warn(`Auth (${zt}): ${n}`,...e)}function Is(n,...e){Ds.logLevel<=G.ERROR&&Ds.error(`Auth (${zt}): ${n}`,...e)}function ut(n,...e){throw Fc(n,...e)}function dn(n,...e){return Fc(n,...e)}function mp(n,e,t){let r=Object.assign(Object.assign({},pp()),{[e]:t});return new Ye("auth","Firebase",r).create(e,{appName:n.name})}function bt(n){return mp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Fc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return gp.create(n,...e)}function U(n,e,...t){if(!n)throw Fc(e,...t)}function At(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Is(e),new Error(e)}function Kt(n,e){n||At(e)}function fc(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function $v(){return Xf()==="http:"||Xf()==="https:"}function Xf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function zv(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&($v()||Ef()||"connection"in navigator)?navigator.onLine:!0}function jv(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var fn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Kt(t>e,"Short delay should be less than long delay!"),this.isMobile=_f()||vf()}get(){return zv()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Lc(n,e){Kt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var bs=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;At("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;At("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;At("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var qv={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Gv=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Wv=new fn(3e4,6e4);function Qt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function St(s,a,c,l){return _(this,arguments,function*(n,e,t,r,i={}){return _p(n,i,()=>_(null,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let g=Wr(Object.assign({key:n.config.apiKey},p)).slice(1),y=yield n._getAdditionalHeaders();y["Content-Type"]="application/json",n.languageCode&&(y["X-Firebase-Locale"]=n.languageCode);let b=Object.assign({method:e,headers:y},d);return yf()||(b.referrerPolicy="no-referrer"),n.emulatorConfig&&an(n.emulatorConfig.host)&&(b.credentials="include"),bs.fetch()(yield yp(n,n.config.apiHost,t,g),b)}))})}function _p(n,e,t){return _(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},qv),e);try{let i=new pc(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw vs(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let c=s.ok?a.errorMessage:a.error.message,[l,d]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw vs(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw vs(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw vs(n,"user-disabled",a);let p=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw mp(n,p,d);ut(n,p)}}catch(i){if(i instanceof Ve)throw i;ut(n,"network-request-failed",{message:String(i)})}})}function si(s,a,c,l){return _(this,arguments,function*(n,e,t,r,i={}){let d=yield St(n,e,t,r,i);return"mfaPendingCredential"in d&&ut(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function yp(n,e,t,r){return _(this,null,function*(){let i=`${e}${t}?${r}`,s=n,a=s.config.emulator?Lc(n.config,i):`${n.config.apiScheme}://${i}`;return Gv.includes(t)&&(yield s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a})}function Hv(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var pc=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(dn(this.auth,"network-request-failed")),Wv.get())})}};function vs(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=dn(n,e,r);return i.customData._tokenResponse=t,i}function Zf(n){return n!==void 0&&n.enterprise!==void 0}var gc=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Hv(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};function Kv(n,e){return _(this,null,function*(){return St(n,"GET","/v2/recaptchaConfig",Qt(n,e))})}function Qv(n,e){return _(this,null,function*(){return St(n,"POST","/v1/accounts:delete",e)})}function Ss(n,e){return _(this,null,function*(){return St(n,"POST","/v1/accounts:lookup",e)})}function Zr(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function xc(n,e=!1){return _(this,null,function*(){let t=se(n),r=yield t.getIdToken(e),i=Mc(r);U(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Zr(lc(i.auth_time)),issuedAtTime:Zr(lc(i.iat)),expirationTime:Zr(lc(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function lc(n){return Number(n)*1e3}function Mc(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Is("JWT malformed, contained fewer than 3 sections"),null;try{let i=ds(t);return i?JSON.parse(i):(Is("Failed to decode base64 JWT payload"),null)}catch(i){return Is("Caught error parsing JWT payload as JSON",i?.toString()),null}}function ep(n){let e=Mc(n);return U(e,"internal-error"),U(typeof e.exp<"u","internal-error"),U(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function $n(n,e,t=!1){return _(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Ve&&Yv(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function Yv({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var mc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>_(this,null,function*(){yield this.iteration()}),t)}iteration(){return _(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var ti=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zr(this.lastLoginAt),this.creationTime=Zr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Cs(n){return _(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield $n(n,Ss(t,{idToken:r}));U(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Ep(s.providerUserInfo):[],c=Jv(n.providerData,a),l=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!c?.length,p=l?d:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new ti(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,g)})}function Vc(n){return _(this,null,function*(){let e=se(n);yield Cs(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Jv(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Ep(n){return n.map(e=>{var{providerId:t}=e,r=da(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Xv(n,e){return _(this,null,function*(){let t=yield _p(n,{},()=>_(null,null,function*(){let r=Wr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=yield yp(n,i,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",bs.fetch()(a,{method:"POST",headers:c,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function Zv(n,e){return _(this,null,function*(){return St(n,"POST","/v2/accounts:revokeToken",Qt(n,e))})}var ei=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){U(e.idToken,"internal-error"),U(typeof e.idToken<"u","internal-error"),U(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ep(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){U(e.length!==0,"internal-error");let t=ep(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return _(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(U(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return _(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield Xv(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(U(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(U(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(U(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return At("not implemented")}};function Wt(n,e){U(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Ht=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=da(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new mc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ti(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return _(this,null,function*(){let t=yield $n(this,this.stsTokenManager.getToken(this.auth,e));return U(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return xc(this,e)}reload(){return Vc(this)}_assign(e){this!==e&&(U(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return _(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Cs(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return _(this,null,function*(){if(Le(this.auth.app))return Promise.reject(bt(this.auth));let e=yield this.getIdToken();return yield $n(this,Qv(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,c,l,d,p;let g=(r=t.displayName)!==null&&r!==void 0?r:void 0,y=(i=t.email)!==null&&i!==void 0?i:void 0,b=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,R=(a=t.photoURL)!==null&&a!==void 0?a:void 0,O=(c=t.tenantId)!==null&&c!==void 0?c:void 0,k=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,j=(d=t.createdAt)!==null&&d!==void 0?d:void 0,M=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:$,emailVerified:Q,isAnonymous:pe,providerData:J,stsTokenManager:w}=t;U($&&w,e,"internal-error");let m=ei.fromJSON(this.name,w);U(typeof $=="string",e,"internal-error"),Wt(g,e.name),Wt(y,e.name),U(typeof Q=="boolean",e,"internal-error"),U(typeof pe=="boolean",e,"internal-error"),Wt(b,e.name),Wt(R,e.name),Wt(O,e.name),Wt(k,e.name),Wt(j,e.name),Wt(M,e.name);let v=new n({uid:$,auth:e,email:y,emailVerified:Q,displayName:g,isAnonymous:pe,photoURL:R,phoneNumber:b,tenantId:O,stsTokenManager:m,createdAt:j,lastLoginAt:M});return J&&Array.isArray(J)&&(v.providerData=J.map(I=>Object.assign({},I))),k&&(v._redirectEventId=k),v}static _fromIdTokenResponse(e,t,r=!1){return _(this,null,function*(){let i=new ei;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Cs(s),s})}static _fromGetAccountInfoResponse(e,t,r){return _(this,null,function*(){let i=t.users[0];U(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Ep(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,c=new ei;c.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ti(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,d),l})}};var tp=new Map;function Dt(n){Kt(n instanceof Function,"Expected a class definition");let e=tp.get(n);return e?(Kt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,tp.set(n,e),e)}var eI=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return _(this,null,function*(){return!0})}_set(t,r){return _(this,null,function*(){this.storage[t]=r})}_get(t){return _(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return _(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),_c=eI;function ws(n,e,t){return`firebase:${n}:${e}:${t}`}var Rs=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=ws(this.userKey,i.apiKey,s),this.fullPersistenceKey=ws("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return _(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield Ss(this.auth,{idToken:e}).catch(()=>{});return t?Ht._fromGetAccountInfoResponse(this.auth,t,e):null}return Ht._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return _(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return _(this,null,function*(){if(!t.length)return new n(Dt(_c),e,r);let i=(yield Promise.all(t.map(d=>_(null,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=i[0]||Dt(_c),a=ws(r,e.config.apiKey,e.name),c=null;for(let d of t)try{let p=yield d._get(a);if(p){let g;if(typeof p=="string"){let y=yield Ss(e,{idToken:p}).catch(()=>{});if(!y)break;g=yield Ht._fromGetAccountInfoResponse(e,y,p)}else g=Ht._fromJSON(e,p);d!==s&&(c=g),s=d;break}}catch{}let l=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],c&&(yield s._set(a,c.toJSON())),yield Promise.all(t.map(d=>_(null,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,r))})}};function np(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Tp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Dp(e))return"Blackberry";if(bp(e))return"Webos";if(Ip(e))return"Safari";if((e.includes("chrome/")||wp(e))&&!e.includes("edge/"))return"Chrome";if(Ap(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function vp(n=ge()){return/firefox\//i.test(n)}function Ip(n=ge()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wp(n=ge()){return/crios\//i.test(n)}function Tp(n=ge()){return/iemobile/i.test(n)}function Ap(n=ge()){return/android/i.test(n)}function Dp(n=ge()){return/blackberry/i.test(n)}function bp(n=ge()){return/webos/i.test(n)}function Uc(n=ge()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function tI(n=ge()){var e;return Uc(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function nI(){return If()&&document.documentMode===10}function Sp(n=ge()){return Uc(n)||Ap(n)||bp(n)||Dp(n)||/windows phone/i.test(n)||Tp(n)}function Cp(n,e=[]){let t;switch(n){case"Browser":t=np(ge());break;case"Worker":t=`${np(ge())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${zt}/${r}`}var yc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,c)=>{try{let l=e(s);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return _(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function rI(t){return _(this,arguments,function*(n,e={}){return St(n,"GET","/v2/passwordPolicy",Qt(n,e))})}var iI=6,Ec=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:iI,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,c;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(c=l.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var vc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ps(this),this.idTokenSubscription=new Ps(this),this.beforeStateQueue=new yc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Dt(t)),this._initializationPromise=this.queue(()=>_(this,null,function*(){var r,i,s;if(!this._deleted&&(this.persistenceManager=yield Rs.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return _(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return _(this,null,function*(){try{let t=yield Ss(this,{idToken:e}),r=yield Ht._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return _(this,null,function*(){var t;if(Le(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return U(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return _(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return _(this,null,function*(){try{yield Cs(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=jv()}_delete(){return _(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return _(this,null,function*(){if(Le(this.app))return Promise.reject(bt(this));let t=e?se(e):null;return t&&U(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return _(this,null,function*(){if(!this._deleted)return e&&U(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>_(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return _(this,null,function*(){return Le(this.app)?Promise.reject(bt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Le(this.app)?Promise.reject(bt(this)):this.queue(()=>_(this,null,function*(){yield this.assertedPersistence.setPersistence(Dt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return _(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return _(this,null,function*(){let e=yield rI(this),t=new Ec(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ye("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return _(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield Zv(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return _(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return _(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Dt(e)||this._popupRedirectResolver;U(t,this,"argument-error"),this.redirectPersistenceManager=yield Rs.create(this,[Dt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return _(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>_(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return _(this,null,function*(){if(e===this.currentUser)return this.queue(()=>_(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(U(c,this,"internal-error"),c.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}directlySetCurrentUser(e){return _(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Cp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return _(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return _(this,null,function*(){var e;if(Le(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Bv(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function gn(n){return se(n)}var Ps=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Df(t=>this.observer=t)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Ms={loadJS(){return _(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sI(n){Ms=n}function Rp(n){return Ms.loadJS(n)}function oI(){return Ms.recaptchaEnterpriseScript}function aI(){return Ms.gapiScript}function Pp(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var Ic=class{constructor(){this.enterprise=new wc}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},wc=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var cI="recaptcha-enterprise",kp="NO_RECAPTCHA",Tc=class{constructor(e){this.type=cI,this.auth=gn(e)}verify(e="verify",t=!1){return _(this,null,function*(){function r(s){return _(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((a,c)=>_(null,null,function*(){Kv(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let d=new gc(l);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,a(d.siteKey)}}).catch(l=>{c(l)})}))})}function i(s,a,c){let l=window.grecaptcha;Zf(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(d=>{a(d)}).catch(()=>{a(kp)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Ic().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{r(this.auth).then(c=>{if(!t&&Zf(window.grecaptcha))i(c,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=oI();l.length!==0&&(l+=c),Rp(l).then(()=>{i(c,s,a)}).catch(d=>{a(d)})}}).catch(c=>{a(c)})})})}};function Xr(n,e,t,r=!1,i=!1){return _(this,null,function*(){let s=new Tc(n),a;if(i)a=kp;else try{a=yield s.verify(t)}catch{a=yield s.verify(t,!0)}let c=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){let l=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){let l=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:a}):Object.assign(c,{captchaResponse:a}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c})}function Ac(n,e,t,r,i){return _(this,null,function*(){var s,a;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let c=yield Xr(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(c=>_(null,null,function*(){if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let l=yield Xr(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(c)}));else if(i==="PHONE_PROVIDER")if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("PHONE_PROVIDER")){let c=yield Xr(n,e,t);return r(n,c).catch(l=>_(null,null,function*(){var d;if(((d=n._getRecaptchaConfig())===null||d===void 0?void 0:d.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let p=yield Xr(n,e,t,!1,!0);return r(n,p)}return Promise.reject(l)}))}else{let c=yield Xr(n,e,t,!1,!0);return r(n,c)}else return Promise.reject(i+" provider is not supported.")})}function Bc(n,e){let t=Mn(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(st(s,e??{}))return i;ut(i,"already-initialized")}return t.initialize({options:e})}function uI(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Dt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function $c(n,e,t){let r=gn(n);U(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Np(e),{host:a,port:c}=lI(e),l=c===null?"":`:${c}`,d={url:`${s}//${a}${l}/`},p=Object.freeze({host:a,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){U(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),U(st(d,r.config.emulator)&&st(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,an(a)?(Fn("Auth",!0),ps(`${s}//${a}${l}`)):i||hI()}function Np(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function lI(n){let e=Np(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:rp(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:rp(a)}}}function rp(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function hI(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var ni=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return At("not implemented")}_getIdTokenResponse(e){return At("not implemented")}_linkToIdToken(e,t){return At("not implemented")}_getReauthenticationResolver(e){return At("not implemented")}};function dI(n,e){return _(this,null,function*(){return St(n,"POST","/v1/accounts:signUp",e)})}function fI(n,e){return _(this,null,function*(){return si(n,"POST","/v1/accounts:signInWithPassword",Qt(n,e))})}function pI(n,e){return _(this,null,function*(){return si(n,"POST","/v1/accounts:signInWithEmailLink",Qt(n,e))})}function gI(n,e){return _(this,null,function*(){return si(n,"POST","/v1/accounts:signInWithEmailLink",Qt(n,e))})}var ri=class n extends ni{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return _(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ac(e,t,"signInWithPassword",fI,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return pI(e,{email:this._email,oobCode:this._password});default:ut(e,"internal-error")}})}_linkToIdToken(e,t){return _(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ac(e,r,"signUpPassword",dI,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return gI(e,{idToken:t,email:this._email,oobCode:this._password});default:ut(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function hc(n,e){return _(this,null,function*(){return si(n,"POST","/v1/accounts:signInWithIdp",Qt(n,e))})}function mI(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _I(n){let e=Ln(xn(n)).link,t=e?Ln(xn(e)).deep_link_id:null,r=Ln(xn(n)).deep_link_id;return(r?Ln(xn(r)).link:null)||r||t||e||n}var ks=class n{constructor(e){var t,r,i,s,a,c;let l=Ln(xn(e)),d=(t=l.apiKey)!==null&&t!==void 0?t:null,p=(r=l.oobCode)!==null&&r!==void 0?r:null,g=mI((i=l.mode)!==null&&i!==void 0?i:null);U(d&&p&&g,"argument-error"),this.apiKey=d,this.operation=g,this.code=p,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.lang)!==null&&a!==void 0?a:null,this.tenantId=(c=l.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){let t=_I(e);try{return new n(t)}catch{return null}}};var Op=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return ri._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=ks.parseLink(r);return U(i,"argument-error"),ri._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Ns=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Dc=class extends Ns{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function yI(n,e){return _(this,null,function*(){return si(n,"POST","/v1/accounts:signUp",Qt(n,e))})}var zn=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return _(this,null,function*(){let s=yield Ht._fromIdTokenResponse(e,r,i),a=ip(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return _(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=ip(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function ip(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var bc=class n extends Ve{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Fp(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?bc._fromErrorAndOperation(n,s,e,r):s})}function EI(n,e,t=!1){return _(this,null,function*(){let r=yield $n(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return zn._forOperation(n,"link",r)})}function vI(n,e,t=!1){return _(this,null,function*(){let{auth:r}=n;if(Le(r.app))return Promise.reject(bt(r));let i="reauthenticate";try{let s=yield $n(n,Fp(r,i,e,n),t);U(s.idToken,r,"internal-error");let a=Mc(s.idToken);U(a,r,"internal-error");let{sub:c}=a;return U(n.uid===c,r,"user-mismatch"),zn._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&ut(r,"user-mismatch"),s}})}function Lp(n,e,t=!1){return _(this,null,function*(){if(Le(n.app))return Promise.reject(bt(n));let r="signIn",i=yield Fp(n,r,e),s=yield zn._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function zc(n,e){return _(this,null,function*(){return Lp(gn(n),e)})}function xp(n){return _(this,null,function*(){let e=gn(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function jc(n,e,t){return _(this,null,function*(){if(Le(n.app))return Promise.reject(bt(n));let r=gn(n),a=yield Ac(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",yI,"EMAIL_PASSWORD_PROVIDER").catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&xp(n),l}),c=yield zn._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(c.user),c})}function qc(n,e,t){return Le(n.app)?Promise.reject(bt(n)):zc(se(n),Op.credential(e,t)).catch(r=>_(null,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&xp(n),r}))}function II(n,e){return _(this,null,function*(){return St(n,"POST","/v1/accounts:update",e)})}function Gc(r,i){return _(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=se(n),c={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=yield $n(s,II(s.auth,c));s.displayName=l.displayName||null,s.photoURL=l.photoUrl||null;let d=s.providerData.find(({providerId:p})=>p==="password");d&&(d.displayName=s.displayName,d.photoURL=s.photoURL),yield s._updateTokensIfNecessary(l)})}function Wc(n,e,t,r){return se(n).onIdTokenChanged(e,t,r)}function Hc(n,e,t){return se(n).beforeAuthStateChanged(e,t)}function Kc(n,e,t,r){return se(n).onAuthStateChanged(e,t,r)}function Qc(n){return se(n).signOut()}var Os="__sak";var Fs=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Os,"1"),this.storage.removeItem(Os),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var wI=1e3,TI=10,AI=(()=>{class n extends Fs{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Sp(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,l,d)=>{this.notifyListeners(c,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},a=this.storage.getItem(i);nI()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,TI):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},wI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return _(this,null,function*(){yield Bt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return _(this,null,function*(){let r=yield Bt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return _(this,null,function*(){yield Bt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Mp=AI;var DI=(()=>{class n extends Fs{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Yc=DI;function bI(n){return Promise.all(n.map(e=>_(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var SI=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return _(this,null,function*(){let r=t,{eventId:i,eventType:s,data:a}=r.data,c=this.handlersMap[s];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let l=Array.from(c).map(p=>_(this,null,function*(){return p(r.origin,a)})),d=yield bI(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Vp(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Sc=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return _(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((c,l)=>{let d=Vp("",20);i.port1.start();let p=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(g){let y=g;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(y.data.response);break;default:clearTimeout(p),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function ct(){return window}function CI(n){ct().location.href=n}function Up(){return typeof ct().WorkerGlobalScope<"u"&&typeof ct().importScripts=="function"}function RI(){return _(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function PI(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function kI(){return Up()?self:null}var Bp="firebaseLocalStorageDb",NI=1,Ls="firebaseLocalStorage",$p="fbase_key",pn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Vs(n,e){return n.transaction([Ls],e?"readwrite":"readonly").objectStore(Ls)}function OI(){let n=indexedDB.deleteDatabase(Bp);return new pn(n).toPromise()}function Cc(){let n=indexedDB.open(Bp,NI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Ls,{keyPath:$p})}catch(i){t(i)}}),n.addEventListener("success",()=>_(null,null,function*(){let r=n.result;r.objectStoreNames.contains(Ls)?e(r):(r.close(),yield OI(),e(yield Cc()))}))})}function sp(n,e,t){return _(this,null,function*(){let r=Vs(n,!0).put({[$p]:e,value:t});return new pn(r).toPromise()})}function FI(n,e){return _(this,null,function*(){let t=Vs(n,!1).get(e),r=yield new pn(t).toPromise();return r===void 0?null:r.value})}function op(n,e){let t=Vs(n,!0).delete(e);return new pn(t).toPromise()}var LI=800,xI=3,MI=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return _(this,null,function*(){return this.db?this.db:(this.db=yield Cc(),this.db)})}_withRetries(t){return _(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>xI)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return _(this,null,function*(){return Up()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return _(this,null,function*(){this.receiver=SI._getInstance(kI()),this.receiver._subscribe("keyChanged",(t,r)=>_(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>_(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return _(this,null,function*(){var t,r;if(this.activeServiceWorker=yield RI(),!this.activeServiceWorker)return;this.sender=new Sc(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return _(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||PI()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return _(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Cc();return yield sp(t,Os,"1"),yield op(t,Os),!0}catch{}return!1})}_withPendingWrite(t){return _(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return _(this,null,function*(){return this._withPendingWrite(()=>_(this,null,function*(){return yield this._withRetries(i=>sp(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return _(this,null,function*(){let r=yield this._withRetries(i=>FI(i,t));return this.localCache[t]=r,r})}_remove(t){return _(this,null,function*(){return this._withPendingWrite(()=>_(this,null,function*(){return yield this._withRetries(r=>op(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return _(this,null,function*(){let t=yield this._withRetries(s=>{let a=Vs(s,!1).getAll();return new pn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>_(this,null,function*(){return this._poll()}),LI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),zp=MI;var zS=Pp("rcb"),jS=new fn(3e4,6e4);function VI(n,e){return e?Dt(e):(U(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var ii=class extends ni{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return hc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return hc(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function UI(n){return Lp(n.auth,new ii(n),n.bypassAuthState)}function BI(n){let{auth:e,user:t}=n;return U(t,e,"internal-error"),vI(t,new ii(n),n.bypassAuthState)}function $I(n){return _(this,null,function*(){let{auth:e,user:t}=n;return U(t,e,"internal-error"),EI(t,new ii(n),n.bypassAuthState)})}var Rc=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>_(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return _(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:c}=e;if(a){this.reject(a);return}let l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(c)(l))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return UI;case"linkViaPopup":case"linkViaRedirect":return $I;case"reauthViaPopup":case"reauthViaRedirect":return BI;default:ut(this.auth,"internal-error")}}resolve(e){Kt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Kt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var qS=new fn(2e3,1e4);var zI="pendingRedirect",Ts=new Map,Pc=class n extends Rc{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return _(this,null,function*(){let e=Ts.get(this.auth._key());if(!e){try{let r=(yield jI(this.resolver,this.auth))?yield Bt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ts.set(this.auth._key(),e)}return this.bypassAuthState||Ts.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return _(this,null,function*(){if(e.type==="signInViaRedirect")return Bt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Bt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return _(this,null,function*(){})}cleanUp(){}};function jI(n,e){return _(this,null,function*(){let t=WI(e),r=GI(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function qI(n,e){Ts.set(n._key(),e)}function GI(n){return Dt(n._redirectPersistence)}function WI(n){return ws(zI,n.config.apiKey,n.name)}function HI(n,e,t=!1){return _(this,null,function*(){if(Le(n.app))return Promise.reject(bt(n));let r=gn(n),i=VI(r,e),a=yield new Pc(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var KI=10*60*1e3,kc=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!QI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!jp(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(dn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=KI&&this.cachedEventUids.clear(),this.cachedEventUids.has(ap(e))}saveEventToCache(e){this.cachedEventUids.add(ap(e)),this.lastProcessedEventTime=Date.now()}};function ap(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function jp({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function QI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return jp(n);default:return!1}}function YI(t){return _(this,arguments,function*(n,e={}){return St(n,"GET","/v1/projects",e)})}var JI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,XI=/^https?/;function ZI(n){return _(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield YI(n);for(let t of e)try{if(ew(t))return}catch{}ut(n,"unauthorized-domain")})}function ew(n){let e=fc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!XI.test(t))return!1;if(JI.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var tw=new fn(3e4,6e4);function cp(){let n=ct().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function nw(n){return new Promise((e,t)=>{var r,i,s;function a(){cp(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cp(),t(dn(n,"network-request-failed"))},timeout:tw.get()})}if(!((i=(r=ct().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ct().gapi)===null||s===void 0)&&s.load)a();else{let c=Pp("iframefcb");return ct()[c]=()=>{gapi.load?a():t(dn(n,"network-request-failed"))},Rp(`${aI()}?onload=${c}`).catch(l=>t(l))}}).catch(e=>{throw As=null,e})}var As=null;function rw(n){return As=As||nw(n),As}var iw=new fn(5e3,15e3),sw="__/auth/iframe",ow="emulator/auth/iframe",aw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uw(n){let e=n.config;U(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Lc(e,ow):`https://${n.config.authDomain}/${sw}`,r={apiKey:e.apiKey,appName:n.name,v:zt},i=cw.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Wr(r).slice(1)}`}function lw(n){return _(this,null,function*(){let e=yield rw(n),t=ct().gapi;return U(t,n,"internal-error"),e.open({where:document.body,url:uw(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:aw,dontclear:!0},r=>new Promise((i,s)=>_(null,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=dn(n,"network-request-failed"),c=ct().setTimeout(()=>{s(a)},iw.get());function l(){ct().clearTimeout(c),i(r)}r.ping(l).then(l,()=>{s(a)})})))})}var hw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dw=500,fw=600,pw="_blank",gw="http://localhost",xs=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function mw(n,e,t,r=dw,i=fw){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",l=Object.assign(Object.assign({},hw),{width:r.toString(),height:i.toString(),top:s,left:a}),d=ge().toLowerCase();t&&(c=wp(d)?pw:t),vp(d)&&(e=e||gw,l.scrollbars="yes");let p=Object.entries(l).reduce((y,[b,R])=>`${y}${b}=${R},`,"");if(tI(d)&&c!=="_self")return _w(e||"",c),new xs(null);let g=window.open(e||"",c,p);U(g,n,"popup-blocked");try{g.focus()}catch{}return new xs(g)}function _w(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var yw="__/auth/handler",Ew="emulator/auth/handler",vw=encodeURIComponent("fac");function up(n,e,t,r,i,s){return _(this,null,function*(){U(n.config.authDomain,n,"auth-domain-config-required"),U(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:zt,eventId:i};if(e instanceof Ns){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Af(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,g]of Object.entries(s||{}))a[p]=g}if(e instanceof Dc){let p=e.getScopes().filter(g=>g!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let c=a;for(let p of Object.keys(c))c[p]===void 0&&delete c[p];let l=yield n._getAppCheckToken(),d=l?`#${vw}=${encodeURIComponent(l)}`:"";return`${Iw(n)}?${Wr(c).slice(1)}${d}`})}function Iw({config:n}){return n.emulator?Lc(n,Ew):`https://${n.authDomain}/${yw}`}var dc="webStorageSupport",Nc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Yc,this._completeRedirectFn=HI,this._overrideRedirectResult=qI}_openPopup(e,t,r,i){return _(this,null,function*(){var s;Kt((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield up(e,t,r,fc(),i);return mw(e,a,Vp())})}_openRedirect(e,t,r,i){return _(this,null,function*(){yield this._originValidation(e);let s=yield up(e,t,r,fc(),i);return CI(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Kt(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return _(this,null,function*(){let t=yield lw(e),r=new kc(e);return t.register("authEvent",i=>(U(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(dc,{type:dc},i=>{var s;let a=(s=i?.[0])===null||s===void 0?void 0:s[dc];a!==void 0&&t(!!a),ut(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ZI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Sp()||Ip()||Uc()}},qp=Nc;var lp="@firebase/auth",hp="1.10.4";var Oc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return _(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function ww(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Tw(n){Je(new ke("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;U(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Cp(n)},d=new vc(r,i,s,l);return uI(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Je(new ke("auth-internal",e=>{let t=gn(e.getProvider("auth").getImmediate());return(r=>new Oc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),oe(lp,hp,ww(n)),oe(lp,hp,"esm2017")}var Aw=5*60,Dw=Ba("authIdTokenMaxAge")||Aw,dp=null,bw=n=>e=>_(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Dw)return;let i=t?.token;dp!==i&&(dp=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function Jc(n=un()){let e=Mn(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Bc(n,{popupRedirectResolver:qp,persistence:[zp,Mp,Yc]}),r=Ba("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=bw(s.toString());Hc(t,a,()=>a(t.currentUser)),Wc(t,c=>a(c))}}let i=Va("auth");return i?$c(t,`http://${i}`):Fn("Auth",!1),t}function Sw(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}sI({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=dn("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Sw().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Tw("Browser");var Gp="auth",oi=class{constructor(e){return e}},ai=class{constructor(){return Un(Gp)}};var Xc=new Pe("angularfire2.auth-instances");function p0(n,e){let t=Qr(Gp,n,e);return t&&new oi(t)}function g0(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new oi(r)}}var m0={provide:ai,deps:[[new ze,Xc]]},_0={provide:oi,useFactory:p0,deps:[[new ze,Xc],Tt]};function PC(n,...e){return oe("angularfire",jt.full,"auth"),Nn([_0,m0,{provide:Xc,useFactory:g0(n),multi:!0,deps:[rt,vt,qt,hn,[new ze,Bn],...e]}])}var kC=ae(jc,!0,2);var NC=ae(Jc,!0);var OC=ae(Kc,!0);var FC=ae(qc,!0,2);var LC=ae(Qc,!0,2);var xC=ae(Gc,!0,2);var Wp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Hp={};var Ct,Zc;(function(){var n;function e(w,m){function v(){}v.prototype=m.prototype,w.D=m.prototype,w.prototype=new v,w.prototype.constructor=w,w.C=function(I,T,D){for(var E=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)E[mt-2]=arguments[mt];return m.prototype[T].apply(I,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,m,v){v||(v=0);var I=Array(16);if(typeof m=="string")for(var T=0;16>T;++T)I[T]=m.charCodeAt(v++)|m.charCodeAt(v++)<<8|m.charCodeAt(v++)<<16|m.charCodeAt(v++)<<24;else for(T=0;16>T;++T)I[T]=m[v++]|m[v++]<<8|m[v++]<<16|m[v++]<<24;m=w.g[0],v=w.g[1],T=w.g[2];var D=w.g[3],E=m+(D^v&(T^D))+I[0]+3614090360&4294967295;m=v+(E<<7&4294967295|E>>>25),E=D+(T^m&(v^T))+I[1]+3905402710&4294967295,D=m+(E<<12&4294967295|E>>>20),E=T+(v^D&(m^v))+I[2]+606105819&4294967295,T=D+(E<<17&4294967295|E>>>15),E=v+(m^T&(D^m))+I[3]+3250441966&4294967295,v=T+(E<<22&4294967295|E>>>10),E=m+(D^v&(T^D))+I[4]+4118548399&4294967295,m=v+(E<<7&4294967295|E>>>25),E=D+(T^m&(v^T))+I[5]+1200080426&4294967295,D=m+(E<<12&4294967295|E>>>20),E=T+(v^D&(m^v))+I[6]+2821735955&4294967295,T=D+(E<<17&4294967295|E>>>15),E=v+(m^T&(D^m))+I[7]+4249261313&4294967295,v=T+(E<<22&4294967295|E>>>10),E=m+(D^v&(T^D))+I[8]+1770035416&4294967295,m=v+(E<<7&4294967295|E>>>25),E=D+(T^m&(v^T))+I[9]+2336552879&4294967295,D=m+(E<<12&4294967295|E>>>20),E=T+(v^D&(m^v))+I[10]+4294925233&4294967295,T=D+(E<<17&4294967295|E>>>15),E=v+(m^T&(D^m))+I[11]+2304563134&4294967295,v=T+(E<<22&4294967295|E>>>10),E=m+(D^v&(T^D))+I[12]+1804603682&4294967295,m=v+(E<<7&4294967295|E>>>25),E=D+(T^m&(v^T))+I[13]+4254626195&4294967295,D=m+(E<<12&4294967295|E>>>20),E=T+(v^D&(m^v))+I[14]+2792965006&4294967295,T=D+(E<<17&4294967295|E>>>15),E=v+(m^T&(D^m))+I[15]+1236535329&4294967295,v=T+(E<<22&4294967295|E>>>10),E=m+(T^D&(v^T))+I[1]+4129170786&4294967295,m=v+(E<<5&4294967295|E>>>27),E=D+(v^T&(m^v))+I[6]+3225465664&4294967295,D=m+(E<<9&4294967295|E>>>23),E=T+(m^v&(D^m))+I[11]+643717713&4294967295,T=D+(E<<14&4294967295|E>>>18),E=v+(D^m&(T^D))+I[0]+3921069994&4294967295,v=T+(E<<20&4294967295|E>>>12),E=m+(T^D&(v^T))+I[5]+3593408605&4294967295,m=v+(E<<5&4294967295|E>>>27),E=D+(v^T&(m^v))+I[10]+38016083&4294967295,D=m+(E<<9&4294967295|E>>>23),E=T+(m^v&(D^m))+I[15]+3634488961&4294967295,T=D+(E<<14&4294967295|E>>>18),E=v+(D^m&(T^D))+I[4]+3889429448&4294967295,v=T+(E<<20&4294967295|E>>>12),E=m+(T^D&(v^T))+I[9]+568446438&4294967295,m=v+(E<<5&4294967295|E>>>27),E=D+(v^T&(m^v))+I[14]+3275163606&4294967295,D=m+(E<<9&4294967295|E>>>23),E=T+(m^v&(D^m))+I[3]+4107603335&4294967295,T=D+(E<<14&4294967295|E>>>18),E=v+(D^m&(T^D))+I[8]+1163531501&4294967295,v=T+(E<<20&4294967295|E>>>12),E=m+(T^D&(v^T))+I[13]+2850285829&4294967295,m=v+(E<<5&4294967295|E>>>27),E=D+(v^T&(m^v))+I[2]+4243563512&4294967295,D=m+(E<<9&4294967295|E>>>23),E=T+(m^v&(D^m))+I[7]+1735328473&4294967295,T=D+(E<<14&4294967295|E>>>18),E=v+(D^m&(T^D))+I[12]+2368359562&4294967295,v=T+(E<<20&4294967295|E>>>12),E=m+(v^T^D)+I[5]+4294588738&4294967295,m=v+(E<<4&4294967295|E>>>28),E=D+(m^v^T)+I[8]+2272392833&4294967295,D=m+(E<<11&4294967295|E>>>21),E=T+(D^m^v)+I[11]+1839030562&4294967295,T=D+(E<<16&4294967295|E>>>16),E=v+(T^D^m)+I[14]+4259657740&4294967295,v=T+(E<<23&4294967295|E>>>9),E=m+(v^T^D)+I[1]+2763975236&4294967295,m=v+(E<<4&4294967295|E>>>28),E=D+(m^v^T)+I[4]+1272893353&4294967295,D=m+(E<<11&4294967295|E>>>21),E=T+(D^m^v)+I[7]+4139469664&4294967295,T=D+(E<<16&4294967295|E>>>16),E=v+(T^D^m)+I[10]+3200236656&4294967295,v=T+(E<<23&4294967295|E>>>9),E=m+(v^T^D)+I[13]+681279174&4294967295,m=v+(E<<4&4294967295|E>>>28),E=D+(m^v^T)+I[0]+3936430074&4294967295,D=m+(E<<11&4294967295|E>>>21),E=T+(D^m^v)+I[3]+3572445317&4294967295,T=D+(E<<16&4294967295|E>>>16),E=v+(T^D^m)+I[6]+76029189&4294967295,v=T+(E<<23&4294967295|E>>>9),E=m+(v^T^D)+I[9]+3654602809&4294967295,m=v+(E<<4&4294967295|E>>>28),E=D+(m^v^T)+I[12]+3873151461&4294967295,D=m+(E<<11&4294967295|E>>>21),E=T+(D^m^v)+I[15]+530742520&4294967295,T=D+(E<<16&4294967295|E>>>16),E=v+(T^D^m)+I[2]+3299628645&4294967295,v=T+(E<<23&4294967295|E>>>9),E=m+(T^(v|~D))+I[0]+4096336452&4294967295,m=v+(E<<6&4294967295|E>>>26),E=D+(v^(m|~T))+I[7]+1126891415&4294967295,D=m+(E<<10&4294967295|E>>>22),E=T+(m^(D|~v))+I[14]+2878612391&4294967295,T=D+(E<<15&4294967295|E>>>17),E=v+(D^(T|~m))+I[5]+4237533241&4294967295,v=T+(E<<21&4294967295|E>>>11),E=m+(T^(v|~D))+I[12]+1700485571&4294967295,m=v+(E<<6&4294967295|E>>>26),E=D+(v^(m|~T))+I[3]+2399980690&4294967295,D=m+(E<<10&4294967295|E>>>22),E=T+(m^(D|~v))+I[10]+4293915773&4294967295,T=D+(E<<15&4294967295|E>>>17),E=v+(D^(T|~m))+I[1]+2240044497&4294967295,v=T+(E<<21&4294967295|E>>>11),E=m+(T^(v|~D))+I[8]+1873313359&4294967295,m=v+(E<<6&4294967295|E>>>26),E=D+(v^(m|~T))+I[15]+4264355552&4294967295,D=m+(E<<10&4294967295|E>>>22),E=T+(m^(D|~v))+I[6]+2734768916&4294967295,T=D+(E<<15&4294967295|E>>>17),E=v+(D^(T|~m))+I[13]+1309151649&4294967295,v=T+(E<<21&4294967295|E>>>11),E=m+(T^(v|~D))+I[4]+4149444226&4294967295,m=v+(E<<6&4294967295|E>>>26),E=D+(v^(m|~T))+I[11]+3174756917&4294967295,D=m+(E<<10&4294967295|E>>>22),E=T+(m^(D|~v))+I[2]+718787259&4294967295,T=D+(E<<15&4294967295|E>>>17),E=v+(D^(T|~m))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+m&4294967295,w.g[1]=w.g[1]+(T+(E<<21&4294967295|E>>>11))&4294967295,w.g[2]=w.g[2]+T&4294967295,w.g[3]=w.g[3]+D&4294967295}r.prototype.u=function(w,m){m===void 0&&(m=w.length);for(var v=m-this.blockSize,I=this.B,T=this.h,D=0;D<m;){if(T==0)for(;D<=v;)i(this,w,D),D+=this.blockSize;if(typeof w=="string"){for(;D<m;)if(I[T++]=w.charCodeAt(D++),T==this.blockSize){i(this,I),T=0;break}}else for(;D<m;)if(I[T++]=w[D++],T==this.blockSize){i(this,I),T=0;break}}this.h=T,this.o+=m},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var m=1;m<w.length-8;++m)w[m]=0;var v=8*this.o;for(m=w.length-8;m<w.length;++m)w[m]=v&255,v/=256;for(this.u(w),w=Array(16),m=v=0;4>m;++m)for(var I=0;32>I;I+=8)w[v++]=this.g[m]>>>I&255;return w};function s(w,m){var v=c;return Object.prototype.hasOwnProperty.call(v,w)?v[w]:v[w]=m(w)}function a(w,m){this.h=m;for(var v=[],I=!0,T=w.length-1;0<=T;T--){var D=w[T]|0;I&&D==m||(v[T]=D,I=!1)}this.g=v}var c={};function l(w){return-128<=w&&128>w?s(w,function(m){return new a([m|0],0>m?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return g;if(0>w)return k(d(-w));for(var m=[],v=1,I=0;w>=v;I++)m[I]=w/v|0,v*=4294967296;return new a(m,0)}function p(w,m){if(w.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(w.charAt(0)=="-")return k(p(w.substring(1),m));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=d(Math.pow(m,8)),I=g,T=0;T<w.length;T+=8){var D=Math.min(8,w.length-T),E=parseInt(w.substring(T,T+D),m);8>D?(D=d(Math.pow(m,D)),I=I.j(D).add(d(E))):(I=I.j(v),I=I.add(d(E)))}return I}var g=l(0),y=l(1),b=l(16777216);n=a.prototype,n.m=function(){if(O(this))return-k(this).m();for(var w=0,m=1,v=0;v<this.g.length;v++){var I=this.i(v);w+=(0<=I?I:4294967296+I)*m,m*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(R(this))return"0";if(O(this))return"-"+k(this).toString(w);for(var m=d(Math.pow(w,6)),v=this,I="";;){var T=Q(v,m).g;v=j(v,T.j(m));var D=((0<v.g.length?v.g[0]:v.h)>>>0).toString(w);if(v=T,R(v))return D+I;for(;6>D.length;)D="0"+D;I=D+I}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function R(w){if(w.h!=0)return!1;for(var m=0;m<w.g.length;m++)if(w.g[m]!=0)return!1;return!0}function O(w){return w.h==-1}n.l=function(w){return w=j(this,w),O(w)?-1:R(w)?0:1};function k(w){for(var m=w.g.length,v=[],I=0;I<m;I++)v[I]=~w.g[I];return new a(v,~w.h).add(y)}n.abs=function(){return O(this)?k(this):this},n.add=function(w){for(var m=Math.max(this.g.length,w.g.length),v=[],I=0,T=0;T<=m;T++){var D=I+(this.i(T)&65535)+(w.i(T)&65535),E=(D>>>16)+(this.i(T)>>>16)+(w.i(T)>>>16);I=E>>>16,D&=65535,E&=65535,v[T]=E<<16|D}return new a(v,v[v.length-1]&-2147483648?-1:0)};function j(w,m){return w.add(k(m))}n.j=function(w){if(R(this)||R(w))return g;if(O(this))return O(w)?k(this).j(k(w)):k(k(this).j(w));if(O(w))return k(this.j(k(w)));if(0>this.l(b)&&0>w.l(b))return d(this.m()*w.m());for(var m=this.g.length+w.g.length,v=[],I=0;I<2*m;I++)v[I]=0;for(I=0;I<this.g.length;I++)for(var T=0;T<w.g.length;T++){var D=this.i(I)>>>16,E=this.i(I)&65535,mt=w.i(T)>>>16,mr=w.i(T)&65535;v[2*I+2*T]+=E*mr,M(v,2*I+2*T),v[2*I+2*T+1]+=D*mr,M(v,2*I+2*T+1),v[2*I+2*T+1]+=E*mt,M(v,2*I+2*T+1),v[2*I+2*T+2]+=D*mt,M(v,2*I+2*T+2)}for(I=0;I<m;I++)v[I]=v[2*I+1]<<16|v[2*I];for(I=m;I<2*m;I++)v[I]=0;return new a(v,0)};function M(w,m){for(;(w[m]&65535)!=w[m];)w[m+1]+=w[m]>>>16,w[m]&=65535,m++}function $(w,m){this.g=w,this.h=m}function Q(w,m){if(R(m))throw Error("division by zero");if(R(w))return new $(g,g);if(O(w))return m=Q(k(w),m),new $(k(m.g),k(m.h));if(O(m))return m=Q(w,k(m)),new $(k(m.g),m.h);if(30<w.g.length){if(O(w)||O(m))throw Error("slowDivide_ only works with positive integers.");for(var v=y,I=m;0>=I.l(w);)v=pe(v),I=pe(I);var T=J(v,1),D=J(I,1);for(I=J(I,2),v=J(v,2);!R(I);){var E=D.add(I);0>=E.l(w)&&(T=T.add(v),D=E),I=J(I,1),v=J(v,1)}return m=j(w,T.j(m)),new $(T,m)}for(T=g;0<=w.l(m);){for(v=Math.max(1,Math.floor(w.m()/m.m())),I=Math.ceil(Math.log(v)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),D=d(v),E=D.j(m);O(E)||0<E.l(w);)v-=I,D=d(v),E=D.j(m);R(D)&&(D=y),T=T.add(D),w=j(w,E)}return new $(T,w)}n.A=function(w){return Q(this,w).h},n.and=function(w){for(var m=Math.max(this.g.length,w.g.length),v=[],I=0;I<m;I++)v[I]=this.i(I)&w.i(I);return new a(v,this.h&w.h)},n.or=function(w){for(var m=Math.max(this.g.length,w.g.length),v=[],I=0;I<m;I++)v[I]=this.i(I)|w.i(I);return new a(v,this.h|w.h)},n.xor=function(w){for(var m=Math.max(this.g.length,w.g.length),v=[],I=0;I<m;I++)v[I]=this.i(I)^w.i(I);return new a(v,this.h^w.h)};function pe(w){for(var m=w.g.length+1,v=[],I=0;I<m;I++)v[I]=w.i(I)<<1|w.i(I-1)>>>31;return new a(v,w.h)}function J(w,m){var v=m>>5;m%=32;for(var I=w.g.length-v,T=[],D=0;D<I;D++)T[D]=0<m?w.i(D+v)>>>m|w.i(D+v+1)<<32-m:w.i(D+v);return new a(T,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Zc=Hp.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Ct=Hp.Integer=a}).apply(typeof Wp<"u"?Wp:typeof self<"u"?self:typeof window<"u"?window:{});var Us=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Rt={};var eu,y0,jn,tu,ci,Bs,nu,ru,iu;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,h){return o==Array.prototype||o==Object.prototype||(o[u]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Us=="object"&&Us];for(var u=0;u<o.length;++u){var h=o[u];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(o,u){if(u)e:{var h=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var A=o[f];if(!(A in h))break e;h=h[A]}o=o[o.length-1],f=h[o],u=u(f),u!=f&&u!=null&&e(h,o,{configurable:!0,writable:!0,value:u})}}function s(o,u){o instanceof String&&(o+="");var h=0,f=!1,A={next:function(){if(!f&&h<o.length){var S=h++;return{value:u(S,o[S]),done:!1}}return f=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(o){return o||function(){return s(this,function(u,h){return h})}});var a=a||{},c=this||self;function l(o){var u=typeof o;return u=u!="object"?u:o?Array.isArray(o)?"array":u:"null",u=="array"||u=="object"&&typeof o.length=="number"}function d(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function p(o,u,h){return o.call.apply(o.bind,arguments)}function g(o,u,h){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,f),o.apply(u,A)}}return function(){return o.apply(u,arguments)}}function y(o,u,h){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,y.apply(null,arguments)}function b(o,u){var h=Array.prototype.slice.call(arguments,1);return function(){var f=h.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function R(o,u){function h(){}h.prototype=u.prototype,o.aa=u.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(f,A,S){for(var N=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)N[Z-2]=arguments[Z];return u.prototype[A].apply(f,N)}}function O(o){let u=o.length;if(0<u){let h=Array(u);for(let f=0;f<u;f++)h[f]=o[f];return h}return[]}function k(o,u){for(let h=1;h<arguments.length;h++){let f=arguments[h];if(l(f)){let A=o.length||0,S=f.length||0;o.length=A+S;for(let N=0;N<S;N++)o[A+N]=f[N]}else o.push(f)}}class j{constructor(u,h){this.i=u,this.j=h,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function M(o){return/^[\s\xa0]*$/.test(o)}function $(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function Q(o){return Q[" "](o),o}Q[" "]=function(){};var pe=$().indexOf("Gecko")!=-1&&!($().toLowerCase().indexOf("webkit")!=-1&&$().indexOf("Edge")==-1)&&!($().indexOf("Trident")!=-1||$().indexOf("MSIE")!=-1)&&$().indexOf("Edge")==-1;function J(o,u,h){for(let f in o)u.call(h,o[f],f,o)}function w(o,u){for(let h in o)u.call(void 0,o[h],h,o)}function m(o){let u={};for(let h in o)u[h]=o[h];return u}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(o,u){let h,f;for(let A=1;A<arguments.length;A++){f=arguments[A];for(h in f)o[h]=f[h];for(let S=0;S<v.length;S++)h=v[S],Object.prototype.hasOwnProperty.call(f,h)&&(o[h]=f[h])}}function T(o){var u=1;o=o.split(":");let h=[];for(;0<u&&o.length;)h.push(o.shift()),u--;return o.length&&h.push(o.join(":")),h}function D(o){c.setTimeout(()=>{throw o},0)}function E(){var o=$o;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class mt{constructor(){this.h=this.g=null}add(u,h){let f=mr.get();f.set(u,h),this.h?this.h.next=f:this.g=f,this.h=f}}var mr=new j(()=>new D_,o=>o.reset());class D_{constructor(){this.next=this.g=this.h=null}set(u,h){this.h=u,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let _r,yr=!1,$o=new mt,Th=()=>{let o=c.Promise.resolve(void 0);_r=()=>{o.then(b_)}};var b_=()=>{for(var o;o=E();){try{o.h.call(o.g)}catch(h){D(h)}var u=mr;u.j(o),100>u.h&&(u.h++,o.next=u.g,u.g=o)}yr=!1};function xt(){this.s=this.s,this.C=this.C}xt.prototype.s=!1,xt.prototype.ma=function(){this.s||(this.s=!0,this.N())},xt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var S_=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};c.addEventListener("test",h,u),c.removeEventListener("test",h,u)}catch{}return o}();function Er(o,u){if(ve.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget){if(pe){e:{try{Q(u.nodeName);var A=!0;break e}catch{}A=!1}A||(u=null)}}else h=="mouseover"?u=o.fromElement:h=="mouseout"&&(u=o.toElement);this.relatedTarget=u,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:C_[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Er.aa.h.call(this)}}R(Er,ve);var C_={2:"touch",3:"pen",4:"mouse"};Er.prototype.h=function(){Er.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var vr="closure_listenable_"+(1e6*Math.random()|0),R_=0;function P_(o,u,h,f,A){this.listener=o,this.proxy=null,this.src=u,this.type=h,this.capture=!!f,this.ha=A,this.key=++R_,this.da=this.fa=!1}function ki(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Ni(o){this.src=o,this.g={},this.h=0}Ni.prototype.add=function(o,u,h,f,A){var S=o.toString();o=this.g[S],o||(o=this.g[S]=[],this.h++);var N=jo(o,u,f,A);return-1<N?(u=o[N],h||(u.fa=!1)):(u=new P_(u,this.src,S,!!f,A),u.fa=h,o.push(u)),u};function zo(o,u){var h=u.type;if(h in o.g){var f=o.g[h],A=Array.prototype.indexOf.call(f,u,void 0),S;(S=0<=A)&&Array.prototype.splice.call(f,A,1),S&&(ki(u),o.g[h].length==0&&(delete o.g[h],o.h--))}}function jo(o,u,h,f){for(var A=0;A<o.length;++A){var S=o[A];if(!S.da&&S.listener==u&&S.capture==!!h&&S.ha==f)return A}return-1}var qo="closure_lm_"+(1e6*Math.random()|0),Go={};function Ah(o,u,h,f,A){if(f&&f.once)return bh(o,u,h,f,A);if(Array.isArray(u)){for(var S=0;S<u.length;S++)Ah(o,u[S],h,f,A);return null}return h=Qo(h),o&&o[vr]?o.K(u,h,d(f)?!!f.capture:!!f,A):Dh(o,u,h,!1,f,A)}function Dh(o,u,h,f,A,S){if(!u)throw Error("Invalid event type");var N=d(A)?!!A.capture:!!A,Z=Ho(o);if(Z||(o[qo]=Z=new Ni(o)),h=Z.add(u,h,f,N,S),h.proxy)return h;if(f=k_(),h.proxy=f,f.src=o,f.listener=h,o.addEventListener)S_||(A=N),A===void 0&&(A=!1),o.addEventListener(u.toString(),f,A);else if(o.attachEvent)o.attachEvent(Ch(u.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return h}function k_(){function o(h){return u.call(o.src,o.listener,h)}let u=N_;return o}function bh(o,u,h,f,A){if(Array.isArray(u)){for(var S=0;S<u.length;S++)bh(o,u[S],h,f,A);return null}return h=Qo(h),o&&o[vr]?o.L(u,h,d(f)?!!f.capture:!!f,A):Dh(o,u,h,!0,f,A)}function Sh(o,u,h,f,A){if(Array.isArray(u))for(var S=0;S<u.length;S++)Sh(o,u[S],h,f,A);else f=d(f)?!!f.capture:!!f,h=Qo(h),o&&o[vr]?(o=o.i,u=String(u).toString(),u in o.g&&(S=o.g[u],h=jo(S,h,f,A),-1<h&&(ki(S[h]),Array.prototype.splice.call(S,h,1),S.length==0&&(delete o.g[u],o.h--)))):o&&(o=Ho(o))&&(u=o.g[u.toString()],o=-1,u&&(o=jo(u,h,f,A)),(h=-1<o?u[o]:null)&&Wo(h))}function Wo(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[vr])zo(u.i,o);else{var h=o.type,f=o.proxy;u.removeEventListener?u.removeEventListener(h,f,o.capture):u.detachEvent?u.detachEvent(Ch(h),f):u.addListener&&u.removeListener&&u.removeListener(f),(h=Ho(u))?(zo(h,o),h.h==0&&(h.src=null,u[qo]=null)):ki(o)}}}function Ch(o){return o in Go?Go[o]:Go[o]="on"+o}function N_(o,u){if(o.da)o=!0;else{u=new Er(u,this);var h=o.listener,f=o.ha||o.src;o.fa&&Wo(o),o=h.call(f,u)}return o}function Ho(o){return o=o[qo],o instanceof Ni?o:null}var Ko="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qo(o){return typeof o=="function"?o:(o[Ko]||(o[Ko]=function(u){return o.handleEvent(u)}),o[Ko])}function Ie(){xt.call(this),this.i=new Ni(this),this.M=this,this.F=null}R(Ie,xt),Ie.prototype[vr]=!0,Ie.prototype.removeEventListener=function(o,u,h,f){Sh(this,o,u,h,f)};function Ce(o,u){var h,f=o.F;if(f)for(h=[];f;f=f.F)h.push(f);if(o=o.M,f=u.type||u,typeof u=="string")u=new ve(u,o);else if(u instanceof ve)u.target=u.target||o;else{var A=u;u=new ve(f,o),I(u,A)}if(A=!0,h)for(var S=h.length-1;0<=S;S--){var N=u.g=h[S];A=Oi(N,f,!0,u)&&A}if(N=u.g=o,A=Oi(N,f,!0,u)&&A,A=Oi(N,f,!1,u)&&A,h)for(S=0;S<h.length;S++)N=u.g=h[S],A=Oi(N,f,!1,u)&&A}Ie.prototype.N=function(){if(Ie.aa.N.call(this),this.i){var o=this.i,u;for(u in o.g){for(var h=o.g[u],f=0;f<h.length;f++)ki(h[f]);delete o.g[u],o.h--}}this.F=null},Ie.prototype.K=function(o,u,h,f){return this.i.add(String(o),u,!1,h,f)},Ie.prototype.L=function(o,u,h,f){return this.i.add(String(o),u,!0,h,f)};function Oi(o,u,h,f){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();for(var A=!0,S=0;S<u.length;++S){var N=u[S];if(N&&!N.da&&N.capture==h){var Z=N.listener,ye=N.ha||N.src;N.fa&&zo(o.i,N),A=Z.call(ye,f)!==!1&&A}}return A&&!f.defaultPrevented}function Rh(o,u,h){if(typeof o=="function")h&&(o=y(o,h));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:c.setTimeout(o,u||0)}function Ph(o){o.g=Rh(()=>{o.g=null,o.i&&(o.i=!1,Ph(o))},o.l);let u=o.h;o.h=null,o.m.apply(null,u)}class O_ extends xt{constructor(u,h){super(),this.m=u,this.l=h,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:Ph(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ir(o){xt.call(this),this.h=o,this.g={}}R(Ir,xt);var kh=[];function Nh(o){J(o.g,function(u,h){this.g.hasOwnProperty(h)&&Wo(u)},o),o.g={}}Ir.prototype.N=function(){Ir.aa.N.call(this),Nh(this)},Ir.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Yo=c.JSON.stringify,F_=c.JSON.parse,L_=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function Jo(){}Jo.prototype.h=null;function Oh(o){return o.h||(o.h=o.i())}function Fh(){}var wr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xo(){ve.call(this,"d")}R(Xo,ve);function Zo(){ve.call(this,"c")}R(Zo,ve);var tn={},Lh=null;function Fi(){return Lh=Lh||new Ie}tn.La="serverreachability";function xh(o){ve.call(this,tn.La,o)}R(xh,ve);function Tr(o){let u=Fi();Ce(u,new xh(u))}tn.STAT_EVENT="statevent";function Mh(o,u){ve.call(this,tn.STAT_EVENT,o),this.stat=u}R(Mh,ve);function Re(o){let u=Fi();Ce(u,new Mh(u,o))}tn.Ma="timingevent";function Vh(o,u){ve.call(this,tn.Ma,o),this.size=u}R(Vh,ve);function Ar(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},u)}function Dr(){this.g=!0}Dr.prototype.xa=function(){this.g=!1};function x_(o,u,h,f,A,S){o.info(function(){if(o.g)if(S)for(var N="",Z=S.split("&"),ye=0;ye<Z.length;ye++){var K=Z[ye].split("=");if(1<K.length){var we=K[0];K=K[1];var Te=we.split("_");N=2<=Te.length&&Te[1]=="type"?N+(we+"="+K+"&"):N+(we+"=redacted&")}}else N=null;else N=S;return"XMLHTTP REQ ("+f+") [attempt "+A+"]: "+u+`
`+h+`
`+N})}function M_(o,u,h,f,A,S,N){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+A+"]: "+u+`
`+h+`
`+S+" "+N})}function Cn(o,u,h,f){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+U_(o,h)+(f?" "+f:"")})}function V_(o,u){o.info(function(){return"TIMEOUT: "+u})}Dr.prototype.info=function(){};function U_(o,u){if(!o.g)return u;if(!u)return null;try{var h=JSON.parse(u);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var f=h[o];if(!(2>f.length)){var A=f[1];if(Array.isArray(A)&&!(1>A.length)){var S=A[0];if(S!="noop"&&S!="stop"&&S!="close")for(var N=1;N<A.length;N++)A[N]=""}}}}return Yo(h)}catch{return u}}var Li={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Uh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ea;function xi(){}R(xi,Jo),xi.prototype.g=function(){return new XMLHttpRequest},xi.prototype.i=function(){return{}},ea=new xi;function Mt(o,u,h,f){this.j=o,this.i=u,this.l=h,this.R=f||1,this.U=new Ir(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bh}function Bh(){this.i=null,this.g="",this.h=!1}var $h={},ta={};function na(o,u,h){o.L=1,o.v=Bi(_t(u)),o.m=h,o.P=!0,zh(o,null)}function zh(o,u){o.F=Date.now(),Mi(o),o.A=_t(o.v);var h=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),nd(h.i,"t",f),o.C=0,h=o.j.J,o.h=new Bh,o.g=vd(o.j,h?u:null,!o.m),0<o.O&&(o.M=new O_(y(o.Y,o,o.g),o.O)),u=o.U,h=o.g,f=o.ca;var A="readystatechange";Array.isArray(A)||(A&&(kh[0]=A.toString()),A=kh);for(var S=0;S<A.length;S++){var N=Ah(h,A[S],f||u.handleEvent,!1,u.h||u);if(!N)break;u.g[N.key]=N}u=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,u)):(o.u="GET",o.g.ea(o.A,o.u,null,u)),Tr(),x_(o.i,o.u,o.A,o.l,o.R,o.m)}Mt.prototype.ca=function(o){o=o.target;let u=this.M;u&&yt(o)==3?u.j():this.Y(o)},Mt.prototype.Y=function(o){try{if(o==this.g)e:{let Te=yt(this.g);var u=this.g.Ba();let kn=this.g.Z();if(!(3>Te)&&(Te!=3||this.g&&(this.h.h||this.g.oa()||ud(this.g)))){this.J||Te!=4||u==7||(u==8||0>=kn?Tr(3):Tr(2)),ra(this);var h=this.g.Z();this.X=h;t:if(jh(this)){var f=ud(this.g);o="";var A=f.length,S=yt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){nn(this),br(this);var N="";break t}this.h.i=new c.TextDecoder}for(u=0;u<A;u++)this.h.h=!0,o+=this.h.i.decode(f[u],{stream:!(S&&u==A-1)});f.length=0,this.h.g+=o,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=h==200,M_(this.i,this.u,this.A,this.l,this.R,Te,h),this.o){if(this.T&&!this.K){t:{if(this.g){var Z,ye=this.g;if((Z=ye.g?ye.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(Z)){var K=Z;break t}}K=null}if(h=K)Cn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ia(this,h);else{this.o=!1,this.s=3,Re(12),nn(this),br(this);break e}}if(this.P){h=!0;let He;for(;!this.J&&this.C<N.length;)if(He=B_(this,N),He==ta){Te==4&&(this.s=4,Re(14),h=!1),Cn(this.i,this.l,null,"[Incomplete Response]");break}else if(He==$h){this.s=4,Re(15),Cn(this.i,this.l,N,"[Invalid Chunk]"),h=!1;break}else Cn(this.i,this.l,He,null),ia(this,He);if(jh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Te!=4||N.length!=0||this.h.h||(this.s=1,Re(16),h=!1),this.o=this.o&&h,!h)Cn(this.i,this.l,N,"[Invalid Chunked Response]"),nn(this),br(this);else if(0<N.length&&!this.W){this.W=!0;var we=this.j;we.g==this&&we.ba&&!we.M&&(we.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),la(we),we.M=!0,Re(11))}}else Cn(this.i,this.l,N,null),ia(this,N);Te==4&&nn(this),this.o&&!this.J&&(Te==4?md(this.j,this):(this.o=!1,Mi(this)))}else ry(this.g),h==400&&0<N.indexOf("Unknown SID")?(this.s=3,Re(12)):(this.s=0,Re(13)),nn(this),br(this)}}}catch{}finally{}};function jh(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function B_(o,u){var h=o.C,f=u.indexOf(`
`,h);return f==-1?ta:(h=Number(u.substring(h,f)),isNaN(h)?$h:(f+=1,f+h>u.length?ta:(u=u.slice(f,f+h),o.C=f+h,u)))}Mt.prototype.cancel=function(){this.J=!0,nn(this)};function Mi(o){o.S=Date.now()+o.I,qh(o,o.I)}function qh(o,u){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Ar(y(o.ba,o),u)}function ra(o){o.B&&(c.clearTimeout(o.B),o.B=null)}Mt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(V_(this.i,this.A),this.L!=2&&(Tr(),Re(17)),nn(this),this.s=2,br(this)):qh(this,this.S-o)};function br(o){o.j.G==0||o.J||md(o.j,o)}function nn(o){ra(o);var u=o.M;u&&typeof u.ma=="function"&&u.ma(),o.M=null,Nh(o.U),o.g&&(u=o.g,o.g=null,u.abort(),u.ma())}function ia(o,u){try{var h=o.j;if(h.G!=0&&(h.g==o||sa(h.h,o))){if(!o.K&&sa(h.h,o)&&h.G==3){try{var f=h.Da.g.parse(u)}catch{f=null}if(Array.isArray(f)&&f.length==3){var A=f;if(A[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)Gi(h),ji(h);else break e;ua(h),Re(18)}}else h.za=A[1],0<h.za-h.T&&37500>A[2]&&h.F&&h.v==0&&!h.C&&(h.C=Ar(y(h.Za,h),6e3));if(1>=Hh(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else sn(h,11)}else if((o.K||h.g==o)&&Gi(h),!M(u))for(A=h.Da.g.parse(u),u=0;u<A.length;u++){let K=A[u];if(h.T=K[0],K=K[1],h.G==2)if(K[0]=="c"){h.K=K[1],h.ia=K[2];let we=K[3];we!=null&&(h.la=we,h.j.info("VER="+h.la));let Te=K[4];Te!=null&&(h.Aa=Te,h.j.info("SVER="+h.Aa));let kn=K[5];kn!=null&&typeof kn=="number"&&0<kn&&(f=1.5*kn,h.L=f,h.j.info("backChannelRequestTimeoutMs_="+f)),f=h;let He=o.g;if(He){let Hi=He.g?He.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Hi){var S=f.h;S.g||Hi.indexOf("spdy")==-1&&Hi.indexOf("quic")==-1&&Hi.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(oa(S,S.h),S.h=null))}if(f.D){let ha=He.g?He.g.getResponseHeader("X-HTTP-Session-Id"):null;ha&&(f.ya=ha,te(f.I,f.D,ha))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),f=h;var N=o;if(f.qa=Ed(f,f.J?f.ia:null,f.W),N.K){Kh(f.h,N);var Z=N,ye=f.L;ye&&(Z.I=ye),Z.B&&(ra(Z),Mi(Z)),f.g=N}else pd(f);0<h.i.length&&qi(h)}else K[0]!="stop"&&K[0]!="close"||sn(h,7);else h.G==3&&(K[0]=="stop"||K[0]=="close"?K[0]=="stop"?sn(h,7):ca(h):K[0]!="noop"&&h.l&&h.l.ta(K),h.v=0)}}Tr(4)}catch{}}var $_=class{constructor(o,u){this.g=o,this.map=u}};function Gh(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Wh(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Hh(o){return o.h?1:o.g?o.g.size:0}function sa(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function oa(o,u){o.g?o.g.add(u):o.h=u}function Kh(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Gh.prototype.cancel=function(){if(this.i=Qh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Qh(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let u=o.i;for(let h of o.g.values())u=u.concat(h.D);return u}return O(o.i)}function z_(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(l(o)){for(var u=[],h=o.length,f=0;f<h;f++)u.push(o[f]);return u}u=[],h=0;for(f in o)u[h++]=o[f];return u}function j_(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(l(o)||typeof o=="string"){var u=[];o=o.length;for(var h=0;h<o;h++)u.push(h);return u}u=[],h=0;for(let f in o)u[h++]=f;return u}}}function Yh(o,u){if(o.forEach&&typeof o.forEach=="function")o.forEach(u,void 0);else if(l(o)||typeof o=="string")Array.prototype.forEach.call(o,u,void 0);else for(var h=j_(o),f=z_(o),A=f.length,S=0;S<A;S++)u.call(void 0,f[S],h&&h[S],o)}var Jh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function q_(o,u){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var f=o[h].indexOf("="),A=null;if(0<=f){var S=o[h].substring(0,f);A=o[h].substring(f+1)}else S=o[h];u(S,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function rn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof rn){this.h=o.h,Vi(this,o.j),this.o=o.o,this.g=o.g,Ui(this,o.s),this.l=o.l;var u=o.i,h=new Rr;h.i=u.i,u.g&&(h.g=new Map(u.g),h.h=u.h),Xh(this,h),this.m=o.m}else o&&(u=String(o).match(Jh))?(this.h=!1,Vi(this,u[1]||"",!0),this.o=Sr(u[2]||""),this.g=Sr(u[3]||"",!0),Ui(this,u[4]),this.l=Sr(u[5]||"",!0),Xh(this,u[6]||"",!0),this.m=Sr(u[7]||"")):(this.h=!1,this.i=new Rr(null,this.h))}rn.prototype.toString=function(){var o=[],u=this.j;u&&o.push(Cr(u,Zh,!0),":");var h=this.g;return(h||u=="file")&&(o.push("//"),(u=this.o)&&o.push(Cr(u,Zh,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(Cr(h,h.charAt(0)=="/"?H_:W_,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",Cr(h,Q_)),o.join("")};function _t(o){return new rn(o)}function Vi(o,u,h){o.j=h?Sr(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function Ui(o,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);o.s=u}else o.s=null}function Xh(o,u,h){u instanceof Rr?(o.i=u,Y_(o.i,o.h)):(h||(u=Cr(u,K_)),o.i=new Rr(u,o.h))}function te(o,u,h){o.i.set(u,h)}function Bi(o){return te(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Sr(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Cr(o,u,h){return typeof o=="string"?(o=encodeURI(o).replace(u,G_),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function G_(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Zh=/[#\/\?@]/g,W_=/[#\?:]/g,H_=/[#\?]/g,K_=/[#\?@]/g,Q_=/#/g;function Rr(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function Vt(o){o.g||(o.g=new Map,o.h=0,o.i&&q_(o.i,function(u,h){o.add(decodeURIComponent(u.replace(/\+/g," ")),h)}))}n=Rr.prototype,n.add=function(o,u){Vt(this),this.i=null,o=Rn(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(u),this.h+=1,this};function ed(o,u){Vt(o),u=Rn(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function td(o,u){return Vt(o),u=Rn(o,u),o.g.has(u)}n.forEach=function(o,u){Vt(this),this.g.forEach(function(h,f){h.forEach(function(A){o.call(u,A,f,this)},this)},this)},n.na=function(){Vt(this);let o=Array.from(this.g.values()),u=Array.from(this.g.keys()),h=[];for(let f=0;f<u.length;f++){let A=o[f];for(let S=0;S<A.length;S++)h.push(u[f])}return h},n.V=function(o){Vt(this);let u=[];if(typeof o=="string")td(this,o)&&(u=u.concat(this.g.get(Rn(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)u=u.concat(o[h])}return u},n.set=function(o,u){return Vt(this),this.i=null,o=Rn(this,o),td(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=this.V(o),0<o.length?String(o[0]):u):u};function nd(o,u,h){ed(o,u),0<h.length&&(o.i=null,o.g.set(Rn(o,u),O(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],u=Array.from(this.g.keys());for(var h=0;h<u.length;h++){var f=u[h];let S=encodeURIComponent(String(f)),N=this.V(f);for(f=0;f<N.length;f++){var A=S;N[f]!==""&&(A+="="+encodeURIComponent(String(N[f]))),o.push(A)}}return this.i=o.join("&")};function Rn(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function Y_(o,u){u&&!o.j&&(Vt(o),o.i=null,o.g.forEach(function(h,f){var A=f.toLowerCase();f!=A&&(ed(this,f),nd(this,A,h))},o)),o.j=u}function J_(o,u){let h=new Dr;if(c.Image){let f=new Image;f.onload=b(Ut,h,"TestLoadImage: loaded",!0,u,f),f.onerror=b(Ut,h,"TestLoadImage: error",!1,u,f),f.onabort=b(Ut,h,"TestLoadImage: abort",!1,u,f),f.ontimeout=b(Ut,h,"TestLoadImage: timeout",!1,u,f),c.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else u(!1)}function X_(o,u){let h=new Dr,f=new AbortController,A=setTimeout(()=>{f.abort(),Ut(h,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:f.signal}).then(S=>{clearTimeout(A),S.ok?Ut(h,"TestPingServer: ok",!0,u):Ut(h,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(A),Ut(h,"TestPingServer: error",!1,u)})}function Ut(o,u,h,f,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),f(h)}catch{}}function Z_(){this.g=new L_}function ey(o,u,h){let f=h||"";try{Yh(o,function(A,S){let N=A;d(A)&&(N=Yo(A)),u.push(f+S+"="+encodeURIComponent(N))})}catch(A){throw u.push(f+"type="+encodeURIComponent("_badmap")),A}}function Pr(o){this.l=o.Ub||null,this.j=o.eb||!1}R(Pr,Jo),Pr.prototype.g=function(){return new $i(this.l,this.j)},Pr.prototype.i=function(o){return function(){return o}}({});function $i(o,u){Ie.call(this),this.D=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R($i,Ie),n=$i.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=u,this.readyState=1,Nr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(u.body=o),(this.D||c).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,kr(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Nr(this)),this.g&&(this.readyState=3,Nr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;rd(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function rd(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?kr(this):Nr(this),this.readyState==3&&rd(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,kr(this))},n.Qa=function(o){this.g&&(this.response=o,kr(this))},n.ga=function(){this.g&&kr(this)};function kr(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Nr(o)}n.setRequestHeader=function(o,u){this.u.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],u=this.h.entries();for(var h=u.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=u.next();return o.join(`\r
`)};function Nr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty($i.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function id(o){let u="";return J(o,function(h,f){u+=f,u+=":",u+=h,u+=`\r
`}),u}function aa(o,u,h){e:{for(f in h){var f=!1;break e}f=!0}f||(h=id(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):te(o,u,h))}function ie(o){Ie.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(ie,Ie);var ty=/^https?$/i,ny=["POST","PUT"];n=ie.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,u,h,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ea.g(),this.v=this.o?Oh(this.o):Oh(ea),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(S){sd(this,S);return}if(o=h||"",h=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var A in f)h.set(A,f[A]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let S of f.keys())h.set(S,f.get(S));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(h.keys()).find(S=>S.toLowerCase()=="content-type"),A=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(ny,u,void 0))||f||A||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,N]of h)this.g.setRequestHeader(S,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{cd(this),this.u=!0,this.g.send(o),this.u=!1}catch(S){sd(this,S)}};function sd(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.m=5,od(o),zi(o)}function od(o){o.A||(o.A=!0,Ce(o,"complete"),Ce(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ce(this,"complete"),Ce(this,"abort"),zi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zi(this,!0)),ie.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?ad(this):this.bb())},n.bb=function(){ad(this)};function ad(o){if(o.h&&typeof a<"u"&&(!o.v[1]||yt(o)!=4||o.Z()!=2)){if(o.u&&yt(o)==4)Rh(o.Ea,0,o);else if(Ce(o,"readystatechange"),yt(o)==4){o.h=!1;try{let N=o.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var h;if(!(h=u)){var f;if(f=N===0){var A=String(o.D).match(Jh)[1]||null;!A&&c.self&&c.self.location&&(A=c.self.location.protocol.slice(0,-1)),f=!ty.test(A?A.toLowerCase():"")}h=f}if(h)Ce(o,"complete"),Ce(o,"success");else{o.m=6;try{var S=2<yt(o)?o.g.statusText:""}catch{S=""}o.l=S+" ["+o.Z()+"]",od(o)}}finally{zi(o)}}}}function zi(o,u){if(o.g){cd(o);let h=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,u||Ce(o,"ready");try{h.onreadystatechange=f}catch{}}}function cd(o){o.I&&(c.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function yt(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<yt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),F_(u)}};function ud(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function ry(o){let u={};o=(o.g&&2<=yt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(M(o[f]))continue;var h=T(o[f]);let A=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let S=u[A]||[];u[A]=S,S.push(h)}w(u,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Or(o,u,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||u}function ld(o){this.Aa=0,this.i=[],this.j=new Dr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Or("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Or("baseRetryDelayMs",5e3,o),this.cb=Or("retryDelaySeedMs",1e4,o),this.Wa=Or("forwardChannelMaxRetries",2,o),this.wa=Or("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Gh(o&&o.concurrentRequestLimit),this.Da=new Z_,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ld.prototype,n.la=8,n.G=1,n.connect=function(o,u,h,f){Re(0),this.W=o,this.H=u||{},h&&f!==void 0&&(this.H.OSID=h,this.H.OAID=f),this.F=this.X,this.I=Ed(this,null,this.W),qi(this)};function ca(o){if(hd(o),o.G==3){var u=o.U++,h=_t(o.I);if(te(h,"SID",o.K),te(h,"RID",u),te(h,"TYPE","terminate"),Fr(o,h),u=new Mt(o,o.j,u),u.L=2,u.v=Bi(_t(h)),h=!1,c.navigator&&c.navigator.sendBeacon)try{h=c.navigator.sendBeacon(u.v.toString(),"")}catch{}!h&&c.Image&&(new Image().src=u.v,h=!0),h||(u.g=vd(u.j,null),u.g.ea(u.v)),u.F=Date.now(),Mi(u)}yd(o)}function ji(o){o.g&&(la(o),o.g.cancel(),o.g=null)}function hd(o){ji(o),o.u&&(c.clearTimeout(o.u),o.u=null),Gi(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function qi(o){if(!Wh(o.h)&&!o.s){o.s=!0;var u=o.Ga;_r||Th(),yr||(_r(),yr=!0),$o.add(u,o),o.B=0}}function iy(o,u){return Hh(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=u.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Ar(y(o.Ga,o,u),_d(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let A=new Mt(this,this.j,o),S=this.o;if(this.S&&(S?(S=m(S),I(S,this.S)):S=this.S),this.m!==null||this.O||(A.H=S,S=null),this.P)e:{for(var u=0,h=0;h<this.i.length;h++){t:{var f=this.i[h];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(u+=f,4096<u){u=h;break e}if(u===4096||h===this.i.length-1){u=h+1;break e}}u=1e3}else u=1e3;u=fd(this,A,u),h=_t(this.I),te(h,"RID",o),te(h,"CVER",22),this.D&&te(h,"X-HTTP-Session-Id",this.D),Fr(this,h),S&&(this.O?u="headers="+encodeURIComponent(String(id(S)))+"&"+u:this.m&&aa(h,this.m,S)),oa(this.h,A),this.Ua&&te(h,"TYPE","init"),this.P?(te(h,"$req",u),te(h,"SID","null"),A.T=!0,na(A,h,null)):na(A,h,u),this.G=2}}else this.G==3&&(o?dd(this,o):this.i.length==0||Wh(this.h)||dd(this))};function dd(o,u){var h;u?h=u.l:h=o.U++;let f=_t(o.I);te(f,"SID",o.K),te(f,"RID",h),te(f,"AID",o.T),Fr(o,f),o.m&&o.o&&aa(f,o.m,o.o),h=new Mt(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),u&&(o.i=u.D.concat(o.i)),u=fd(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),oa(o.h,h),na(h,f,u)}function Fr(o,u){o.H&&J(o.H,function(h,f){te(u,f,h)}),o.l&&Yh({},function(h,f){te(u,f,h)})}function fd(o,u,h){h=Math.min(o.i.length,h);var f=o.l?y(o.l.Na,o.l,o):null;e:{var A=o.i;let S=-1;for(;;){let N=["count="+h];S==-1?0<h?(S=A[0].g,N.push("ofs="+S)):S=0:N.push("ofs="+S);let Z=!0;for(let ye=0;ye<h;ye++){let K=A[ye].g,we=A[ye].map;if(K-=S,0>K)S=Math.max(0,A[ye].g-100),Z=!1;else try{ey(we,N,"req"+K+"_")}catch{f&&f(we)}}if(Z){f=N.join("&");break e}}}return o=o.i.splice(0,h),u.D=o,f}function pd(o){if(!o.g&&!o.u){o.Y=1;var u=o.Fa;_r||Th(),yr||(_r(),yr=!0),$o.add(u,o),o.v=0}}function ua(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Ar(y(o.Fa,o),_d(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,gd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Ar(y(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Re(10),ji(this),gd(this))};function la(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function gd(o){o.g=new Mt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var u=_t(o.qa);te(u,"RID","rpc"),te(u,"SID",o.K),te(u,"AID",o.T),te(u,"CI",o.F?"0":"1"),!o.F&&o.ja&&te(u,"TO",o.ja),te(u,"TYPE","xmlhttp"),Fr(o,u),o.m&&o.o&&aa(u,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=Bi(_t(u)),h.m=null,h.P=!0,zh(h,o)}n.Za=function(){this.C!=null&&(this.C=null,ji(this),ua(this),Re(19))};function Gi(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function md(o,u){var h=null;if(o.g==u){Gi(o),la(o),o.g=null;var f=2}else if(sa(o.h,u))h=u.D,Kh(o.h,u),f=1;else return;if(o.G!=0){if(u.o)if(f==1){h=u.m?u.m.length:0,u=Date.now()-u.F;var A=o.B;f=Fi(),Ce(f,new Vh(f,h)),qi(o)}else pd(o);else if(A=u.s,A==3||A==0&&0<u.X||!(f==1&&iy(o,u)||f==2&&ua(o)))switch(h&&0<h.length&&(u=o.h,u.i=u.i.concat(h)),A){case 1:sn(o,5);break;case 4:sn(o,10);break;case 3:sn(o,6);break;default:sn(o,2)}}}function _d(o,u){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*u}function sn(o,u){if(o.j.info("Error code "+u),u==2){var h=y(o.fb,o),f=o.Xa;let A=!f;f=new rn(f||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Vi(f,"https"),Bi(f),A?J_(f.toString(),h):X_(f.toString(),h)}else Re(2);o.G=0,o.l&&o.l.sa(u),yd(o),hd(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Re(2)):(this.j.info("Failed to ping google.com"),Re(1))};function yd(o){if(o.G=0,o.ka=[],o.l){let u=Qh(o.h);(u.length!=0||o.i.length!=0)&&(k(o.ka,u),k(o.ka,o.i),o.h.i.length=0,O(o.i),o.i.length=0),o.l.ra()}}function Ed(o,u,h){var f=h instanceof rn?_t(h):new rn(h);if(f.g!="")u&&(f.g=u+"."+f.g),Ui(f,f.s);else{var A=c.location;f=A.protocol,u=u?u+"."+A.hostname:A.hostname,A=+A.port;var S=new rn(null);f&&Vi(S,f),u&&(S.g=u),A&&Ui(S,A),h&&(S.l=h),f=S}return h=o.D,u=o.ya,h&&u&&te(f,h,u),te(f,"VER",o.la),Fr(o,f),f}function vd(o,u,h){if(u&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Ca&&!o.pa?new ie(new Pr({eb:h})):new ie(o.pa),u.Ha(o.J),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Id(){}n=Id.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Wi(){}Wi.prototype.g=function(o,u){return new xe(o,u)};function xe(o,u){Ie.call(this),this.g=new ld(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(o?o["X-WebChannel-Client-Profile"]=u.va:o={"X-WebChannel-Client-Profile":u.va}),this.g.S=o,(o=u&&u.Sb)&&!M(o)&&(this.g.m=o),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!M(u)&&(this.g.D=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new Pn(this)}R(xe,Ie),xe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xe.prototype.close=function(){ca(this.g)},xe.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=Yo(o),o=h);u.i.push(new $_(u.Ya++,o)),u.G==3&&qi(u)},xe.prototype.N=function(){this.g.l=null,delete this.j,ca(this.g),delete this.g,xe.aa.N.call(this)};function wd(o){Xo.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(let h in u){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}R(wd,Xo);function Td(){Zo.call(this),this.status=1}R(Td,Zo);function Pn(o){this.g=o}R(Pn,Id),Pn.prototype.ua=function(){Ce(this.g,"a")},Pn.prototype.ta=function(o){Ce(this.g,new wd(o))},Pn.prototype.sa=function(o){Ce(this.g,new Td)},Pn.prototype.ra=function(){Ce(this.g,"b")},Wi.prototype.createWebChannel=Wi.prototype.g,xe.prototype.send=xe.prototype.o,xe.prototype.open=xe.prototype.m,xe.prototype.close=xe.prototype.close,iu=Rt.createWebChannelTransport=function(){return new Wi},ru=Rt.getStatEventTarget=function(){return Fi()},nu=Rt.Event=tn,Bs=Rt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Li.NO_ERROR=0,Li.TIMEOUT=8,Li.HTTP_ERROR=6,ci=Rt.ErrorCode=Li,Uh.COMPLETE="complete",tu=Rt.EventType=Uh,Fh.EventType=wr,wr.OPEN="a",wr.CLOSE="b",wr.ERROR="c",wr.MESSAGE="d",Ie.prototype.listen=Ie.prototype.K,jn=Rt.WebChannel=Fh,y0=Rt.FetchXmlHttpFactory=Pr,ie.prototype.listenOnce=ie.prototype.L,ie.prototype.getLastError=ie.prototype.Ka,ie.prototype.getLastErrorCode=ie.prototype.Ba,ie.prototype.getStatus=ie.prototype.Z,ie.prototype.getResponseJson=ie.prototype.Oa,ie.prototype.getResponseText=ie.prototype.oa,ie.prototype.send=ie.prototype.ea,ie.prototype.setWithCredentials=ie.prototype.Ha,eu=Rt.XhrIo=ie}).apply(typeof Us<"u"?Us:typeof self<"u"?self:typeof window<"u"?window:{});var Kp="@firebase/firestore",Qp="4.7.14";var me=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};me.UNAUTHENTICATED=new me(null),me.GOOGLE_CREDENTIALS=new me("google-credentials-uid"),me.FIRST_PARTY=new me("first-party-uid"),me.MOCK_USER=new me("mock-user");var dr="11.7.3";var En=new ot("@firebase/firestore");function qn(){return En.logLevel}function F(n,...e){if(En.logLevel<=G.DEBUG){let t=e.map(Ql);En.debug(`Firestore (${dr}): ${n}`,...t)}}function Pt(n,...e){if(En.logLevel<=G.ERROR){let t=e.map(Ql);En.error(`Firestore (${dr}): ${n}`,...t)}}function Jn(n,...e){if(En.logLevel<=G.WARN){let t=e.map(Ql);En.warn(`Firestore (${dr}): ${n}`,...t)}}function Ql(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function V(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Bg(n,r,t)}function Bg(n,e,t){let r=`FIRESTORE (${dr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Pt(r),new Error(r)}function Y(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||Bg(e,i,r)}function B(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends Ve{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ze=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Hs=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},uu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(me.UNAUTHENTICATED))}shutdown(){}},lu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},hu=class{constructor(e){this.t=e,this.currentUser=me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Y(this.o===void 0,42304);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new Ze;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ze,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(()=>_(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},c=l=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ze)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string",31837,{l:r}),new Hs(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string",2055,{h:e}),new me(e)}},du=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=me.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},fu=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new du(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(me.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Ks=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},pu=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Le(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Y(this.o===void 0,3512);let r=s=>{s.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.m;return this.m=s.token,F("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Ks(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Y(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Ks(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function E0(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function $g(){return new TextEncoder}var Qs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=E0(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function q(n,e){return n<e?-1:n>e?1:0}function gu(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return q(r,i);{let s=$g(),a=v0(s.encode(Yp(n,t)),s.encode(Yp(e,t)));return a!==0?a:q(r,i)}}t+=r>65535?2:1}return q(n.length,e.length)}function Yp(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function v0(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return q(n[t],e[t]);return q(n.length,e.length)}function Xn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Jp=-62135596800,Xp=1e6,Ee=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Xp);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Jp)throw new L(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Xp}_compareTo(e){return this.seconds===e.seconds?q(this.nanoseconds,e.nanoseconds):q(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-Jp;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var z=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Ee(0,0))}static max(){return new n(new Ee(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Zp="__name__",Ys=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&V(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&V(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return q(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):gu(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ct.fromString(e.substring(4,e.length-2))}},re=class n extends Ys{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new L(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},I0=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Be=class n extends Ys{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return I0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Zp}static keyField(){return new n([Zp])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new L(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new L(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new L(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(r+=c,i++):(s(),i++)}if(s(),a)throw new L(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var x=class n{constructor(e){this.path=e}static fromPath(e){return new n(re.fromString(e))}static fromName(e){return new n(re.fromString(e).popFirst(5))}static empty(){return new n(re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&re.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return re.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new re(e.slice()))}};var pi=-1,mu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};mu.UNKNOWN_ID=-1;function w0(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=z.fromTimestamp(r===1e9?new Ee(t+1,0):new Ee(t,r));return new vn(i,x.empty(),e)}function T0(n){return new vn(n.readTime,n.key,pi)}var vn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(z.min(),x.empty(),pi)}static max(){return new n(z.max(),x.empty(),pi)}};function A0(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=x.comparator(n.documentKey,e.documentKey),t!==0?t:q(n.largestBatchId,e.largestBatchId))}var D0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",_u=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function fr(n){return _(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==D0)throw n;F("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&V(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),c=0;for(let l=0;l<s;l++){let d=l;t(e[d]).next(p=>{a[d]=p,++c,c===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function b0(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function pr(n){return n.name==="IndexedDbTransactionError"}var Yl=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>r.writeSequenceNumber(i))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ce&&this.ce(t),t}}n.le=-1;return n})(),Jl=-1;function ko(n){return n==null}function gi(n){return n===0&&1/n==-1/0}function S0(n){return typeof n=="number"&&Number.isInteger(n)&&!gi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var zg="";function C0(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=eg(e)),e=R0(n.get(t),e);return eg(e)}function R0(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case zg:t+="";break;default:t+=s}}return t}function eg(n){return n+zg+""}var P0="remoteDocuments",jg="owner";var qg="mutationQueues";var Gg="mutations";var Wg="documentMutations",k0="remoteDocumentsV14";var Hg="remoteDocumentGlobal";var Kg="targets";var Qg="targetDocuments";var Yg="targetGlobal",Jg="collectionParents";var Xg="clientMetadata";var Zg="bundles";var em="namedQueries";var N0="indexConfiguration";var O0="indexState";var F0="indexEntries";var tm="documentOverlays";var L0="globals";var x0=[qg,Gg,Wg,P0,Kg,jg,Yg,Qg,Xg,Hg,Jg,Zg,em],YC=[...x0,tm],M0=[qg,Gg,Wg,k0,Kg,jg,Yg,Qg,Xg,Hg,Jg,Zg,em,tm],V0=M0,U0=[...V0,N0,O0,F0];var JC=[...U0,L0];function tg(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function en(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function nm(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ce=class n{constructor(e,t){this.comparator=e,this.root=t||lt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,lt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,lt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kn(this.root,e,this.comparator,!0)}},Kn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},lt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw V(43730,{key:this.key,value:this.value});if(this.right.isRed())throw V(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw V(27949);return e+(this.isRed()?0:1)}};lt.EMPTY=null,lt.RED=!0,lt.BLACK=!1;lt.EMPTY=new class{constructor(){this.size=0}get key(){throw V(57766)}get value(){throw V(16141)}get color(){throw V(16727)}get left(){throw V(29726)}get right(){throw V(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new lt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var _e=class n{constructor(e){this.comparator=e,this.data=new ce(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Js(this.data.getIterator())}getIteratorFrom(e){return new Js(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Js=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var We=class n{constructor(e){this.fields=e,e.sort(Be.comparator)}static empty(){return new n([])}unionWith(e){let t=new _e(Be.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Xs=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Se=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Xs("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return q(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Se.EMPTY_BYTE_STRING=new Se("");var B0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kt(n){if(Y(!!n,39018),typeof n=="string"){let e=0,t=B0.exec(n);if(Y(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ne(n.seconds),nanos:ne(n.nanos)}}function ne(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Nt(n){return typeof n=="string"?Se.fromBase64String(n):Se.fromUint8Array(n)}var rm="server_timestamp",im="__type__",sm="__previous_value__",om="__local_write_time__";function Xl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[im])===null||t===void 0?void 0:t.stringValue)===rm}function No(n){let e=n.mapValue.fields[sm];return Xl(e)?No(e):e}function mi(n){let e=kt(n.mapValue.fields[om].timestampValue);return new Ee(e.seconds,e.nanos)}var yu=class{constructor(e,t,r,i,s,a,c,l,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=p}},Zs="(default)",eo=class n{constructor(e,t){this.projectId=e,this.database=t||Zs}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Zs}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Zl="__type__",am="__max__",$s={mapValue:{fields:{__type__:{stringValue:am}}}},eh="__vector__",Zn="value";function Jt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Xl(n)?4:um(n)?9007199254740991:cm(n)?10:11:V(28295,{value:n})}function pt(n,e){if(n===e)return!0;let t=Jt(n);if(t!==Jt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return mi(n).isEqual(mi(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=kt(i.timestampValue),c=kt(s.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Nt(i.bytesValue).isEqual(Nt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return ne(i.geoPointValue.latitude)===ne(s.geoPointValue.latitude)&&ne(i.geoPointValue.longitude)===ne(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ne(i.integerValue)===ne(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=ne(i.doubleValue),c=ne(s.doubleValue);return a===c?gi(a)===gi(c):isNaN(a)&&isNaN(c)}return!1}(n,e);case 9:return Xn(n.arrayValue.values||[],e.arrayValue.values||[],pt);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},c=s.mapValue.fields||{};if(tg(a)!==tg(c))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!pt(a[l],c[l])))return!1;return!0}(n,e);default:return V(52216,{left:n})}}function _i(n,e){return(n.values||[]).find(t=>pt(t,e))!==void 0}function er(n,e){if(n===e)return 0;let t=Jt(n),r=Jt(e);if(t!==r)return q(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return q(n.booleanValue,e.booleanValue);case 2:return function(s,a){let c=ne(s.integerValue||s.doubleValue),l=ne(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(n,e);case 3:return ng(n.timestampValue,e.timestampValue);case 4:return ng(mi(n),mi(e));case 5:return gu(n.stringValue,e.stringValue);case 6:return function(s,a){let c=Nt(s),l=Nt(a);return c.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let c=s.split("/"),l=a.split("/");for(let d=0;d<c.length&&d<l.length;d++){let p=q(c[d],l[d]);if(p!==0)return p}return q(c.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let c=q(ne(s.latitude),ne(a.latitude));return c!==0?c:q(ne(s.longitude),ne(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return rg(n.arrayValue,e.arrayValue);case 10:return function(s,a){var c,l,d,p;let g=s.fields||{},y=a.fields||{},b=(c=g[Zn])===null||c===void 0?void 0:c.arrayValue,R=(l=y[Zn])===null||l===void 0?void 0:l.arrayValue,O=q(((d=b?.values)===null||d===void 0?void 0:d.length)||0,((p=R?.values)===null||p===void 0?void 0:p.length)||0);return O!==0?O:rg(b,R)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===$s.mapValue&&a===$s.mapValue)return 0;if(s===$s.mapValue)return 1;if(a===$s.mapValue)return-1;let c=s.fields||{},l=Object.keys(c),d=a.fields||{},p=Object.keys(d);l.sort(),p.sort();for(let g=0;g<l.length&&g<p.length;++g){let y=gu(l[g],p[g]);if(y!==0)return y;let b=er(c[l[g]],d[p[g]]);if(b!==0)return b}return q(l.length,p.length)}(n.mapValue,e.mapValue);default:throw V(23264,{Pe:t})}}function ng(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return q(n,e);let t=kt(n),r=kt(e),i=q(t.seconds,r.seconds);return i!==0?i:q(t.nanos,r.nanos)}function rg(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=er(t[i],r[i]);if(s)return s}return q(t.length,r.length)}function tr(n){return Eu(n)}function Eu(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=kt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Nt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return x.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Eu(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${Eu(t.fields[a])}`;return i+"}"}(n.mapValue):V(61005,{value:n})}function qs(n){switch(Jt(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=No(n);return e?16+qs(e):16;case 5:return 2*n.stringValue.length;case 6:return Nt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+qs(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return en(r.fields,(s,a)=>{i+=s.length+qs(a)}),i}(n.mapValue);default:throw V(13486,{value:n})}}function ig(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function vu(n){return!!n&&"integerValue"in n}function th(n){return!!n&&"arrayValue"in n}function sg(n){return!!n&&"nullValue"in n}function og(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Gs(n){return!!n&&"mapValue"in n}function cm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Zl])===null||t===void 0?void 0:t.stringValue)===eh}function li(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return en(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=li(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=li(n.arrayValue.values[t]);return e}return Object.assign({},n)}function um(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===am}var ZC={mapValue:{fields:{[Zl]:{stringValue:eh},[Zn]:{arrayValue:{}}}}};var Ue=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Gs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=li(t)}setAll(e){let t=Be.emptyPath(),r={},i=[];e.forEach((a,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=c.popLast()}a?r[c.lastSegment()]=li(a):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Gs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return pt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Gs(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){en(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(li(this.value))}};function lm(n){let e=[];return en(n.fields,(t,r)=>{let i=new Be([t]);if(Gs(r)){let s=lm(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new We(e)}var et=class n{constructor(e,t,r,i,s,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=c}static newInvalidDocument(e){return new n(e,0,z.min(),z.min(),z.min(),Ue.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,z.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,z.min(),z.min(),Ue.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,z.min(),z.min(),Ue.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ue.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var nr=class{constructor(e,t){this.position=e,this.inclusive=t}};function ag(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=x.comparator(x.fromName(a.referenceValue),t.key):r=er(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function cg(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!pt(n.position[t],e.position[t]))return!1;return!0}var rr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function $0(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var to=class{},fe=class n extends to{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new wu(e,t,r):t==="array-contains"?new Du(e,r):t==="in"?new bu(e,r):t==="not-in"?new Su(e,r):t==="array-contains-any"?new Cu(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Tu(e,r):new Au(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(er(t,this.value)):t!==null&&Jt(this.value)===Jt(t)&&this.matchesComparison(er(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return V(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},tt=class n extends to{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new n(e,t)}matches(e){return hm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}};function hm(n){return n.op==="and"}function dm(n){return z0(n)&&hm(n)}function z0(n){for(let e of n.filters)if(e instanceof tt)return!1;return!0}function Iu(n){if(n instanceof fe)return n.field.canonicalString()+n.op.toString()+tr(n.value);if(dm(n))return n.filters.map(e=>Iu(e)).join(",");{let e=n.filters.map(t=>Iu(t)).join(",");return`${n.op}(${e})`}}function fm(n,e){return n instanceof fe?function(r,i){return i instanceof fe&&r.op===i.op&&r.field.isEqual(i.field)&&pt(r.value,i.value)}(n,e):n instanceof tt?function(r,i){return i instanceof tt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,c)=>s&&fm(a,i.filters[c]),!0):!1}(n,e):void V(19439)}function pm(n){return n instanceof fe?function(t){return`${t.field.canonicalString()} ${t.op} ${tr(t.value)}`}(n):n instanceof tt?function(t){return t.op.toString()+" {"+t.getFilters().map(pm).join(" ,")+"}"}(n):"Filter"}var wu=class extends fe{constructor(e,t,r){super(e,t,r),this.key=x.fromName(r.referenceValue)}matches(e){let t=x.comparator(e.key,this.key);return this.matchesComparison(t)}},Tu=class extends fe{constructor(e,t){super(e,"in",t),this.keys=gm("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Au=class extends fe{constructor(e,t){super(e,"not-in",t),this.keys=gm("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function gm(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>x.fromName(r.referenceValue))}var Du=class extends fe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return th(t)&&_i(t.arrayValue,this.value)}},bu=class extends fe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&_i(this.value.arrayValue,t)}},Su=class extends fe{constructor(e,t){super(e,"not-in",t)}matches(e){if(_i(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!_i(this.value.arrayValue,t)}},Cu=class extends fe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!th(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>_i(this.value.arrayValue,r))}};var Ru=class{constructor(e,t=null,r=[],i=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=c,this.Ie=null}};function ug(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Ru(n,e,t,r,i,s,a)}function nh(n){let e=B(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Iu(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ko(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>tr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>tr(r)).join(",")),e.Ie=t}return e.Ie}function rh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!$0(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!fm(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!cg(n.startAt,e.startAt)&&cg(n.endAt,e.endAt)}function Pu(n){return x.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var In=class{constructor(e,t=null,r=[],i=[],s=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=l,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}};function j0(n,e,t,r,i,s,a,c){return new In(n,e,t,r,i,s,a,c)}function ih(n){return new In(n)}function lg(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function mm(n){return n.collectionGroup!==null}function hi(n){let e=B(n);if(e.Ee===null){e.Ee=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ee.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new _e(Be.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new rr(s,r))}),t.has(Be.keyField().canonicalString())||e.Ee.push(new rr(Be.keyField(),r))}return e.Ee}function ht(n){let e=B(n);return e.de||(e.de=q0(e,hi(n))),e.de}function q0(n,e){if(n.limitType==="F")return ug(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new rr(i.field,s)});let t=n.endAt?new nr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new nr(n.startAt.position,n.startAt.inclusive):null;return ug(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ku(n,e){let t=n.filters.concat([e]);return new In(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Nu(n,e,t){return new In(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Oo(n,e){return rh(ht(n),ht(e))&&n.limitType===e.limitType}function _m(n){return`${nh(ht(n))}|lt:${n.limitType}`}function Gn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>pm(i)).join(", ")}]`),ko(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>tr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>tr(i)).join(",")),`Target(${r})`}(ht(n))}; limitType=${n.limitType})`}function Fo(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):x.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of hi(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,c,l){let d=ag(a,c,l);return a.inclusive?d<=0:d<0}(r.startAt,hi(r),i)||r.endAt&&!function(a,c,l){let d=ag(a,c,l);return a.inclusive?d>=0:d>0}(r.endAt,hi(r),i))}(n,e)}function G0(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ym(n){return(e,t)=>{let r=!1;for(let i of hi(n)){let s=W0(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function W0(n,e,t){let r=n.field.isKeyField()?x.comparator(e.key,t.key):function(s,a,c){let l=a.data.field(s),d=c.data.field(s);return l!==null&&d!==null?er(l,d):V(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return V(19790,{direction:n.dir})}}var Ot=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){en(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return nm(this.inner)}size(){return this.innerSize}};var H0=new ce(x.comparator);function Ft(){return H0}var Em=new ce(x.comparator);function ui(...n){let e=Em;for(let t of n)e=e.insert(t.key,t);return e}function vm(n){let e=Em;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function mn(){return di()}function Im(){return di()}function di(){return new Ot(n=>n.toString(),(n,e)=>n.isEqual(e))}var K0=new ce(x.comparator),Q0=new _e(x.comparator);function W(...n){let e=Q0;for(let t of n)e=e.add(t);return e}var Y0=new _e(q);function J0(){return Y0}function sh(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function wm(n){return{integerValue:""+n}}function X0(n,e){return S0(e)?wm(e):sh(n,e)}var ir=class{constructor(){this._=void 0}};function Z0(n,e,t){return n instanceof wn?function(i,s){let a={fields:{[im]:{stringValue:rm},[om]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Xl(s)&&(s=No(s)),s&&(a.fields[sm]=s),{mapValue:a}}(t,e):n instanceof Tn?Am(n,e):n instanceof An?Dm(n,e):function(i,s){let a=Tm(i,s),c=hg(a)+hg(i.Re);return vu(a)&&vu(i.Re)?wm(c):sh(i.serializer,c)}(n,e)}function eT(n,e,t){return n instanceof Tn?Am(n,e):n instanceof An?Dm(n,e):t}function Tm(n,e){return n instanceof sr?function(r){return vu(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var wn=class extends ir{},Tn=class extends ir{constructor(e){super(),this.elements=e}};function Am(n,e){let t=bm(e);for(let r of n.elements)t.some(i=>pt(i,r))||t.push(r);return{arrayValue:{values:t}}}var An=class extends ir{constructor(e){super(),this.elements=e}};function Dm(n,e){let t=bm(e);for(let r of n.elements)t=t.filter(i=>!pt(i,r));return{arrayValue:{values:t}}}var sr=class extends ir{constructor(e,t){super(),this.serializer=e,this.Re=t}};function hg(n){return ne(n.integerValue||n.doubleValue)}function bm(n){return th(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Ou=class{constructor(e,t){this.field=e,this.transform=t}};function tT(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Tn&&i instanceof Tn||r instanceof An&&i instanceof An?Xn(r.elements,i.elements,pt):r instanceof sr&&i instanceof sr?pt(r.Re,i.Re):r instanceof wn&&i instanceof wn}(n.transform,e.transform)}var Fu=class{constructor(e,t){this.version=e,this.transformResults=t}},dt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ws(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var or=class{};function Sm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new yi(n.key,dt.none()):new Dn(n.key,n.data,dt.none());{let t=n.data,r=Ue.empty(),i=new _e(Be.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new gt(n.key,r,new We(i.toArray()),dt.none())}}function nT(n,e,t){n instanceof Dn?function(i,s,a){let c=i.value.clone(),l=fg(i.fieldTransforms,s,a.transformResults);c.setAll(l),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):n instanceof gt?function(i,s,a){if(!Ws(i.precondition,s))return void s.convertToUnknownDocument(a.version);let c=fg(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Cm(i)),l.setAll(c),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function fi(n,e,t,r){return n instanceof Dn?function(s,a,c,l){if(!Ws(s.precondition,a))return c;let d=s.value.clone(),p=pg(s.fieldTransforms,l,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof gt?function(s,a,c,l){if(!Ws(s.precondition,a))return c;let d=pg(s.fieldTransforms,l,a),p=a.data;return p.setAll(Cm(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,e,t,r):function(s,a,c){return Ws(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(n,e,t)}function rT(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Tm(r.transform,i||null);s!=null&&(t===null&&(t=Ue.empty()),t.set(r.field,s))}return t||null}function dg(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Xn(r,i,(s,a)=>tT(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Dn=class extends or{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},gt=class extends or{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Cm(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function fg(n,e,t){let r=new Map;Y(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,c=e.data.field(s.field);r.set(s.field,eT(a,c,t[i]))}return r}function pg(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,Z0(s,a,e))}return r}var yi=class extends or{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Lu=class extends or{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var xu=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&nT(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=fi(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=fi(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Im();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,c=this.applyToLocalView(a,s.mutatedFields);c=t.has(i.key)?null:c;let l=Sm(a,c);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(z.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),W())}isEqual(e){return this.batchId===e.batchId&&Xn(this.mutations,e.mutations,(t,r)=>dg(t,r))&&Xn(this.baseMutations,e.baseMutations,(t,r)=>dg(t,r))}},Mu=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Y(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let i=function(){return K0}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var Vu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Uu=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var he,H;function iT(n){switch(n){case C.OK:return V(64938);case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0;default:return V(15467,{code:n})}}function Rm(n){if(n===void 0)return Pt("GRPC error has no .code"),C.UNKNOWN;switch(n){case he.OK:return C.OK;case he.CANCELLED:return C.CANCELLED;case he.UNKNOWN:return C.UNKNOWN;case he.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case he.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case he.INTERNAL:return C.INTERNAL;case he.UNAVAILABLE:return C.UNAVAILABLE;case he.UNAUTHENTICATED:return C.UNAUTHENTICATED;case he.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case he.NOT_FOUND:return C.NOT_FOUND;case he.ALREADY_EXISTS:return C.ALREADY_EXISTS;case he.PERMISSION_DENIED:return C.PERMISSION_DENIED;case he.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case he.ABORTED:return C.ABORTED;case he.OUT_OF_RANGE:return C.OUT_OF_RANGE;case he.UNIMPLEMENTED:return C.UNIMPLEMENTED;case he.DATA_LOSS:return C.DATA_LOSS;default:return V(39323,{code:n})}}(H=he||(he={}))[H.OK=0]="OK",H[H.CANCELLED=1]="CANCELLED",H[H.UNKNOWN=2]="UNKNOWN",H[H.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",H[H.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",H[H.NOT_FOUND=5]="NOT_FOUND",H[H.ALREADY_EXISTS=6]="ALREADY_EXISTS",H[H.PERMISSION_DENIED=7]="PERMISSION_DENIED",H[H.UNAUTHENTICATED=16]="UNAUTHENTICATED",H[H.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",H[H.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",H[H.ABORTED=10]="ABORTED",H[H.OUT_OF_RANGE=11]="OUT_OF_RANGE",H[H.UNIMPLEMENTED=12]="UNIMPLEMENTED",H[H.INTERNAL=13]="INTERNAL",H[H.UNAVAILABLE=14]="UNAVAILABLE",H[H.DATA_LOSS=15]="DATA_LOSS";var gg=null;var sT=new Ct([4294967295,4294967295],0);function mg(n){let e=$g().encode(n),t=new Zc;return t.update(e),new Uint8Array(t.digest())}function _g(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ct([t,r],0),new Ct([i,s],0)]}var Bu=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new _n(`Invalid padding: ${t}`);if(r<0)throw new _n(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new _n(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new _n(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Ct.fromNumber(this.pe)}we(e,t,r){let i=e.add(t.multiply(Ct.fromNumber(r)));return i.compare(sT)===1&&(i=new Ct([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;let t=mg(e),[r,i]=_g(t);for(let s=0;s<this.hashCount;s++){let a=this.we(r,i,s);if(!this.be(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.pe===0)return;let t=mg(e),[r,i]=_g(t);for(let s=0;s<this.hashCount;s++){let a=this.we(r,i,s);this.Se(a)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},_n=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var no=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ei.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(z.min(),i,new ce(q),Ft(),W())}},Ei=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,W(),W(),W())}};var Qn=class{constructor(e,t,r,i){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=i}},ro=class{constructor(e,t){this.targetId=e,this.Ce=t}},io=class{constructor(e,t,r=Se.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},so=class{constructor(){this.Fe=0,this.Me=yg(),this.xe=Se.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=W(),t=W(),r=W();return this.Me.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:V(38017,{changeType:s})}}),new Ei(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=yg()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Y(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}},$u=class{constructor(e){this.ze=e,this.je=new Map,this.He=Ft(),this.Je=zs(),this.Ye=zs(),this.Ze=new ce(q)}Xe(e){for(let t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(let t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{let r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:V(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,i)=>{this.it(i)&&t(i)})}ot(e){let t=e.targetId,r=e.Ce.count,i=this._t(t);if(i){let s=i.target;if(Pu(s))if(r===0){let a=new x(s.path);this.tt(t,a,et.newNoDocument(a,z.min()))}else Y(r===1,20013,{expectedCount:r});else{let a=this.ut(t);if(a!==r){let c=this.ct(e),l=c?this.lt(c,e,a):1;if(l!==0){this.st(t);let d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,d)}gg?.ht(function(p,g,y,b,R){var O,k,j,M,$,Q;let pe={localCacheCount:p,existenceFilterCount:g.count,databaseId:y.database,projectId:y.projectId},J=g.unchangedNames;return J&&(pe.bloomFilter={applied:R===0,hashCount:(O=J?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:(M=(j=(k=J?.bits)===null||k===void 0?void 0:k.bitmap)===null||j===void 0?void 0:j.length)!==null&&M!==void 0?M:0,padding:(Q=($=J?.bits)===null||$===void 0?void 0:$.padding)!==null&&Q!==void 0?Q:0,mightContain:w=>{var m;return(m=b?.mightContain(w))!==null&&m!==void 0&&m}}),pe}(a,e.Ce,this.ze.Pt(),c,l))}}}}ct(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,c;try{a=Nt(r).toUint8Array()}catch(l){if(l instanceof Xs)return Jn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Bu(a,i,s)}catch(l){return Jn(l instanceof _n?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.pe===0?null:c}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){let r=this.ze.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.ze.Pt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.tt(t,s,null),i++)}),i}It(e){let t=new Map;this.je.forEach((s,a)=>{let c=this._t(a);if(c){if(s.current&&Pu(c.target)){let l=new x(c.target.path);this.Et(l).has(a)||this.dt(a,l)||this.tt(a,l,et.newNoDocument(l,e))}s.Le&&(t.set(a,s.qe()),s.Qe())}});let r=W();this.Ye.forEach((s,a)=>{let c=!0;a.forEachWhile(l=>{let d=this._t(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.He.forEach((s,a)=>a.setReadTime(e));let i=new no(e,t,this.Ze,this.He,r);return this.He=Ft(),this.Je=zs(),this.Ye=zs(),this.Ze=new ce(q),i}et(e,t){if(!this.it(e))return;let r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;let i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){let t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new so,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new _e(q),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new _e(q),this.Je=this.Je.insert(e,t)),t}it(e){let t=this._t(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}_t(e){let t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new so),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}};function zs(){return new ce(x.comparator)}function yg(){return new ce(x.comparator)}var oT={asc:"ASCENDING",desc:"DESCENDING"},aT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cT={and:"AND",or:"OR"},zu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function ju(n,e){return n.useProto3Json||ko(e)?e:{value:e}}function oo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Pm(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function uT(n,e){return oo(n,e.toTimestamp())}function ft(n){return Y(!!n,49232),z.fromTimestamp(function(t){let r=kt(t);return new Ee(r.seconds,r.nanos)}(n))}function oh(n,e){return qu(n,e).canonicalString()}function qu(n,e){let t=function(i){return new re(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function km(n){let e=re.fromString(n);return Y(xm(e),10190,{key:e.toString()}),e}function Gu(n,e){return oh(n.databaseId,e.path)}function su(n,e){let t=km(e);if(t.get(1)!==n.databaseId.projectId)throw new L(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new x(Om(t))}function Nm(n,e){return oh(n.databaseId,e)}function lT(n){let e=km(n);return e.length===4?re.emptyPath():Om(e)}function Wu(n){return new re(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Om(n){return Y(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Eg(n,e,t){return{name:Gu(n,e),fields:t.value.mapValue.fields}}function hT(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:V(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(Y(p===void 0||typeof p=="string",58123),Se.fromBase64String(p||"")):(Y(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Se.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){let p=d.code===void 0?C.UNKNOWN:Rm(d.code);return new L(p,d.message||"")}(a);t=new io(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=su(n,r.document.name),s=ft(r.document.updateTime),a=r.document.createTime?ft(r.document.createTime):z.min(),c=new Ue({mapValue:{fields:r.document.fields}}),l=et.newFoundDocument(i,s,a,c),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Qn(d,p,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=su(n,r.document),s=r.readTime?ft(r.readTime):z.min(),a=et.newNoDocument(i,s),c=r.removedTargetIds||[];t=new Qn([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=su(n,r.document),s=r.removedTargetIds||[];t=new Qn([],s,i,null)}else{if(!("filter"in e))return V(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new Uu(i,s),c=r.targetId;t=new ro(c,a)}}return t}function dT(n,e){let t;if(e instanceof Dn)t={update:Eg(n,e.key,e.value)};else if(e instanceof yi)t={delete:Gu(n,e.key)};else if(e instanceof gt)t={update:Eg(n,e.key,e.data),updateMask:IT(e.fieldMask)};else{if(!(e instanceof Lu))return V(16599,{ft:e.type});t={verify:Gu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let c=a.transform;if(c instanceof wn)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Tn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof An)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof sr)return{fieldPath:a.field.canonicalString(),increment:c.Re};throw V(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:uT(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:V(27497)}(n,e.precondition)),t}function fT(n,e){return n&&n.length>0?(Y(e!==void 0,14353),n.map(t=>function(i,s){let a=i.updateTime?ft(i.updateTime):ft(s);return a.isEqual(z.min())&&(a=ft(s)),new Fu(a,i.transformResults||[])}(t,e))):[]}function pT(n,e){return{documents:[Nm(n,e.path)]}}function gT(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Nm(n,i);let s=function(d){if(d.length!==0)return Lm(tt.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(p=>function(y){return{field:Wn(y.field),direction:yT(y.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let c=ju(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{gt:t,parent:i}}function mT(n){let e=lT(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Y(r===1,65062);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(g){let y=Fm(g);return y instanceof tt&&dm(y)?y.getFilters():[y]}(t.where));let a=[];t.orderBy&&(a=function(g){return g.map(y=>function(R){return new rr(Hn(R.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(y))}(t.orderBy));let c=null;t.limit&&(c=function(g){let y;return y=typeof g=="object"?g.value:g,ko(y)?null:y}(t.limit));let l=null;t.startAt&&(l=function(g){let y=!!g.before,b=g.values||[];return new nr(b,y)}(t.startAt));let d=null;return t.endAt&&(d=function(g){let y=!g.before,b=g.values||[];return new nr(b,y)}(t.endAt)),j0(e,i,a,s,c,"F",l,d)}function _T(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return V(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Fm(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Hn(t.unaryFilter.field);return fe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Hn(t.unaryFilter.field);return fe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Hn(t.unaryFilter.field);return fe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Hn(t.unaryFilter.field);return fe.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return V(61313);default:return V(60726)}}(n):n.fieldFilter!==void 0?function(t){return fe.create(Hn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return V(58110);default:return V(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return tt.create(t.compositeFilter.filters.map(r=>Fm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return V(1026)}}(t.compositeFilter.op))}(n):V(30097,{filter:n})}function yT(n){return oT[n]}function ET(n){return aT[n]}function vT(n){return cT[n]}function Wn(n){return{fieldPath:n.canonicalString()}}function Hn(n){return Be.fromServerFormat(n.fieldPath)}function Lm(n){return n instanceof fe?function(t){if(t.op==="=="){if(og(t.value))return{unaryFilter:{field:Wn(t.field),op:"IS_NAN"}};if(sg(t.value))return{unaryFilter:{field:Wn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(og(t.value))return{unaryFilter:{field:Wn(t.field),op:"IS_NOT_NAN"}};if(sg(t.value))return{unaryFilter:{field:Wn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wn(t.field),op:ET(t.op),value:t.value}}}(n):n instanceof tt?function(t){let r=t.getFilters().map(i=>Lm(i));return r.length===1?r[0]:{compositeFilter:{op:vT(t.op),filters:r}}}(n):V(54877,{filter:n})}function IT(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function xm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var vi=class n{constructor(e,t,r,i,s=z.min(),a=z.min(),c=Se.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Hu=class{constructor(e){this.wt=e}};function wT(n){let e=mT({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Nu(e,e.limit,"L"):e}var ao=class{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(ne(e.integerValue));else if("doubleValue"in e){let r=ne(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),gi(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=kt(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(Nt(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?um(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):cm(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):V(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){let r=e.fields||{};this.Mt(t,55);for(let i of Object.keys(r))this.Nt(i,t),this.Ct(r[i],t)}qt(e,t){var r,i;let s=e.fields||{};this.Mt(t,53);let a=Zn,c=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(ne(c)),this.Nt(a,t),this.Ct(s[a],t)}$t(e,t){let r=e.values||[];this.Mt(t,50);for(let i of r)this.Ct(i,t)}kt(e,t){this.Mt(t,37),x.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}};ao.Wt=new ao;var Ku=class{constructor(){this.yn=new Qu}addToCollectionParentIndex(e,t){return this.yn.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.yn.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(vn.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(vn.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},Qu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new _e(re.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new _e(re.comparator)).toArray()}};var eR=new Uint8Array(0);var vg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mm=41943040,Ge=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Ge.DEFAULT_COLLECTION_PERCENTILE=10,Ge.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ge.DEFAULT=new Ge(Mm,Ge.DEFAULT_COLLECTION_PERCENTILE,Ge.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ge.DISABLED=new Ge(-1,0,0);var Ii=class n{constructor(e){this.nr=e}next(){return this.nr+=2,this.nr}static rr(){return new n(0)}static ir(){return new n(-1)}};var Ig="LruGarbageCollector",TT=1048576;function wg([n,e],[t,r]){let i=q(n,t);return i===0?q(e,r):i}var Yu=class{constructor(e){this.cr=e,this.buffer=new _e(wg),this.lr=0}hr(){return++this.lr}Pr(e){let t=[e,this.hr()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();wg(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Ju=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Tr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ir(6e4)}stop(){this.Tr&&(this.Tr.cancel(),this.Tr=null)}get started(){return this.Tr!==null}Ir(e){F(Ig,`Garbage collection scheduled in ${e}ms`),this.Tr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>_(this,null,function*(){this.Tr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){pr(t)?F(Ig,"Ignoring IndexedDB error during garbage collection: ",t):yield fr(t)}yield this.Ir(3e5)}))}},Xu=class{constructor(e,t){this.Er=e,this.params=t}calculateTargetCount(e,t){return this.Er.dr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return P.resolve(Yl.le);let r=new Yu(t);return this.Er.forEachTarget(e,i=>r.Pr(i.sequenceNumber)).next(()=>this.Er.Ar(e,i=>r.Pr(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Er.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Er.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(F("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(vg)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(F("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),vg):this.Rr(e,t))}getCacheSize(e){return this.Er.getCacheSize(e)}Rr(e,t){let r,i,s,a,c,l,d,p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(F("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,a=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(r=g,c=Date.now(),this.removeTargets(e,r,t))).next(g=>(s=g,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(d=Date.now(),qn()<=G.DEBUG&&F("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${s} targets in `+(l-c)+`ms
	Removed ${g} documents in `+(d-l)+`ms
Total Duration: ${d-p}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g})))}};function AT(n,e){return new Xu(n,e)}var Zu=class{constructor(){this.changes=new Ot(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,et.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var el=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var tl=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&fi(r.mutation,i,We.empty(),Ee.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,W()).next(()=>r))}getLocalViewOfDocuments(e,t,r=W()){let i=mn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=ui();return s.forEach((c,l)=>{a=a.insert(c,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=mn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,W()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,c)=>{t.set(a,c)})})}computeViews(e,t,r,i){let s=Ft(),a=di(),c=function(){return di()}();return t.forEach((l,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof gt)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),fi(p.mutation,d,p.mutation.getFieldMask(),Ee.now())):a.set(d.key,We.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var g;return c.set(d,new el(p,(g=a.get(d))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,t){let r=di(),i=new ce((a,c)=>a-c),s=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let c of a)c.keys().forEach(l=>{let d=t.get(l);if(d===null)return;let p=r.get(l)||We.empty();p=c.applyToLocalView(d,p),r.set(l,p);let g=(i.get(c.batchId)||W()).add(l);i=i.insert(c.batchId,g)})}).next(()=>{let a=[],c=i.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),d=l.key,p=l.value,g=Im();p.forEach(y=>{if(!s.has(y)){let b=Sm(t.get(y),r.get(y));b!==null&&g.set(y,b),s=s.add(y)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,g))}return P.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return x.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(mn()),c=pi,l=s;return a.next(d=>P.forEach(d,(p,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),s.get(p)?P.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{l=l.insert(p,y)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,W())).next(p=>({batchId:c,changes:vm(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new x(t)).next(r=>{let i=ui();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=ui();return this.indexManager.getCollectionParents(e,s).next(c=>P.forEach(c,l=>{let d=function(g,y){return new In(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((g,y)=>{a=a.insert(g,y)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,et.newInvalidDocument(p)))});let c=ui();return a.forEach((l,d)=>{let p=s.get(l);p!==void 0&&fi(p.mutation,d,We.empty(),Ee.now()),Fo(t,d)&&(c=c.insert(l,d))}),c})}};var nl=class{constructor(e){this.serializer=e,this.Fr=new Map,this.Mr=new Map}getBundleMetadata(e,t){return P.resolve(this.Fr.get(t))}saveBundleMetadata(e,t){return this.Fr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ft(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Mr.get(t))}saveNamedQuery(e,t){return this.Mr.set(t.name,function(i){return{name:i.name,query:wT(i.bundledQuery),readTime:ft(i.readTime)}}(t)),P.resolve()}};var rl=class{constructor(){this.overlays=new ce(x.comparator),this.Or=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=mn();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Or.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Or.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=mn(),s=t.length+1,a=new x(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){let l=c.getNext().value,d=l.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ce((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=mn(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let c=mn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,p)=>c.set(d,p)),!(c.size()>=i)););return P.resolve(c)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Or.get(i.largestBatchId).delete(r.key);this.Or.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Vu(t,r));let s=this.Or.get(t);s===void 0&&(s=W(),this.Or.set(t,s)),this.Or.set(t,s.add(r.key))}};var il=class{constructor(){this.sessionToken=Se.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var wi=class{constructor(){this.Nr=new _e(de.Br),this.Lr=new _e(de.kr)}isEmpty(){return this.Nr.isEmpty()}addReference(e,t){let r=new de(e,t);this.Nr=this.Nr.add(r),this.Lr=this.Lr.add(r)}qr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Qr(new de(e,t))}$r(e,t){e.forEach(r=>this.removeReference(r,t))}Ur(e){let t=new x(new re([])),r=new de(t,e),i=new de(t,e+1),s=[];return this.Lr.forEachInRange([r,i],a=>{this.Qr(a),s.push(a.key)}),s}Kr(){this.Nr.forEach(e=>this.Qr(e))}Qr(e){this.Nr=this.Nr.delete(e),this.Lr=this.Lr.delete(e)}Wr(e){let t=new x(new re([])),r=new de(t,e),i=new de(t,e+1),s=W();return this.Lr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new de(e,0),r=this.Nr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},de=class{constructor(e,t){this.key=e,this.Gr=t}static Br(e,t){return x.comparator(e.key,t.key)||q(e.Gr,t.Gr)}static kr(e,t){return q(e.Gr,t.Gr)||x.comparator(e.key,t.key)}};var sl=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Jn=1,this.zr=new _e(de.Br)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Jn;this.Jn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new xu(s,t,r,i);this.mutationQueue.push(a);for(let c of i)this.zr=this.zr.add(new de(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.jr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Hr(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?Jl:this.Jn-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new de(t,0),i=new de(t,Number.POSITIVE_INFINITY),s=[];return this.zr.forEachInRange([r,i],a=>{let c=this.jr(a.Gr);s.push(c)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new _e(q);return t.forEach(i=>{let s=new de(i,0),a=new de(i,Number.POSITIVE_INFINITY);this.zr.forEachInRange([s,a],c=>{r=r.add(c.Gr)})}),P.resolve(this.Jr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;x.isDocumentKey(s)||(s=s.child(""));let a=new de(new x(s),0),c=new _e(q);return this.zr.forEachWhile(l=>{let d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(l.Gr)),!0)},a),P.resolve(this.Jr(c))}Jr(e){let t=[];return e.forEach(r=>{let i=this.jr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Y(this.Yr(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.zr;return P.forEach(t.mutations,i=>{let s=new de(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.zr=r})}Xn(e){}containsKey(e,t){let r=new de(t,0),i=this.zr.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Yr(e,t){return this.Hr(e)}Hr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}jr(e){let t=this.Hr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var ol=class{constructor(e){this.Zr=e,this.docs=function(){return new ce(x.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Zr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():et.newInvalidDocument(t))}getEntries(e,t){let r=Ft();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():et.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ft(),a=t.path,c=new x(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:d,value:{document:p}}=l.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||A0(T0(p),r)<=0||(i.has(p.key)||Fo(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){V(9500)}Xr(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new al(this)}getSize(e){return P.resolve(this.size)}},al=class extends Zu{constructor(e){super(),this.vr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.vr.addEntry(e,i)):this.vr.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.vr.getEntry(e,t)}getAllFromCache(e,t){return this.vr.getEntries(e,t)}};var cl=class{constructor(e){this.persistence=e,this.ei=new Ot(t=>nh(t),rh),this.lastRemoteSnapshotVersion=z.min(),this.highestTargetId=0,this.ti=0,this.ni=new wi,this.targetCount=0,this.ri=Ii.rr()}forEachTarget(e,t){return this.ei.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.ti)}allocateTargetId(e){return this.highestTargetId=this.ri.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ti&&(this.ti=t),P.resolve()}ar(e){this.ei.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ri=new Ii(t),this.highestTargetId=t),e.sequenceNumber>this.ti&&(this.ti=e.sequenceNumber)}addTargetData(e,t){return this.ar(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.ar(t),P.resolve()}removeTargetData(e,t){return this.ei.delete(t.target),this.ni.Ur(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ei.forEach((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.ei.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.ei.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.ni.qr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.ni.$r(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ni.Ur(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.ni.Wr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.ni.containsKey(t))}};var co=class{constructor(e,t){this.ii={},this.overlays={},this.si=new Yl(0),this.oi=!1,this.oi=!0,this._i=new il,this.referenceDelegate=e(this),this.ai=new cl(this),this.indexManager=new Ku,this.remoteDocumentCache=function(i){return new ol(i)}(r=>this.referenceDelegate.ui(r)),this.serializer=new Hu(t),this.ci=new nl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.oi=!1,Promise.resolve()}get started(){return this.oi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new rl,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ii[e.toKey()];return r||(r=new sl(t,this.referenceDelegate),this.ii[e.toKey()]=r),r}getGlobalsCache(){return this._i}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.ci}runTransaction(e,t,r){F("MemoryPersistence","Starting transaction:",e);let i=new ul(this.si.next());return this.referenceDelegate.li(),r(i).next(s=>this.referenceDelegate.hi(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Pi(e,t){return P.or(Object.values(this.ii).map(r=>()=>r.containsKey(e,t)))}},ul=class extends _u{constructor(e){super(),this.currentSequenceNumber=e}},ll=class n{constructor(e){this.persistence=e,this.Ti=new wi,this.Ii=null}static Ei(e){return new n(e)}get di(){if(this.Ii)return this.Ii;throw V(60996)}addReference(e,t,r){return this.Ti.addReference(r,t),this.di.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Ti.removeReference(r,t),this.di.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),P.resolve()}removeTarget(e,t){this.Ti.Ur(t.targetId).forEach(i=>this.di.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.di.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}li(){this.Ii=new Set}hi(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.di,r=>{let i=x.fromPath(r);return this.Ai(e,i).next(s=>{s||t.removeEntry(i,z.min())})}).next(()=>(this.Ii=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ai(e,t).next(r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())})}ui(e){return 0}Ai(e,t){return P.or([()=>P.resolve(this.Ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Pi(e,t)])}},uo=class n{constructor(e,t){this.persistence=e,this.Ri=new Ot(r=>C0(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=AT(this,t)}static Ei(e,t){return new n(e,t)}li(){}hi(e){return P.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.Vr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Vr(e){let t=0;return this.Ar(e,r=>{t++}).next(()=>t)}Ar(e,t){return P.forEach(this.Ri,(r,i)=>this.gr(e,r,i).next(s=>s?P.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Xr(e,a=>this.gr(e,a,t).next(c=>{c||(r++,s.removeEntry(a,z.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.Ri.set(t,e.currentSequenceNumber),P.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),P.resolve()}removeReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),P.resolve()}updateLimboDocument(e,t){return this.Ri.set(t,e.currentSequenceNumber),P.resolve()}ui(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=qs(e.data.value)),t}gr(e,t,r){return P.or([()=>this.persistence.Pi(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.Ri.get(t);return P.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var hl=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ls=r,this.hs=i}static Ps(e,t){let r=W(),i=W();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var dl=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var fl=class{constructor(){this.Ts=!1,this.Is=!1,this.Es=100,this.ds=function(){return wf()?8:b0(ge())>0?6:4}()}initialize(e,t){this.As=e,this.indexManager=t,this.Ts=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Rs(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Vs(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new dl;return this.fs(e,t,a).next(c=>{if(s.result=c,this.Is)return this.gs(e,t,a,c.size)})}).next(()=>s.result)}gs(e,t,r,i){return r.documentReadCount<this.Es?(qn()<=G.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",Gn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Es,"documents"),P.resolve()):(qn()<=G.DEBUG&&F("QueryEngine","Query:",Gn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(qn()<=G.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",Gn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ht(t))):P.resolve())}Rs(e,t){if(lg(t))return P.resolve(null);let r=ht(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Nu(t,null,"F"),r=ht(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=W(...s);return this.As.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(l=>{let d=this.ps(t,c);return this.ys(t,d,a,l.readTime)?this.Rs(e,Nu(t,null,"F")):this.ws(e,d,t,l)}))})))}Vs(e,t,r,i){return lg(t)||i.isEqual(z.min())?P.resolve(null):this.As.getDocuments(e,r).next(s=>{let a=this.ps(t,s);return this.ys(t,a,r,i)?P.resolve(null):(qn()<=G.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Gn(t)),this.ws(e,a,t,w0(i,pi)).next(c=>c))})}ps(e,t){let r=new _e(ym(e));return t.forEach((i,s)=>{Fo(e,s)&&(r=r.add(s))}),r}ys(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}fs(e,t,r){return qn()<=G.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",Gn(t)),this.As.getDocumentsMatchingQuery(e,t,vn.min(),r)}ws(e,t,r,i){return this.As.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var ah="LocalStore",DT=3e8,pl=class{constructor(e,t,r,i){this.persistence=e,this.bs=t,this.serializer=i,this.Ss=new ce(q),this.Ds=new Ot(s=>nh(s),rh),this.vs=new Map,this.Cs=e.getRemoteDocumentCache(),this.ai=e.getTargetCache(),this.ci=e.getBundleCache(),this.Fs(r)}Fs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tl(this.Cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Cs.setIndexManager(this.indexManager),this.bs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ss))}};function bT(n,e,t,r){return new pl(n,e,t,r)}function Vm(n,e){return _(this,null,function*(){let t=B(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Fs(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],c=[],l=W();for(let d of i){a.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}for(let d of s){c.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}return t.localDocuments.getDocuments(r,l).next(d=>({Ms:d,removedBatchIds:a,addedBatchIds:c}))})})})}function ST(n,e){let t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Cs.newChangeBuffer({trackRemovals:!0});return function(c,l,d,p){let g=d.batch,y=g.keys(),b=P.resolve();return y.forEach(R=>{b=b.next(()=>p.getEntry(l,R)).next(O=>{let k=d.docVersions.get(R);Y(k!==null,48541),O.version.compareTo(k)<0&&(g.applyToRemoteDocument(O,d),O.isValidDocument()&&(O.setReadTime(d.commitVersion),p.addEntry(O)))})}),b.next(()=>c.mutationQueue.removeMutationBatch(l,g))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let l=W();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(l=l.add(c.batch.mutations[d].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Um(n){let e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.ai.getLastRemoteSnapshotVersion(t))}function CT(n,e){let t=B(n),r=e.snapshotVersion,i=t.Ss;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.Cs.newChangeBuffer({trackRemovals:!0});i=t.Ss;let c=[];e.targetChanges.forEach((p,g)=>{let y=i.get(g);if(!y)return;c.push(t.ai.removeMatchingKeys(s,p.removedDocuments,g).next(()=>t.ai.addMatchingKeys(s,p.addedDocuments,g)));let b=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?b=b.withResumeToken(Se.EMPTY_BYTE_STRING,z.min()).withLastLimboFreeSnapshotVersion(z.min()):p.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(p.resumeToken,r)),i=i.insert(g,b),function(O,k,j){return O.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=DT?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0}(y,b,p)&&c.push(t.ai.updateTargetData(s,b))});let l=Ft(),d=W();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),c.push(RT(s,a,e.documentUpdates).next(p=>{l=p.xs,d=p.Os})),!r.isEqual(z.min())){let p=t.ai.getLastRemoteSnapshotVersion(s).next(g=>t.ai.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(p)}return P.waitFor(c).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(t.Ss=i,s))}function RT(n,e,t){let r=W(),i=W();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Ft();return t.forEach((c,l)=>{let d=s.get(c);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),l.isNoDocument()&&l.version.isEqual(z.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):F(ah,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",l.version)}),{xs:a,Os:i}})}function PT(n,e){let t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Jl),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function kT(n,e){let t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.ai.getTargetData(r,e).next(s=>s?(i=s,P.resolve(i)):t.ai.allocateTargetId(r).next(a=>(i=new vi(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.ai.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ss.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ss=t.Ss.insert(r.targetId,r),t.Ds.set(e,r.targetId)),r})}function gl(n,e,t){return _(this,null,function*(){let r=B(n),i=r.Ss.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!pr(a))throw a;F(ah,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ss=r.Ss.remove(e),r.Ds.delete(i.target)})}function Tg(n,e,t){let r=B(n),i=z.min(),s=W();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,d,p){let g=B(l),y=g.Ds.get(p);return y!==void 0?P.resolve(g.Ss.get(y)):g.ai.getTargetData(d,p)}(r,a,ht(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.ai.getMatchingKeysForTargetId(a,c.targetId).next(l=>{s=l})}).next(()=>r.bs.getDocumentsMatchingQuery(a,e,t?i:z.min(),t?s:W())).next(c=>(NT(r,G0(e),c),{documents:c,Ns:s})))}function NT(n,e,t){let r=n.vs.get(e)||z.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.vs.set(e,r)}var lo=class{constructor(){this.activeTargetIds=J0()}$s(e){this.activeTargetIds=this.activeTargetIds.add(e)}Us(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Qs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ml=class{constructor(){this.So=new lo,this.Do={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.So.$s(e),this.Do[e]||"not-current"}updateQueryState(e,t,r){this.Do[e]=t}removeLocalQueryTarget(e){this.So.Us(e)}isLocalQueryTarget(e){return this.So.activeTargetIds.has(e)}clearQueryState(e){delete this.Do[e]}getAllActiveQueryTargets(){return this.So.activeTargetIds}isActiveQueryTarget(e){return this.So.activeTargetIds.has(e)}start(){return this.So=new lo,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var _l=class{vo(e){}shutdown(){}};var Ag="ConnectivityMonitor",ho=class{constructor(){this.Co=()=>this.Fo(),this.Mo=()=>this.xo(),this.Oo=[],this.No()}vo(e){this.Oo.push(e)}shutdown(){window.removeEventListener("online",this.Co),window.removeEventListener("offline",this.Mo)}No(){window.addEventListener("online",this.Co),window.addEventListener("offline",this.Mo)}Fo(){F(Ag,"Network connectivity changed: AVAILABLE");for(let e of this.Oo)e(0)}xo(){F(Ag,"Network connectivity changed: UNAVAILABLE");for(let e of this.Oo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var js=null;function yl(){return js===null?js=function(){return 268435456+Math.round(2147483648*Math.random())}():js++,"0x"+js.toString(16)}var ou="RestConnection",OT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},El=class{get Bo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Lo=t+"://"+e.host,this.ko=`projects/${r}/databases/${i}`,this.qo=this.databaseId.database===Zs?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Qo(e,t,r,i,s){let a=yl(),c=this.$o(e,t.toUriEncodedString());F(ou,`Sending RPC '${e}' ${a}:`,c,r);let l={"google-cloud-resource-prefix":this.ko,"x-goog-request-params":this.qo};this.Uo(l,i,s);let{host:d}=new URL(c),p=an(d);return this.Ko(e,c,l,r,p).then(g=>(F(ou,`Received RPC '${e}' ${a}: `,g),g),g=>{throw Jn(ou,`RPC '${e}' ${a} failed with error: `,g,"url: ",c,"request:",r),g})}Wo(e,t,r,i,s,a){return this.Qo(e,t,r,i,s)}Uo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+dr}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}$o(e,t){let r=OT[e];return`${this.Lo}/v1/${t}:${r}`}terminate(){}};var vl=class{constructor(e){this.Go=e.Go,this.zo=e.zo}jo(e){this.Ho=e}Jo(e){this.Yo=e}Zo(e){this.Xo=e}onMessage(e){this.e_=e}close(){this.zo()}send(e){this.Go(e)}t_(){this.Ho()}n_(){this.Yo()}r_(e){this.Xo(e)}i_(e){this.e_(e)}};var be="WebChannelConnection",Il=class extends El{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ko(e,t,r,i,s){let a=yl();return new Promise((c,l)=>{let d=new eu;d.setWithCredentials(!0),d.listenOnce(tu.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case ci.NO_ERROR:let g=d.getResponseJson();F(be,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),c(g);break;case ci.TIMEOUT:F(be,`RPC '${e}' ${a} timed out`),l(new L(C.DEADLINE_EXCEEDED,"Request time out"));break;case ci.HTTP_ERROR:let y=d.getStatus();if(F(be,`RPC '${e}' ${a} failed with status:`,y,"response text:",d.getResponseText()),y>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);let R=b?.error;if(R&&R.status&&R.message){let O=function(j){let M=j.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(M)>=0?M:C.UNKNOWN}(R.status);l(new L(O,R.message))}else l(new L(C.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new L(C.UNAVAILABLE,"Connection failed."));break;default:V(9055,{s_:e,streamId:a,o_:d.getLastErrorCode(),__:d.getLastError()})}}finally{F(be,`RPC '${e}' ${a} completed.`)}});let p=JSON.stringify(i);F(be,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",p,r,15)})}a_(e,t,r){let i=yl(),s=[this.Lo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=iu(),c=ru(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Uo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let p=s.join("");F(be,`Creating RPC '${e}' stream ${i}: ${p}`,l);let g=a.createWebChannel(p,l),y=!1,b=!1,R=new vl({Go:k=>{b?F(be,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(y||(F(be,`Opening RPC '${e}' stream ${i} transport.`),g.open(),y=!0),F(be,`RPC '${e}' stream ${i} sending:`,k),g.send(k))},zo:()=>g.close()}),O=(k,j,M)=>{k.listen(j,$=>{try{M($)}catch(Q){setTimeout(()=>{throw Q},0)}})};return O(g,jn.EventType.OPEN,()=>{b||(F(be,`RPC '${e}' stream ${i} transport opened.`),R.t_())}),O(g,jn.EventType.CLOSE,()=>{b||(b=!0,F(be,`RPC '${e}' stream ${i} transport closed`),R.r_())}),O(g,jn.EventType.ERROR,k=>{b||(b=!0,Jn(be,`RPC '${e}' stream ${i} transport errored. Name:`,k.name,"Message:",k.message),R.r_(new L(C.UNAVAILABLE,"The operation could not be completed")))}),O(g,jn.EventType.MESSAGE,k=>{var j;if(!b){let M=k.data[0];Y(!!M,16349);let $=M,Q=$?.error||((j=$[0])===null||j===void 0?void 0:j.error);if(Q){F(be,`RPC '${e}' stream ${i} received error:`,Q);let pe=Q.status,J=function(v){let I=he[v];if(I!==void 0)return Rm(I)}(pe),w=Q.message;J===void 0&&(J=C.INTERNAL,w="Unknown error status: "+pe+" with message "+Q.message),b=!0,R.r_(new L(J,w)),g.close()}else F(be,`RPC '${e}' stream ${i} received:`,M),R.i_(M)}}),O(c,nu.STAT_EVENT,k=>{k.stat===Bs.PROXY?F(be,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===Bs.NOPROXY&&F(be,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{R.n_()},0),R}};function au(){return typeof document<"u"?document:null}function Lo(n){return new zu(n,!0)}var fo=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.bi=e,this.timerId=t,this.u_=r,this.c_=i,this.l_=s,this.h_=0,this.P_=null,this.T_=Date.now(),this.reset()}reset(){this.h_=0}I_(){this.h_=this.l_}E_(e){this.cancel();let t=Math.floor(this.h_+this.d_()),r=Math.max(0,Date.now()-this.T_),i=Math.max(0,t-r);i>0&&F("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.h_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.P_=this.bi.enqueueAfterDelay(this.timerId,i,()=>(this.T_=Date.now(),e())),this.h_*=this.c_,this.h_<this.u_&&(this.h_=this.u_),this.h_>this.l_&&(this.h_=this.l_)}A_(){this.P_!==null&&(this.P_.skipDelay(),this.P_=null)}cancel(){this.P_!==null&&(this.P_.cancel(),this.P_=null)}d_(){return(Math.random()-.5)*this.h_}};var Dg="PersistentStream",po=class{constructor(e,t,r,i,s,a,c,l){this.bi=e,this.R_=r,this.V_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.m_=0,this.f_=null,this.g_=null,this.stream=null,this.p_=0,this.y_=new fo(e,t)}w_(){return this.state===1||this.state===5||this.b_()}b_(){return this.state===2||this.state===3}start(){this.p_=0,this.state!==4?this.auth():this.S_()}stop(){return _(this,null,function*(){this.w_()&&(yield this.close(0))})}D_(){this.state=0,this.y_.reset()}v_(){this.b_()&&this.f_===null&&(this.f_=this.bi.enqueueAfterDelay(this.R_,6e4,()=>this.C_()))}F_(e){this.M_(),this.stream.send(e)}C_(){return _(this,null,function*(){if(this.b_())return this.close(0)})}M_(){this.f_&&(this.f_.cancel(),this.f_=null)}x_(){this.g_&&(this.g_.cancel(),this.g_=null)}close(e,t){return _(this,null,function*(){this.M_(),this.x_(),this.y_.cancel(),this.m_++,e!==4?this.y_.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(Pt(t.toString()),Pt("Using maximum backoff delay to prevent overloading the backend."),this.y_.I_()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.O_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Zo(t)})}O_(){}auth(){this.state=1;let e=this.N_(this.m_),t=this.m_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.m_===t&&this.B_(r,i)},r=>{e(()=>{let i=new L(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.L_(i)})})}B_(e,t){let r=this.N_(this.m_);this.stream=this.k_(e,t),this.stream.jo(()=>{r(()=>this.listener.jo())}),this.stream.Jo(()=>{r(()=>(this.state=2,this.g_=this.bi.enqueueAfterDelay(this.V_,1e4,()=>(this.b_()&&(this.state=3),Promise.resolve())),this.listener.Jo()))}),this.stream.Zo(i=>{r(()=>this.L_(i))}),this.stream.onMessage(i=>{r(()=>++this.p_==1?this.q_(i):this.onNext(i))})}S_(){this.state=5,this.y_.E_(()=>_(this,null,function*(){this.state=0,this.start()}))}L_(e){return F(Dg,`close with error: ${e}`),this.stream=null,this.close(4,e)}N_(e){return t=>{this.bi.enqueueAndForget(()=>this.m_===e?t():(F(Dg,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},wl=class extends po{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}k_(e,t){return this.connection.a_("Listen",e,t)}q_(e){return this.onNext(e)}onNext(e){this.y_.reset();let t=hT(this.serializer,e),r=function(s){if(!("targetChange"in s))return z.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?z.min():a.readTime?ft(a.readTime):z.min()}(e);return this.listener.Q_(t,r)}U_(e){let t={};t.database=Wu(this.serializer),t.addTarget=function(s,a){let c,l=a.target;if(c=Pu(l)?{documents:pT(s,l)}:{query:gT(s,l).gt},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Pm(s,a.resumeToken);let d=ju(s,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(z.min())>0){c.readTime=oo(s,a.snapshotVersion.toTimestamp());let d=ju(s,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);let r=_T(this.serializer,e);r&&(t.labels=r),this.F_(t)}K_(e){let t={};t.database=Wu(this.serializer),t.removeTarget=e,this.F_(t)}},Tl=class extends po{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get W_(){return this.p_>0}start(){this.lastStreamToken=void 0,super.start()}O_(){this.W_&&this.G_([])}k_(e,t){return this.connection.a_("Write",e,t)}q_(e){return Y(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0,55816),this.listener.z_()}onNext(e){Y(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.y_.reset();let t=fT(e.writeResults,e.commitTime),r=ft(e.commitTime);return this.listener.j_(r,t)}H_(){let e={};e.database=Wu(this.serializer),this.F_(e)}G_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>dT(this.serializer,r))};this.F_(t)}};var Al=class{},Dl=class extends Al{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.J_=!1}Y_(){if(this.J_)throw new L(C.FAILED_PRECONDITION,"The client has already been terminated.")}Qo(e,t,r,i){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Qo(e,qu(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(C.UNKNOWN,s.toString())})}Wo(e,t,r,i,s){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Wo(e,qu(t,r),i,a,c,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(C.UNKNOWN,a.toString())})}terminate(){this.J_=!0,this.connection.terminate()}},bl=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Z_=0,this.X_=null,this.ea=!0}ta(){this.Z_===0&&(this.na("Unknown"),this.X_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.X_=null,this.ra("Backend didn't respond within 10 seconds."),this.na("Offline"),Promise.resolve())))}ia(e){this.state==="Online"?this.na("Unknown"):(this.Z_++,this.Z_>=1&&(this.sa(),this.ra(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.na("Offline")))}set(e){this.sa(),this.Z_=0,e==="Online"&&(this.ea=!1),this.na(e)}na(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ea?(Pt(t),this.ea=!1):F("OnlineStateTracker",t)}sa(){this.X_!==null&&(this.X_.cancel(),this.X_=null)}};var bn="RemoteStore",Sl=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.oa=[],this._a=new Map,this.aa=new Set,this.ua=[],this.ca=s,this.ca.vo(a=>{r.enqueueAndForget(()=>_(this,null,function*(){Sn(this)&&(F(bn,"Restarting streams for network reachability change."),yield function(l){return _(this,null,function*(){let d=B(l);d.aa.add(4),yield Si(d),d.la.set("Unknown"),d.aa.delete(4),yield xo(d)})}(this))}))}),this.la=new bl(r,i)}};function xo(n){return _(this,null,function*(){if(Sn(n))for(let e of n.ua)yield e(!0)})}function Si(n){return _(this,null,function*(){for(let e of n.ua)yield e(!1)})}function Bm(n,e){let t=B(n);t._a.has(e.targetId)||(t._a.set(e.targetId,e),hh(t)?lh(t):gr(t).b_()&&uh(t,e))}function ch(n,e){let t=B(n),r=gr(t);t._a.delete(e),r.b_()&&$m(t,e),t._a.size===0&&(r.b_()?r.v_():Sn(t)&&t.la.set("Unknown"))}function uh(n,e){if(n.ha.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(z.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}gr(n).U_(e)}function $m(n,e){n.ha.Ke(e),gr(n).K_(e)}function lh(n){n.ha=new $u({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n._a.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),gr(n).start(),n.la.ta()}function hh(n){return Sn(n)&&!gr(n).w_()&&n._a.size>0}function Sn(n){return B(n).aa.size===0}function zm(n){n.ha=void 0}function FT(n){return _(this,null,function*(){n.la.set("Online")})}function LT(n){return _(this,null,function*(){n._a.forEach((e,t)=>{uh(n,e)})})}function xT(n,e){return _(this,null,function*(){zm(n),hh(n)?(n.la.ia(e),lh(n)):n.la.set("Unknown")})}function MT(n,e,t){return _(this,null,function*(){if(n.la.set("Online"),e instanceof io&&e.state===2&&e.cause)try{yield function(i,s){return _(this,null,function*(){let a=s.cause;for(let c of s.targetIds)i._a.has(c)&&(yield i.remoteSyncer.rejectListen(c,a),i._a.delete(c),i.ha.removeTarget(c))})}(n,e)}catch(r){F(bn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield go(n,r)}else if(e instanceof Qn?n.ha.Xe(e):e instanceof ro?n.ha.ot(e):n.ha.nt(e),!t.isEqual(z.min()))try{let r=yield Um(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let c=s.ha.It(a);return c.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){let p=s._a.get(d);p&&s._a.set(d,p.withResumeToken(l.resumeToken,a))}}),c.targetMismatches.forEach((l,d)=>{let p=s._a.get(l);if(!p)return;s._a.set(l,p.withResumeToken(Se.EMPTY_BYTE_STRING,p.snapshotVersion)),$m(s,l);let g=new vi(p.target,l,d,p.sequenceNumber);uh(s,g)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){F(bn,"Failed to raise snapshot:",r),yield go(n,r)}})}function go(n,e,t){return _(this,null,function*(){if(!pr(e))throw e;n.aa.add(1),yield Si(n),n.la.set("Offline"),t||(t=()=>Um(n.localStore)),n.asyncQueue.enqueueRetryable(()=>_(null,null,function*(){F(bn,"Retrying IndexedDB access"),yield t(),n.aa.delete(1),yield xo(n)}))})}function jm(n,e){return e().catch(t=>go(n,t,e))}function Mo(n){return _(this,null,function*(){let e=B(n),t=Xt(e),r=e.oa.length>0?e.oa[e.oa.length-1].batchId:Jl;for(;VT(e);)try{let i=yield PT(e.localStore,r);if(i===null){e.oa.length===0&&t.v_();break}r=i.batchId,UT(e,i)}catch(i){yield go(e,i)}qm(e)&&Gm(e)})}function VT(n){return Sn(n)&&n.oa.length<10}function UT(n,e){n.oa.push(e);let t=Xt(n);t.b_()&&t.W_&&t.G_(e.mutations)}function qm(n){return Sn(n)&&!Xt(n).w_()&&n.oa.length>0}function Gm(n){Xt(n).start()}function BT(n){return _(this,null,function*(){Xt(n).H_()})}function $T(n){return _(this,null,function*(){let e=Xt(n);for(let t of n.oa)e.G_(t.mutations)})}function zT(n,e,t){return _(this,null,function*(){let r=n.oa.shift(),i=Mu.from(r,e,t);yield jm(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Mo(n)})}function jT(n,e){return _(this,null,function*(){e&&Xt(n).W_&&(yield function(r,i){return _(this,null,function*(){if(function(a){return iT(a)&&a!==C.ABORTED}(i.code)){let s=r.oa.shift();Xt(r).D_(),yield jm(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Mo(r)}})}(n,e)),qm(n)&&Gm(n)})}function bg(n,e){return _(this,null,function*(){let t=B(n);t.asyncQueue.verifyOperationInProgress(),F(bn,"RemoteStore received new credentials");let r=Sn(t);t.aa.add(3),yield Si(t),r&&t.la.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.aa.delete(3),yield xo(t)})}function qT(n,e){return _(this,null,function*(){let t=B(n);e?(t.aa.delete(2),yield xo(t)):e||(t.aa.add(2),yield Si(t),t.la.set("Unknown"))})}function gr(n){return n.Pa||(n.Pa=function(t,r,i){let s=B(t);return s.Y_(),new wl(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{jo:FT.bind(null,n),Jo:LT.bind(null,n),Zo:xT.bind(null,n),Q_:MT.bind(null,n)}),n.ua.push(e=>_(null,null,function*(){e?(n.Pa.D_(),hh(n)?lh(n):n.la.set("Unknown")):(yield n.Pa.stop(),zm(n))}))),n.Pa}function Xt(n){return n.Ta||(n.Ta=function(t,r,i){let s=B(t);return s.Y_(),new Tl(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{jo:()=>Promise.resolve(),Jo:BT.bind(null,n),Zo:jT.bind(null,n),z_:$T.bind(null,n),j_:zT.bind(null,n)}),n.ua.push(e=>_(null,null,function*(){e?(n.Ta.D_(),yield Mo(n)):(yield n.Ta.stop(),n.oa.length>0&&(F(bn,`Stopping write stream with ${n.oa.length} pending writes`),n.oa=[]))}))),n.Ta}var Cl=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ze,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,c=new n(e,t,a,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function dh(n,e){if(Pt("AsyncQueue",`${e}: ${n}`),pr(n))return new L(C.UNAVAILABLE,`${e}: ${n}`);throw n}var mo=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||x.comparator(t.key,r.key):(t,r)=>x.comparator(t.key,r.key),this.keyedMap=ui(),this.sortedSet=new ce(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var _o=class{constructor(){this.Ia=new ce(x.comparator)}track(e){let t=e.doc.key,r=this.Ia.get(t);r?e.type!==0&&r.type===3?this.Ia=this.Ia.insert(t,e):e.type===3&&r.type!==1?this.Ia=this.Ia.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Ia=this.Ia.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Ia=this.Ia.remove(t):e.type===1&&r.type===2?this.Ia=this.Ia.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):V(63341,{Vt:e,Ea:r}):this.Ia=this.Ia.insert(t,e)}da(){let e=[];return this.Ia.inorderTraversal((t,r)=>{e.push(r)}),e}},ar=class n{constructor(e,t,r,i,s,a,c,l,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(c=>{a.push({type:0,doc:c})}),new n(e,t,mo.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Oo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Rl=class{constructor(){this.Aa=void 0,this.Ra=[]}Va(){return this.Ra.some(e=>e.ma())}},Pl=class{constructor(){this.queries=Sg(),this.onlineState="Unknown",this.fa=new Set}terminate(){(function(t,r){let i=B(t),s=i.queries;i.queries=Sg(),s.forEach((a,c)=>{for(let l of c.Ra)l.onError(r)})})(this,new L(C.ABORTED,"Firestore shutting down"))}};function Sg(){return new Ot(n=>_m(n),Oo)}function Wm(n,e){return _(this,null,function*(){let t=B(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Va()&&e.ma()&&(r=2):(s=new Rl,r=e.ma()?0:1);try{switch(r){case 0:s.Aa=yield t.onListen(i,!0);break;case 1:s.Aa=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let c=dh(a,`Initialization of query '${Gn(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.Ra.push(e),e.ga(t.onlineState),s.Aa&&e.pa(s.Aa)&&fh(t)})}function Hm(n,e){return _(this,null,function*(){let t=B(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.Ra.indexOf(e);a>=0&&(s.Ra.splice(a,1),s.Ra.length===0?i=e.ma()?0:1:!s.Va()&&e.ma()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function GT(n,e){let t=B(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let c of a.Ra)c.pa(i)&&(r=!0);a.Aa=i}}r&&fh(t)}function WT(n,e,t){let r=B(n),i=r.queries.get(e);if(i)for(let s of i.Ra)s.onError(t);r.queries.delete(e)}function fh(n){n.fa.forEach(e=>{e.next()})}var kl,Cg;(Cg=kl||(kl={})).ya="default",Cg.Cache="cache";var yo=class{constructor(e,t,r){this.query=e,this.wa=t,this.ba=!1,this.Sa=null,this.onlineState="Unknown",this.options=r||{}}pa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ar(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ba?this.Da(e)&&(this.wa.next(e),t=!0):this.va(e,this.onlineState)&&(this.Ca(e),t=!0),this.Sa=e,t}onError(e){this.wa.error(e)}ga(e){this.onlineState=e;let t=!1;return this.Sa&&!this.ba&&this.va(this.Sa,e)&&(this.Ca(this.Sa),t=!0),t}va(e,t){if(!e.fromCache||!this.ma())return!0;let r=t!=="Offline";return(!this.options.Fa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Da(e){if(e.docChanges.length>0)return!0;let t=this.Sa&&this.Sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Ca(e){e=ar.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ba=!0,this.wa.next(e)}ma(){return this.options.source!==kl.Cache}};var Eo=class{constructor(e){this.key=e}},vo=class{constructor(e){this.key=e}},Nl=class{constructor(e,t){this.query=e,this.qa=t,this.Qa=null,this.hasCachedResults=!1,this.current=!1,this.$a=W(),this.mutatedKeys=W(),this.Ua=ym(e),this.Ka=new mo(this.Ua)}get Wa(){return this.qa}Ga(e,t){let r=t?t.za:new _o,i=t?t.Ka:this.Ka,s=t?t.mutatedKeys:this.mutatedKeys,a=i,c=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,g)=>{let y=i.get(p),b=Fo(this.query,g)?g:null,R=!!y&&this.mutatedKeys.has(y.key),O=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations),k=!1;y&&b?y.data.isEqual(b.data)?R!==O&&(r.track({type:3,doc:b}),k=!0):this.ja(y,b)||(r.track({type:2,doc:b}),k=!0,(l&&this.Ua(b,l)>0||d&&this.Ua(b,d)<0)&&(c=!0)):!y&&b?(r.track({type:0,doc:b}),k=!0):y&&!b&&(r.track({type:1,doc:y}),k=!0,(l||d)&&(c=!0)),k&&(b?(a=a.add(b),s=O?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ka:a,za:r,ys:c,mutatedKeys:s}}ja(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ka;this.Ka=e.Ka,this.mutatedKeys=e.mutatedKeys;let a=e.za.da();a.sort((p,g)=>function(b,R){let O=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return V(20277,{Vt:k})}};return O(b)-O(R)}(p.type,g.type)||this.Ua(p.doc,g.doc)),this.Ha(r),i=i!=null&&i;let c=t&&!i?this.Ja():[],l=this.$a.size===0&&this.current&&!i?1:0,d=l!==this.Qa;return this.Qa=l,a.length!==0||d?{snapshot:new ar(this.query,e.Ka,s,a,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ya:c}:{Ya:c}}ga(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ka:this.Ka,za:new _o,mutatedKeys:this.mutatedKeys,ys:!1},!1)):{Ya:[]}}Za(e){return!this.qa.has(e)&&!!this.Ka.has(e)&&!this.Ka.get(e).hasLocalMutations}Ha(e){e&&(e.addedDocuments.forEach(t=>this.qa=this.qa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qa=this.qa.delete(t)),this.current=e.current)}Ja(){if(!this.current)return[];let e=this.$a;this.$a=W(),this.Ka.forEach(r=>{this.Za(r.key)&&(this.$a=this.$a.add(r.key))});let t=[];return e.forEach(r=>{this.$a.has(r)||t.push(new vo(r))}),this.$a.forEach(r=>{e.has(r)||t.push(new Eo(r))}),t}Xa(e){this.qa=e.Ns,this.$a=W();let t=this.Ga(e.documents);return this.applyChanges(t,!0)}eu(){return ar.fromInitialDocuments(this.query,this.Ka,this.mutatedKeys,this.Qa===0,this.hasCachedResults)}},ph="SyncEngine",Ol=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Fl=class{constructor(e){this.key=e,this.tu=!1}},Ll=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.nu={},this.ru=new Ot(c=>_m(c),Oo),this.iu=new Map,this.su=new Set,this.ou=new ce(x.comparator),this._u=new Map,this.au=new wi,this.uu={},this.cu=new Map,this.lu=Ii.ir(),this.onlineState="Unknown",this.hu=void 0}get isPrimaryClient(){return this.hu===!0}};function HT(n,e,t=!0){return _(this,null,function*(){let r=Zm(n),i,s=r.ru.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.eu()):i=yield Km(r,e,t,!0),i})}function KT(n,e){return _(this,null,function*(){let t=Zm(n);yield Km(t,e,!0,!1)})}function Km(n,e,t,r){return _(this,null,function*(){let i=yield kT(n.localStore,ht(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=yield QT(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Bm(n.remoteStore,i),c})}function QT(n,e,t,r,i){return _(this,null,function*(){n.Pu=(g,y,b)=>function(O,k,j,M){return _(this,null,function*(){let $=k.view.Ga(j);$.ys&&($=yield Tg(O.localStore,k.query,!1).then(({documents:w})=>k.view.Ga(w,$)));let Q=M&&M.targetChanges.get(k.targetId),pe=M&&M.targetMismatches.get(k.targetId)!=null,J=k.view.applyChanges($,O.isPrimaryClient,Q,pe);return Pg(O,k.targetId,J.Ya),J.snapshot})}(n,g,y,b);let s=yield Tg(n.localStore,e,!0),a=new Nl(e,s.Ns),c=a.Ga(s.documents),l=Ei.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(c,n.isPrimaryClient,l);Pg(n,t,d.Ya);let p=new Ol(e,t,a);return n.ru.set(e,p),n.iu.has(t)?n.iu.get(t).push(e):n.iu.set(t,[e]),d.snapshot})}function YT(n,e,t){return _(this,null,function*(){let r=B(n),i=r.ru.get(e),s=r.iu.get(i.targetId);if(s.length>1)return r.iu.set(i.targetId,s.filter(a=>!Oo(a,e))),void r.ru.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield gl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&ch(r.remoteStore,i.targetId),xl(r,i.targetId)}).catch(fr))):(xl(r,i.targetId),yield gl(r.localStore,i.targetId,!0))})}function JT(n,e){return _(this,null,function*(){let t=B(n),r=t.ru.get(e),i=t.iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ch(t.remoteStore,r.targetId))})}function XT(n,e,t){return _(this,null,function*(){let r=sA(n);try{let i=yield function(a,c){let l=B(a),d=Ee.now(),p=c.reduce((b,R)=>b.add(R.key),W()),g,y;return l.persistence.runTransaction("Locally write mutations","readwrite",b=>{let R=Ft(),O=W();return l.Cs.getEntries(b,p).next(k=>{R=k,R.forEach((j,M)=>{M.isValidDocument()||(O=O.add(j))})}).next(()=>l.localDocuments.getOverlayedDocuments(b,R)).next(k=>{g=k;let j=[];for(let M of c){let $=rT(M,g.get(M.key).overlayedDocument);$!=null&&j.push(new gt(M.key,$,lm($.value.mapValue),dt.exists(!0)))}return l.mutationQueue.addMutationBatch(b,d,j,c)}).next(k=>{y=k;let j=k.applyToLocalDocumentSet(g,O);return l.documentOverlayCache.saveOverlays(b,k.batchId,j)})}).then(()=>({batchId:y.batchId,changes:vm(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,c,l){let d=a.uu[a.currentUser.toKey()];d||(d=new ce(q)),d=d.insert(c,l),a.uu[a.currentUser.toKey()]=d}(r,i.batchId,t),yield Ci(r,i.changes),yield Mo(r.remoteStore)}catch(i){let s=dh(i,"Failed to persist write");t.reject(s)}})}function Qm(n,e){return _(this,null,function*(){let t=B(n);try{let r=yield CT(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t._u.get(s);a&&(Y(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.tu=!0:i.modifiedDocuments.size>0?Y(a.tu,14607):i.removedDocuments.size>0&&(Y(a.tu,42227),a.tu=!1))}),yield Ci(t,r,e)}catch(r){yield fr(r)}})}function Rg(n,e,t){let r=B(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ru.forEach((s,a)=>{let c=a.view.ga(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){let l=B(a);l.onlineState=c;let d=!1;l.queries.forEach((p,g)=>{for(let y of g.Ra)y.ga(c)&&(d=!0)}),d&&fh(l)}(r.eventManager,e),i.length&&r.nu.Q_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function ZT(n,e,t){return _(this,null,function*(){let r=B(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r._u.get(e),s=i&&i.key;if(s){let a=new ce(x.comparator);a=a.insert(s,et.newNoDocument(s,z.min()));let c=W().add(s),l=new no(z.min(),new Map,new ce(q),a,c);yield Qm(r,l),r.ou=r.ou.remove(s),r._u.delete(e),gh(r)}else yield gl(r.localStore,e,!1).then(()=>xl(r,e,t)).catch(fr)})}function eA(n,e){return _(this,null,function*(){let t=B(n),r=e.batch.batchId;try{let i=yield ST(t.localStore,e);Jm(t,r,null),Ym(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ci(t,i)}catch(i){yield fr(i)}})}function tA(n,e,t){return _(this,null,function*(){let r=B(n);try{let i=yield function(a,c){let l=B(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return l.mutationQueue.lookupMutationBatch(d,c).next(g=>(Y(g!==null,37113),p=g.keys(),l.mutationQueue.removeMutationBatch(d,g))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,p,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>l.localDocuments.getDocuments(d,p))})}(r.localStore,e);Jm(r,e,t),Ym(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ci(r,i)}catch(i){yield fr(i)}})}function Ym(n,e){(n.cu.get(e)||[]).forEach(t=>{t.resolve()}),n.cu.delete(e)}function Jm(n,e,t){let r=B(n),i=r.uu[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.uu[r.currentUser.toKey()]=i}}function xl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.iu.get(e))n.ru.delete(r),t&&n.nu.Tu(r,t);n.iu.delete(e),n.isPrimaryClient&&n.au.Ur(e).forEach(r=>{n.au.containsKey(r)||Xm(n,r)})}function Xm(n,e){n.su.delete(e.path.canonicalString());let t=n.ou.get(e);t!==null&&(ch(n.remoteStore,t),n.ou=n.ou.remove(e),n._u.delete(t),gh(n))}function Pg(n,e,t){for(let r of t)r instanceof Eo?(n.au.addReference(r.key,e),nA(n,r)):r instanceof vo?(F(ph,"Document no longer in limbo: "+r.key),n.au.removeReference(r.key,e),n.au.containsKey(r.key)||Xm(n,r.key)):V(19791,{Iu:r})}function nA(n,e){let t=e.key,r=t.path.canonicalString();n.ou.get(t)||n.su.has(r)||(F(ph,"New document in limbo: "+t),n.su.add(r),gh(n))}function gh(n){for(;n.su.size>0&&n.ou.size<n.maxConcurrentLimboResolutions;){let e=n.su.values().next().value;n.su.delete(e);let t=new x(re.fromString(e)),r=n.lu.next();n._u.set(r,new Fl(t)),n.ou=n.ou.insert(t,r),Bm(n.remoteStore,new vi(ht(ih(t.path)),r,"TargetPurposeLimboResolution",Yl.le))}}function Ci(n,e,t){return _(this,null,function*(){let r=B(n),i=[],s=[],a=[];r.ru.isEmpty()||(r.ru.forEach((c,l)=>{a.push(r.Pu(l,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let g=d?!d.fromCache:(p=t?.targetChanges.get(l.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(l.targetId,g?"current":"not-current")}if(d){i.push(d);let g=hl.Ps(l.targetId,d);s.push(g)}}))}),yield Promise.all(a),r.nu.Q_(i),yield function(l,d){return _(this,null,function*(){let p=B(l);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>P.forEach(d,y=>P.forEach(y.ls,b=>p.persistence.referenceDelegate.addReference(g,y.targetId,b)).next(()=>P.forEach(y.hs,b=>p.persistence.referenceDelegate.removeReference(g,y.targetId,b)))))}catch(g){if(!pr(g))throw g;F(ah,"Failed to update sequence numbers: "+g)}for(let g of d){let y=g.targetId;if(!g.fromCache){let b=p.Ss.get(y),R=b.snapshotVersion,O=b.withLastLimboFreeSnapshotVersion(R);p.Ss=p.Ss.insert(y,O)}}})}(r.localStore,s))})}function rA(n,e){return _(this,null,function*(){let t=B(n);if(!t.currentUser.isEqual(e)){F(ph,"User change. New user:",e.toKey());let r=yield Vm(t.localStore,e);t.currentUser=e,function(s,a){s.cu.forEach(c=>{c.forEach(l=>{l.reject(new L(C.CANCELLED,a))})}),s.cu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ci(t,r.Ms)}})}function iA(n,e){let t=B(n),r=t._u.get(e);if(r&&r.tu)return W().add(r.key);{let i=W(),s=t.iu.get(e);if(!s)return i;for(let a of s){let c=t.ru.get(a);i=i.unionWith(c.view.Wa)}return i}}function Zm(n){let e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Qm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZT.bind(null,e),e.nu.Q_=GT.bind(null,e.eventManager),e.nu.Tu=WT.bind(null,e.eventManager),e}function sA(n){let e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=eA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tA.bind(null,e),e}var e_=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return _(this,null,function*(){this.serializer=Lo(t.databaseInfo.databaseId),this.sharedClientState=this.Au(t),this.persistence=this.Ru(t),yield this.persistence.start(),this.localStore=this.Vu(t),this.gcScheduler=this.mu(t,this.localStore),this.indexBackfillerScheduler=this.fu(t,this.localStore)})}mu(t,r){return null}fu(t,r){return null}Vu(t){return bT(this.persistence,new fl,t.initialUser,this.serializer)}Ru(t){return new co(ll.Ei,this.serializer)}Au(t){return new ml}terminate(){return _(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),Ml=class extends e_{constructor(e){super(),this.cacheSizeBytes=e}mu(e,t){Y(this.persistence.referenceDelegate instanceof uo,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Ju(r,e.asyncQueue,t)}Ru(e){let t=this.cacheSizeBytes!==void 0?Ge.withCacheSize(this.cacheSizeBytes):Ge.DEFAULT;return new co(r=>uo.Ei(r,t),this.serializer)}};var oA=(()=>{class n{initialize(t,r){return _(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Rg(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=rA.bind(null,this.syncEngine),yield qT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Pl}()}createDatastore(t){let r=Lo(t.databaseInfo.databaseId),i=function(a){return new Il(a)}(t.databaseInfo);return function(a,c,l,d){return new Dl(a,c,l,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,a,c,l){return new Sl(i,s,a,c,l)}(this.localStore,this.datastore,t.asyncQueue,r=>Rg(this.syncEngine,r,0),function(){return ho.C()?new ho:new _l}())}createSyncEngine(t,r){return function(s,a,c,l,d,p,g){let y=new Ll(s,a,c,l,d,p);return g&&(y.hu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return _(this,null,function*(){var t,r;yield function(s){return _(this,null,function*(){let a=B(s);F(bn,"RemoteStore shutting down."),a.aa.add(5),yield Si(a),a.ca.shutdown(),a.la.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Io=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.pu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.pu(this.observer.error,e):Pt("Uncaught Error in snapshot listener:",e.toString()))}yu(){this.muted=!0}pu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Zt="FirestoreClient",Vl=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=me.UNAUTHENTICATED,this.clientId=Qs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,a=>_(this,null,function*(){F(Zt,"Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(F(Zt,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ze;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=dh(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function cu(n,e){return _(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),F(Zt,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>_(null,null,function*(){r.isEqual(i)||(yield Vm(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function kg(n,e){return _(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield aA(n);F(Zt,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>bg(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>bg(e.remoteStore,i)),n._onlineComponents=e})}function aA(n){return _(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){F(Zt,"Using user provided OfflineComponentProvider");try{yield cu(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===C.FAILED_PRECONDITION||i.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Jn("Error using user provided cache. Falling back to memory cache: "+t),yield cu(n,new e_)}}else F(Zt,"Using default OfflineComponentProvider"),yield cu(n,new Ml(void 0));return n._offlineComponents})}function t_(n){return _(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(F(Zt,"Using user provided OnlineComponentProvider"),yield kg(n,n._uninitializedComponentsProvider._online)):(F(Zt,"Using default OnlineComponentProvider"),yield kg(n,new oA))),n._onlineComponents})}function cA(n){return t_(n).then(e=>e.syncEngine)}function n_(n){return _(this,null,function*(){let e=yield t_(n),t=e.eventManager;return t.onListen=HT.bind(null,e.syncEngine),t.onUnlisten=YT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=KT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=JT.bind(null,e.syncEngine),t})}function uA(n,e,t={}){let r=new Ze;return n.asyncQueue.enqueueAndForget(()=>_(null,null,function*(){return function(s,a,c,l,d){let p=new Io({next:y=>{p.yu(),a.enqueueAndForget(()=>Hm(s,g));let b=y.docs.has(c);!b&&y.fromCache?d.reject(new L(C.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&y.fromCache&&l&&l.source==="server"?d.reject(new L(C.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new yo(ih(c.path),p,{includeMetadataChanges:!0,Fa:!0});return Wm(s,g)}(yield n_(n),n.asyncQueue,e,t,r)})),r.promise}function lA(n,e,t={}){let r=new Ze;return n.asyncQueue.enqueueAndForget(()=>_(null,null,function*(){return function(s,a,c,l,d){let p=new Io({next:y=>{p.yu(),a.enqueueAndForget(()=>Hm(s,g)),y.fromCache&&l.source==="server"?d.reject(new L(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new yo(c,p,{includeMetadataChanges:!0,Fa:!0});return Wm(s,g)}(yield n_(n),n.asyncQueue,e,t,r)})),r.promise}function r_(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Ng=new Map;function i_(n,e,t){if(!t)throw new L(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function hA(n,e,t,r){if(e===!0&&r===!0)throw new L(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Og(n){if(!x.isDocumentKey(n))throw new L(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Fg(n){if(x.isDocumentKey(n))throw new L(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Vo(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":V(12329,{type:typeof n})}function nt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Vo(n);throw new L(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var s_="firestore.googleapis.com",Lg=!0,wo=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new L(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=s_,this.ssl=Lg}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Lg;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Mm;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<TT)throw new L(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=r_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},cr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new wo({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new wo(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new uu;switch(r.type){case"firstParty":return new fu(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,Fn("Firestore",this._settings.isUsingEmulator),this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return _(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Ng.get(t);r&&(F("ComponentProvider","Removing Datastore"),Ng.delete(t),r.terminate())}(this),Promise.resolve()}};function o_(n,e,t,r={}){var i;n=nt(n,cr);let s=an(e),a=n._getSettings(),c=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;a.host!==s_&&a.host!==l&&Jn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},a),{host:l,ssl:s,emulatorOptions:r});if(!st(d,c)&&(n._setSettings(d),s&&(ps(`https://${l}`),Fn("Firestore",!0)),r.mockUserToken)){let p,g;if(typeof r.mockUserToken=="string")p=r.mockUserToken,g=me.MOCK_USER;else{p=mf(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let y=r.mockUserToken.sub||r.mockUserToken.user_id;if(!y)throw new L(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new me(y)}n._authCredentials=new lu(new Hs(p,g))}}var ur=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ne=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Yt=class n extends ur{constructor(e,t,r){super(e,t,ih(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ne(this.firestore,null,new x(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function a_(n,e,...t){if(n=se(n),i_("collection","path",e),n instanceof cr){let r=re.fromString(e,...t);return Fg(r),new Yt(n,null,r)}{if(!(n instanceof Ne||n instanceof Yt))throw new L(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(re.fromString(e,...t));return Fg(r),new Yt(n.firestore,null,r)}}function mh(n,e,...t){if(n=se(n),arguments.length===1&&(e=Qs.newId()),i_("doc","path",e),n instanceof cr){let r=re.fromString(e,...t);return Og(r),new Ne(n,null,new x(r))}{if(!(n instanceof Ne||n instanceof Yt))throw new L(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(re.fromString(e,...t));return Og(r),new Ne(n.firestore,n instanceof Yt?n.converter:null,new x(r))}}var xg="AsyncQueue",To=class{constructor(e=Promise.resolve()){this.Qu=[],this.$u=!1,this.Uu=[],this.Ku=null,this.Wu=!1,this.Gu=!1,this.zu=[],this.y_=new fo(this,"async_queue_retry"),this.ju=()=>{let r=au();r&&F(xg,"Visibility state changed to "+r.visibilityState),this.y_.A_()},this.Hu=e;let t=au();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.ju)}get isShuttingDown(){return this.$u}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ju(),this.Yu(e)}enterRestrictedMode(e){if(!this.$u){this.$u=!0,this.Gu=e||!1;let t=au();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.ju)}}enqueue(e){if(this.Ju(),this.$u)return new Promise(()=>{});let t=new Ze;return this.Yu(()=>this.$u&&this.Gu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qu.push(e),this.Zu()))}Zu(){return _(this,null,function*(){if(this.Qu.length!==0){try{yield this.Qu[0](),this.Qu.shift(),this.y_.reset()}catch(e){if(!pr(e))throw e;F(xg,"Operation failed with retryable error: "+e)}this.Qu.length>0&&this.y_.E_(()=>this.Zu())}})}Yu(e){let t=this.Hu.then(()=>(this.Wu=!0,e().catch(r=>{throw this.Ku=r,this.Wu=!1,Pt("INTERNAL UNHANDLED ERROR: ",Mg(r)),r}).then(r=>(this.Wu=!1,r))));return this.Hu=t,t}enqueueAfterDelay(e,t,r){this.Ju(),this.zu.indexOf(e)>-1&&(t=0);let i=Cl.createAndSchedule(this,e,t,r,s=>this.Xu(s));return this.Uu.push(i),i}Ju(){this.Ku&&V(47125,{ec:Mg(this.Ku)})}verifyOperationInProgress(){}tc(){return _(this,null,function*(){let e;do e=this.Hu,yield e;while(e!==this.Hu)})}nc(e){for(let t of this.Uu)if(t.timerId===e)return!0;return!1}rc(e){return this.tc().then(()=>{this.Uu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Uu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.tc()})}sc(e){this.zu.push(e)}Xu(e){let t=this.Uu.indexOf(e);this.Uu.splice(t,1)}};function Mg(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Lt=class extends cr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new To,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return _(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new To(e),this._firestoreClient=void 0,yield e}})}};function c_(n,e){let t=typeof n=="object"?n:un(),r=typeof n=="string"?n:e||Zs,i=Mn(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=gf("firestore");s&&o_(i,...s)}return i}function _h(n){if(n._terminated)throw new L(C.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||dA(n),n._firestoreClient}function dA(n){var e,t,r;let i=n._freezeSettings(),s=function(c,l,d,p){return new yu(c,l,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,r_(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Vl(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(c){let l=c?._online.build();return{_offline:c?._offline.build(l),_online:l}}(n._componentsProvider))}var Ti=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Se.fromBase64String(e))}catch(t){throw new L(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Se.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var lr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Be(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var hr=class{constructor(e){this._methodName=e}};var Ai=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return q(this._lat,e._lat)||q(this._long,e._long)}};var Di=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var fA=/^__.*__$/,Ul=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new gt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Dn(e,this.data,t,this.fieldTransforms)}},Ao=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new gt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function u_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw V(40011,{oc:n})}}var Bl=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this._c(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get oc(){return this.settings.oc}ac(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}uc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ac({path:r,cc:!1});return i.lc(e),i}hc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ac({path:r,cc:!1});return i._c(),i}Pc(e){return this.ac({path:void 0,cc:!0})}Tc(e){return bo(e,this.settings.methodName,this.settings.Ic||!1,this.path,this.settings.Ec)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}_c(){if(this.path)for(let e=0;e<this.path.length;e++)this.lc(this.path.get(e))}lc(e){if(e.length===0)throw this.Tc("Document fields must not be empty");if(u_(this.oc)&&fA.test(e))throw this.Tc('Document fields cannot begin and end with "__"')}},$l=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Lo(e)}dc(e,t,r,i=!1){return new Bl({oc:e,methodName:t,Ec:r,path:Be.emptyPath(),cc:!1,Ic:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Uo(n){let e=n._freezeSettings(),t=Lo(n._databaseId);return new $l(n._databaseId,!!e.ignoreUndefinedProperties,t)}function l_(n,e,t,r,i,s={}){let a=n.dc(s.merge||s.mergeFields?2:0,e,t,i);yh("Data must be an object, but it was:",a,r);let c=h_(r,a),l,d;if(s.merge)l=new We(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let g of s.mergeFields){let y=jl(e,g,t);if(!a.contains(y))throw new L(C.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);f_(p,y)||p.push(y)}l=new We(p),d=a.fieldTransforms.filter(g=>l.covers(g.field))}else l=null,d=a.fieldTransforms;return new Ul(new Ue(c),l,d)}var Do=class n extends hr{_toFieldTransform(e){if(e.oc!==2)throw e.oc===1?e.Tc(`${this._methodName}() can only appear at the top level of your update data`):e.Tc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};var zl=class n extends hr{_toFieldTransform(e){return new Ou(e.path,new wn)}isEqual(e){return e instanceof n}};function pA(n,e,t,r){let i=n.dc(1,e,t);yh("Data must be an object, but it was:",i,r);let s=[],a=Ue.empty();en(r,(l,d)=>{let p=Eh(e,l,t);d=se(d);let g=i.hc(p);if(d instanceof Do)s.push(p);else{let y=Ri(d,g);y!=null&&(s.push(p),a.set(p,y))}});let c=new We(s);return new Ao(a,c,i.fieldTransforms)}function gA(n,e,t,r,i,s){let a=n.dc(1,e,t),c=[jl(e,r,t)],l=[i];if(s.length%2!=0)throw new L(C.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<s.length;y+=2)c.push(jl(e,s[y])),l.push(s[y+1]);let d=[],p=Ue.empty();for(let y=c.length-1;y>=0;--y)if(!f_(d,c[y])){let b=c[y],R=l[y];R=se(R);let O=a.hc(b);if(R instanceof Do)d.push(b);else{let k=Ri(R,O);k!=null&&(d.push(b),p.set(b,k))}}let g=new We(d);return new Ao(p,g,a.fieldTransforms)}function mA(n,e,t,r=!1){return Ri(t,n.dc(r?4:3,e))}function Ri(n,e){if(d_(n=se(n)))return yh("Unsupported field value:",e,n),h_(n,e);if(n instanceof hr)return function(r,i){if(!u_(i.oc))throw i.Tc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Tc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.cc&&e.oc!==4)throw e.Tc("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let c of r){let l=Ri(c,i.Pc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=se(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return X0(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ee.fromDate(r);return{timestampValue:oo(i.serializer,s)}}if(r instanceof Ee){let s=new Ee(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:oo(i.serializer,s)}}if(r instanceof Ai)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ti)return{bytesValue:Pm(i.serializer,r._byteString)};if(r instanceof Ne){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Tc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:oh(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Di)return function(a,c){return{mapValue:{fields:{[Zl]:{stringValue:eh},[Zn]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw c.Tc("VectorValues must only contain numeric values.");return sh(c.serializer,d)})}}}}}}(r,i);throw i.Tc(`Unsupported field value: ${Vo(r)}`)}(n,e)}function h_(n,e){let t={};return nm(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):en(n,(r,i)=>{let s=Ri(i,e.uc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function d_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ee||n instanceof Ai||n instanceof Ti||n instanceof Ne||n instanceof hr||n instanceof Di)}function yh(n,e,t){if(!d_(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Vo(t);throw r==="an object"?e.Tc(n+" a custom object"):e.Tc(n+" "+r)}}function jl(n,e,t){if((e=se(e))instanceof lr)return e._internalPath;if(typeof e=="string")return Eh(n,e);throw bo("Field path arguments must be of type string or ",n,!1,void 0,t)}var _A=new RegExp("[~\\*/\\[\\]]");function Eh(n,e,t){if(e.search(_A)>=0)throw bo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new lr(...e.split("."))._internalPath}catch{throw bo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function bo(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new L(C.INVALID_ARGUMENT,c+n+l)}function f_(n,e){return n.some(t=>t.isEqual(e))}var So=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ne(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new ql(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(vh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},ql=class extends So{data(){return super.data()}};function vh(n,e){return typeof e=="string"?Eh(n,e):e instanceof lr?e._internalPath:e._delegate._internalPath}function yA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var bi=class{},Gl=class extends bi{};function p_(n,e,...t){let r=[];e instanceof bi&&r.push(e),r=r.concat(t),function(s){let a=s.filter(l=>l instanceof Wl).length,c=s.filter(l=>l instanceof Co).length;if(a>1||a>0&&c>0)throw new L(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Co=class n extends Gl{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return m_(e._query,t),new ur(e.firestore,e.converter,ku(e._query,t))}_parse(e){let t=Uo(e.firestore);return function(s,a,c,l,d,p,g){let y;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new L(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Ug(g,p);let R=[];for(let O of g)R.push(Vg(l,s,O));y={arrayValue:{values:R}}}else y=Vg(l,s,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Ug(g,p),y=mA(c,a,g,p==="in"||p==="not-in");return fe.create(d,p,y)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function g_(n,e,t){let r=e,i=vh("where",n);return Co._create(i,r,t)}var Wl=class n extends bi{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:tt.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i,c=s.getFlattenedFilters();for(let l of c)m_(a,l),a=ku(a,l)}(e._query,t),new ur(e.firestore,e.converter,ku(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function Vg(n,e,t){if(typeof(t=se(t))=="string"){if(t==="")throw new L(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mm(e)&&t.indexOf("/")!==-1)throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(re.fromString(t));if(!x.isDocumentKey(r))throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ig(n,new x(r))}if(t instanceof Ne)return ig(n,t._key);throw new L(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vo(t)}.`)}function Ug(n,e){if(!Array.isArray(n)||n.length===0)throw new L(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function m_(n,e){let t=function(i,s){for(let a of i)for(let c of a.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new L(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Hl=class{convertValue(e,t="none"){switch(Jt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ne(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Nt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw V(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return en(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[Zn].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ne(a.doubleValue));return new Di(s)}convertGeoPoint(e){return new Ai(ne(e.latitude),ne(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=No(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(mi(e));default:return null}}convertTimestamp(e){let t=kt(e);return new Ee(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=re.fromString(e);Y(xm(r),9688,{name:e});let i=new eo(r.get(1),r.get(3)),s=new x(r.popFirst(5));return i.isEqual(t)||Pt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function __(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var yn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ro=class extends So{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Yn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(vh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Yn=class extends Ro{data(e={}){return super.data(e)}},Kl=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new yn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Yn(this._firestore,this._userDataWriter,r.key,r,new yn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{let l=new Yn(i._firestore,i._userDataWriter,c.doc.key,c.doc,new yn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let l=new Yn(i._firestore,i._userDataWriter,c.doc.key,c.doc,new yn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),p=a.indexOf(c.doc.key)),{type:EA(c.type),doc:l,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function EA(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return V(61501,{type:n})}}function y_(n){n=nt(n,Ne);let e=nt(n.firestore,Lt);return uA(_h(e),n._key).then(t=>vA(e,n,t))}var Po=class extends Hl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ti(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ne(this.firestore,null,t)}};function E_(n){n=nt(n,ur);let e=nt(n.firestore,Lt),t=_h(e),r=new Po(e);return yA(n._query),lA(t,n._query).then(i=>new Kl(e,r,n,i))}function v_(n,e,t){n=nt(n,Ne);let r=nt(n.firestore,Lt),i=__(n.converter,e,t);return Bo(r,[l_(Uo(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,dt.none())])}function I_(n,e,t,...r){n=nt(n,Ne);let i=nt(n.firestore,Lt),s=Uo(i),a;return a=typeof(e=se(e))=="string"||e instanceof lr?gA(s,"updateDoc",n._key,e,t,r):pA(s,"updateDoc",n._key,e),Bo(i,[a.toMutation(n._key,dt.exists(!0))])}function w_(n){return Bo(nt(n.firestore,Lt),[new yi(n._key,dt.none())])}function T_(n,e){let t=nt(n.firestore,Lt),r=mh(n),i=__(n.converter,e);return Bo(t,[l_(Uo(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,dt.exists(!1))]).then(()=>r)}function Bo(n,e){return function(r,i){let s=new Ze;return r.asyncQueue.enqueueAndForget(()=>_(null,null,function*(){return XT(yield cA(r),i,s)})),s.promise}(_h(n),e)}function vA(n,e,t){let r=t.docs.get(e._key),i=new Po(n);return new Ro(n,i,e._key,r,new yn(t.hasPendingWrites,t.fromCache),e.converter)}function tR(){return new zl("serverTimestamp")}(function(e,t=!0){(function(i){dr=i})(zt),Je(new ke("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),c=new Lt(new hu(r.getProvider("auth-internal")),new pu(a,r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new L(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new eo(d.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),oe(Kp,Qp,e),oe(Kp,Qp,"esm2017")})();var Pi=class{constructor(e){return e}},A_="firestore",Ih=class{constructor(){return Un(A_)}};var wh=new Pe("angularfire2.firestore-instances");function IA(n,e){let t=Qr(A_,n,e);return t&&new Pi(t)}function wA(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Pi(r)}}var TA={provide:Ih,deps:[[new ze,wh]]},AA={provide:Pi,useFactory:IA,deps:[[new ze,wh],Tt]};function oP(n,...e){return oe("angularfire",jt.full,"fst"),Nn([AA,TA,{provide:wh,useFactory:wA(n),multi:!0,deps:[rt,vt,qt,hn,[new ze,ai],[new ze,Bn],...e]}])}var aP=ae(T_,!0,2);var cP=ae(a_,!0,2);var uP=ae(w_,!0,2);var lP=ae(mh,!0,2);var hP=ae(y_,!0);var dP=ae(E_,!0);var fP=ae(c_,!0);var pP=ae(p_,!0,2);var gP=ae(v_,!0,2);var mP=ae(I_,!0,2);var _P=ae(g_,!0,2);export{Mr as a,Zi as b,sy as c,Aa as d,oy as e,On as f,Vd as g,Ud as h,dy as i,Oy as j,sf as k,Fy as l,xy as m,My as n,By as o,$y as p,uf as q,zy as r,jy as s,Na as t,nb as u,hS as v,dS as w,oi as x,PC as y,kC as z,NC as A,OC as B,FC as C,LC as D,xC as E,tR as F,Pi as G,oP as H,aP as I,cP as J,uP as K,lP as L,hP as M,dP as N,fP as O,pP as P,gP as Q,mP as R,_P as S};
